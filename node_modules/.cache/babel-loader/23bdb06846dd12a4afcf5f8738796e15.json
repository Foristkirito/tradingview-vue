{"remainingRequest":"/Users/suhang/Template/tradingview/demo2/node_modules/babel-loader/lib/index.js!/Users/suhang/Template/tradingview/demo2/src/components/sSimpleCrop/modules/index.js","dependencies":[{"path":"/Users/suhang/Template/tradingview/demo2/src/components/sSimpleCrop/modules/index.js","mtime":1597630462133},{"path":"/Users/suhang/Template/tradingview/demo2/node_modules/cache-loader/dist/cjs.js","mtime":1598844172828},{"path":"/Users/suhang/Template/tradingview/demo2/node_modules/babel-loader/lib/index.js","mtime":1598844172845}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0Iik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0iKTsKCnZhciBfdHlwZW9mID0gcmVxdWlyZSgiL1VzZXJzL3N1aGFuZy9UZW1wbGF0ZS90cmFkaW5ndmlldy9kZW1vMi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy90eXBlb2YiKTsKCi8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVmICovCihmdW5jdGlvbiAoZmFjdG9yeSkgewogIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHsKICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS4KICAgIGRlZmluZShbJ3ByZWZpeC11bWQnLCAnZXhpZi1qcycsICd0cmFuc2Zvcm1hdGlvbi1tYXRyaXgnXSwgZmFjdG9yeSk7CiAgfSBlbHNlIGlmICgodHlwZW9mIG1vZHVsZSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YobW9kdWxlKSkgPT09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7CiAgICAvLyBOb2RlL0NvbW1vbkpTCiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZSgncHJlZml4LXVtZCcpLCByZXF1aXJlKCdleGlmLWpzJyksIHJlcXVpcmUoJ3RyYW5zZm9ybWF0aW9uLW1hdHJpeCcpKTsKICB9IGVsc2UgewogICAgLy8gQnJvd3NlciBnbG9iYWxzCiAgICB3aW5kb3cuU2ltcGxlQ3JvcCA9IGZhY3Rvcnkod2luZG93LlByZWZpeCwgd2luZG93LkVYSUYsIHdpbmRvdy5UcmFuc2Zvcm1hdGlvbk1hdHJpeCk7CiAgfQp9KShmdW5jdGlvbiAoUHJlZml4LCBFWElGLCBUcmFuc2Zvcm1hdGlvbk1hdHJpeCkgewogIC8v5YW85a655oCn5aSE55CGCiAgZnVuY3Rpb24gd2hpY2hUcmFuc2l0aW9uRXZlbnQoKSB7CiAgICB2YXIgdDsKICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgdmFyIHRyYW5zaXRpb25zID0gewogICAgICAndHJhbnNpdGlvbic6ICd0cmFuc2l0aW9uZW5kJywKICAgICAgJ09UcmFuc2l0aW9uJzogJ29UcmFuc2l0aW9uRW5kJywKICAgICAgJ01velRyYW5zaXRpb24nOiAndHJhbnNpdGlvbmVuZCcsCiAgICAgICdXZWJraXRUcmFuc2l0aW9uJzogJ3dlYmtpdFRyYW5zaXRpb25FbmQnLAogICAgICAnTXNUcmFuc2l0aW9uJzogJ21zVHJhbnNpdGlvbkVuZCcKICAgIH07CgogICAgZm9yICh0IGluIHRyYW5zaXRpb25zKSB7CiAgICAgIGlmIChlbC5zdHlsZVt0XSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRyYW5zaXRpb25zW3RdOwogICAgICB9CiAgICB9CiAgfQoKICB2YXIgdHJhbnNpdGlvbkVuZEV2ZW50ID0gd2hpY2hUcmFuc2l0aW9uRXZlbnQoKTsKICB2YXIgdHJhbnNmb3JtUHJvcGVydHkgPSBQcmVmaXgucHJlZml4KCd0cmFuc2Zvcm0nKTsKICB2YXIgdHJhbnNpdGlvblByb3BlcnR5ID0gUHJlZml4LnByZWZpeCgndHJhbnNpdGlvbicpOyAvL2luY2x1ZGVz5pa55rOV5YW85a65CgogIGlmICghQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnaW5jbHVkZXMnLCB7CiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh2YWx1ZVRvRmluZCwgZnJvbUluZGV4KSB7CiAgICAgICAgdmFyIG8gPSBPYmplY3QodGhpcyk7CiAgICAgICAgdmFyIGxlbiA9IG8ubGVuZ3RoID4+PiAwOwoKICAgICAgICBpZiAobGVuID09PSAwKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB2YXIgbiA9IGZyb21JbmRleCB8IDA7CiAgICAgICAgdmFyIGsgPSBNYXRoLm1heChuID49IDAgPyBuIDogbGVuIC0gTWF0aC5hYnMobiksIDApOwoKICAgICAgICBmdW5jdGlvbiBzYW1lVmFsdWVaZXJvKHgsIHkpIHsKICAgICAgICAgIHJldHVybiB4ID09PSB5IHx8IHR5cGVvZiB4ID09PSAnbnVtYmVyJyAmJiB0eXBlb2YgeSA9PT0gJ251bWJlcicgJiYgaXNOYU4oeCkgJiYgaXNOYU4oeSk7CiAgICAgICAgfQoKICAgICAgICB3aGlsZSAoayA8IGxlbikgewogICAgICAgICAgaWYgKHNhbWVWYWx1ZVplcm8ob1trXSwgdmFsdWVUb0ZpbmQpKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGsrKzsKICAgICAgICB9CgogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSk7CiAgfQogIC8qKgogICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAqIOmFjee9rgogICAqIEBwYXJhbSB0aXRsZSDmoIfpopgKICAgKiBAcGFyYW0gdmlzaWJsZSDnu4Tku7bmmK/lkKblj6/op4EKICAgKiBAcGFyYW0gZGVidWcg5piv5ZCm5byA5ZCv6LCD6K+V5qih5byP77yIcGPjgIFtb2JpbGXvvIkKICAgKiBAcGFyYW0gJGNvbnRhaW5lciDlrrnlmajvvIhwY+OAgW1vYmlsZe+8iQogICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAqIOijgeWJquWbvueJhwogICAqIEBwYXJhbSBzcmMgICDlm77niYflnLDlnYAKICAgKiBAcGFyYW0gc2l6ZSDoo4Hliarlm77niYfnm67moIflsLrlr7gKICAgKiBvcmlnaW5JbWFnZSDliJ3lp4vlm77niYcKICAgKiBfb3JpZW50YXRpb24g5Zu+54mH5pa55ZCRCiAgICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICog6KOB5Ymq5qGGCiAgICogQHBhcmFtIHBvc2l0aW9uT2Zmc2V0IOijgeWJquahhuWxj+W5leWBj+enuwogICAqIEBwYXJhbSBib2xkQ29ybmVyTGVuIOijgeWJquahhui+ueinkuWKoOeyl+mVv+W6pgogICAqIEBwYXJhbSBjb3ZlckNvbG9yIOmBrue9qeiDjOaZr+minOiJsgogICAqIEBwYXJhbSBjcm9wU2l6ZVBlcmNlbnQg6KOB5Ymq5qGG5Y2g6KOB5Ymq5pi+56S65Yy65Z+f55qE5q+U5L6LCiAgICogQHBhcmFtIGJvcmRlcldpZHRoIOijgeWJquahhui+ueahhuWuveW6pgogICAqIEBwYXJhbSBib3JkZXJDb2xvciDoo4HliarmoYbovrnmoYbpopzoibIKICAgKiBAcGFyYW0gY292ZXJEcmF3IOijgeWJquahhui+heWKqee6v+e7mOWItuWHveaVsAogICAqIEBwYXJhbSBib3JkZXJEcmF3IOijgeWJquahhui+ueahhue7mOWItuWHveaVsAogICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAqIOWKn+iDveaMiemSrgogICAqIEBwYXJhbSBmdW5jQnRucyDlip/og73mjInpkq7phY3nva7mlbDnu4QKICAgKiBAcGFyYW0gY3JvcENhbGxiYWNrIOWbvueJh+ijgeWJquWujOaIkOWbnuiwg+WHveaVsAogICAqIEBwYXJhbSB1cGxvYWRDYWxsYmFjayDph43mlrDkuIrkvKDoo4Hliarlm77niYflm57osIPlh73mlbAKICAgKiBAcGFyYW0gY2xvc2VDYWxsYmFjayDlhbPpl63oo4Hliarnu4Tku7blm57osIPlh73mlbAKICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgKiDmu5HliqjmjqfliLbmnaEKICAgKiBAcGFyYW0gc2NhbGVTbGlkZXIg5piv5ZCm5byA5ZCv5ruR5Yqo5o6n5Yi25p2h77yIcGPjgIFtb2JpbGXvvIkKICAgKiBAcGFyYW0gbWF4U2NhbGUg5pyA5aSn57yp5pS+5YCN5pWw77yIcGPjgIFtb2JpbGXvvIkKICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgKiDml4vovazliLvluqbnm5gKICAgKiBAcGFyYW0gcm90YXRlU2xpZGVyIOaYr+WQpuW8gOWQr+aXi+i9rOWIu+W6puebmAogICAqIEBwYXJhbSBzdGFydEFuZ2xlIOaXi+i9rOWIu+W6puebmOW8gOWni+inkuW6pgogICAqIEBwYXJhbSBlbmRBbmdsZSDml4vovazliLvluqbnm5jnu5PmnZ/op5LluqYKICAgKiBAcGFyYW0gZ2FwQW5nbGUg5peL6L2s5Yi75bqm55uY6Ze06ZqU6KeS5bqmCiAgICogQHBhcmFtIGxpbmVhdGlvbkl0ZW1XaWR0aCDml4vovazliLvluqbnm5jpl7TpmpTlrr3luqYKICAgKiBsaW5lYXRpb25XaWR0aCDmoLnmja7kuIrov7Dlj4LmlbDorqHnrpflh7rnmoTml4vovazliLvluqbnm5jmgLvlrr3luqYKICAgKiByb3RhdGVXaWR0aCDml4vovazliLvluqbnm5jmmL7npLrlrr3luqYKICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgKiDlsLrlr7jvvIjkuLrkuoblh4/lsJHorqHnrpfnmoTlpI3mnYLmgKfvvIzmiYDmnInlnZDmoIfpg73nu5/kuIDkuLrlsY/luZXlnZDmoIflj4rlsLrlr7jvvIkKICAgKiBtYXNrVmlld1NpemUg5a655Zmo5bGP5bmV5bC65a+4CiAgICogY3JvcFJlY3Qg5oiq5Zu+5qGG5bGP5bmV5bC65a+4CiAgICogY3JvcFBvaW50cyDoo4HliarmoYbpobbngrnlnZDmoIcKICAgKiBjcm9wQ2VudGVyIOijgeWJquahhuS4reW/g+eCueWdkOaghwogICAqIGNvbnRlbnRXaWR0aCDlm77niYfmmL7npLrlrr3luqYKICAgKiBjb250ZW50SGVpZ2h0IOWbvueJh+aYvuekuumrmOW6pgogICAqIGNvbnRlbnRQb2ludHMg5Zu+54mH6aG254K55Z2Q5qCHCiAgICogaW5pdENvbnRlbnRQb2ludHMg5Zu+54mH5Yid5aeL6aG254K55Z2Q5qCHCiAgICogX2NvbnRlbnRDdXJNb3ZlWCDlm77niYcgWCDovbTmlrnlkJHkuIrnmoTmgLvkvY3np7sKICAgKiBfY29udGVudEN1ck1vdmVZIOWbvueJhyBZIOi9tOaWueWQkeS4iueahOaAu+S9jeenuwogICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAqIOWPjOaMh+e8qeaUvgogICAqIF9tdWx0aVBvaW50IOaYr+WQpuW8gOWni+WkmueCueinpuaOpwogICAqIGZpbmdlckxlbiDlj4zmjIfot53nprsKICAgKiBmaW5nZXJTY2FsZSDlj4zmjIfnvKnmlL7lgI3mlbAKICAgKiBmaW5nZXJDZW50ZXIg5Y+M5oyH5pON5L2c5Lit5b+DCiAgICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICog5YW25a6DCiAgICogdGltZXMg5a6e6ZmF5bC65a+4L+aYvuekuuWwuuWvuAogICAqIGluaXRTY2FsZSDliJ3lp4vnvKnmlL7lgI3mlbAKICAgKiAkcmVzdWx0Q2FudmFzIOijgeWIh+e7k+aenO+8iHBj44CBbW9iaWxl77yJCiAgICogcmVzdWx0U3JjIOijgeWJque7k+aenO+8iHdlY2hhdO+8iQogICAqIGlzU3VwcG9ydFRvdWNoIOaYr+WQpuaUr+aMgSB0b3VjaCDkuovku7bvvIhwY+OAgW1vYmlsZe+8iQogICAqIHBhc3NpdmVTdXBwb3J0ZWQg5LqL5Lu25piv5ZCm5pSv5oyBIHBhc3NpdmXvvIhwY+OAgW1vYmlsZe+8iQogICAqLwoKCiAgZnVuY3Rpb24gU2ltcGxlQ3JvcChwYXJhbXMpIHsKICAgIC8v6YWN572uCiAgICB0aGlzLmlkID0gJ2Nyb3AtJyArIG5ldyBEYXRlKCkuZ2V0VGltZSgpOwogICAgdGhpcy52aXNpYmxlID0gcGFyYW1zLnZpc2libGUgIT0gbnVsbCA/IHBhcmFtcy52aXNpYmxlIDogdHJ1ZTsgLy/pu5jorqTmmL7npLoKCiAgICB0aGlzLnRpdGxlID0gcGFyYW1zLnRpdGxlICE9IG51bGwgPyBwYXJhbXMudGl0bGUgOiAnJzsKICAgIHRoaXMuZGVidWcgPSBwYXJhbXMuZGVidWcgIT0gbnVsbCA/IHBhcmFtcy5kZWJ1ZyA6IGZhbHNlOwogICAgdGhpcy4kY29udGFpbmVyID0gcGFyYW1zLiRjb250YWluZXIgIT0gbnVsbCA/IHBhcmFtcy4kY29udGFpbmVyIDogZG9jdW1lbnQuYm9keTsgLy/lrrnlmagKICAgIC8v5ruR5Yqo5o6n5Yi25p2hCgogICAgdGhpcy5zY2FsZVNsaWRlciA9IHBhcmFtcy5zY2FsZVNsaWRlciAhPSBudWxsID8gcGFyYW1zLnNjYWxlU2xpZGVyIDogZmFsc2U7CiAgICB0aGlzLm1heFNjYWxlID0gcGFyYW1zLm1heFNjYWxlID8gcGFyYW1zLm1heFNjYWxlIDogMTsgLy/mnIDlpKfnvKnmlL7lgI3mlbDvvIzpu5jorqTkuLrljp/lp4vlsLrlr7gKICAgIC8v5YW25a6DCgogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgc2VsZi5wYXNzaXZlU3VwcG9ydGVkID0gZmFsc2U7IC8v5Yik5pat5piv5ZCm5pSv5oyBIHBhc3NpdmUKCiAgICB0cnkgewogICAgICB2YXIgb3B0aW9ucyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgJ3Bhc3NpdmUnLCB7CiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICBzZWxmLnBhc3NpdmVTdXBwb3J0ZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0ZXN0JywgbnVsbCwgb3B0aW9ucyk7CiAgICB9IGNhdGNoIChlcnIpIHsvL25vdGhpbmcKICAgIH0KCiAgICB0aGlzLmlzU3VwcG9ydFRvdWNoID0gJ29udG91Y2hlbmQnIGluIGRvY3VtZW50ID8gdHJ1ZSA6IGZhbHNlOyAvL+WIpOaWreaYr+WQpuaUr+aMgSB0b3VjaCDkuovku7YKICAgIC8v5pON5L2c54q25oCBCgogICAgdGhpcy5fbXVsdGlQb2ludCA9IGZhbHNlOyAvL+aYr+WQpuW8gOWni+WkmueCueinpuaOpwoKICAgIHRoaXMuX3JvdGF0ZVNjYWxlID0gMTsgLy/ml4vovaznvKnmlL7lgI3mlbAKCiAgICB0aGlzLl9iYXNlTW92ZVggPSAwOyAvL+aXi+i9rOWIu+W6puebmOS9jee9ruWIneWni+WMluWBj+enu+mHjwoKICAgIHRoaXMuX2N1ck1vdmVYID0gMDsgLy/ml4vovazliLvluqbnm5jkvY3nva7lvZPliY3mgLvlgY/np7vph48KCiAgICB0aGlzLl9jaGFuZ2VkWCA9IDA7IC8v5peL6L2s5Yi75bqm55uY5b2T5YmN5YGP56e76YePCgogICAgdGhpcy5fZG93blBvaW50cyA9IFtdOyAvL+aTjeS9nOeCueWdkOagh+aVsOe7hAoKICAgIHRoaXMuX2lzQ29udHJvbCA9IGZhbHNlOyAvL+aYr+WQpuato+WcqOaTjeS9nAoKICAgIHRoaXMuX3NjYWxlTW92ZVggPSAwOyAvL+a7keWKqOe8qeaUvuaOp+S7tuWBj+enu+mHjwoKICAgIC8qKgogICAgICog5peL6L2s5Lqk5LqS5YiG5Li65Lik56eN77yaCiAgICAgKiDkuIDnp43mmK/mlbTop5Lml4vovazvvIg5MOW6pu+8ie+8mwogICAgICog5Y+m5LiA56eN5piv5Z+65LqO5pW06KeS5peL6L2s55qE5Z+656GA5LiK5q2j6LSfNDXluqbml4vovazjgIIKICAgICAqLwoKICAgIHRoaXMuX2Jhc2VBbmdsZSA9IDA7CiAgICB0aGlzLnNjYWxlVGltZXMgPSAxOyAvL+e8qeaUvuWAjeaVsAoKICAgIHRoaXMucm90YXRlQW5nbGUgPSAwOyAvL+aXi+i9rOinkuW6pgoKICAgIHRoaXMuY29uc3RydWN0KCk7IC8v5rOo5oSPIGNvbnN0cnVjdCDlkowgYmluZEV2ZW50IOS4remXtOWHveaVsOeahOWFiOWQjumhuuW6jwoKICAgIHRoaXMuaW5pdEZ1bmNCdG5zKHBhcmFtcyk7IC8v5Yid5aeL5YyW5Yqf6IO95oyJ6ZKuCgogICAgdGhpcy5pbml0Um90YXRlU2xpZGVyKHBhcmFtcyk7IC8v5Yid5aeL5YyW5peL6L2s5Yi75bqm55uYCgogICAgdGhpcy5pbml0Q2hpbGRzKCk7CiAgICB0aGlzLmluaXRCb3hCb3JkZXIocGFyYW1zLCB0cnVlKTsKICAgIHRoaXMudXBkYXRlQm94KHBhcmFtcyk7CiAgICB0aGlzLmJpbmRFdmVudCgpOwogIH0gLy/liJ3lp4vljJbmoIfpopgKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmluaXRUaXRsZSA9IGZ1bmN0aW9uIChwYXJhbXMpIHsKICAgIHRoaXMudGl0bGUgPSBwYXJhbXMudGl0bGUgIT0gbnVsbCA/IHBhcmFtcy50aXRsZSA6ICcnOwogICAgdGhpcy4kdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHRoaXMuaWQgKyAnIC5jcm9wLXRpdGxlJyk7CiAgICB0aGlzLiR0aXRsZS5pbm5lclRleHQgPSB0aGlzLnRpdGxlOwoKICAgIGlmICghcGFyYW1zLnRpdGxlKSB7CiAgICAgIHRoaXMuJHRpdGxlLnN0eWxlLnZpc2liaWxpdHkgPSAnJzsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuJHRpdGxlLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJzsKICAgIH0KICB9OyAvL+WIneWni+WMluijgeWJquahhui+ueahhuS7peWPiui+heWKqee6vwoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUuaW5pdEJveEJvcmRlciA9IGZ1bmN0aW9uIChwYXJhbXMsIG9ubHlJbml0KSB7CiAgICB0aGlzLmJvcmRlcldpZHRoID0gcGFyYW1zLmJvcmRlcldpZHRoICE9IG51bGwgPyBwYXJhbXMuYm9yZGVyV2lkdGggOiAxOwogICAgdGhpcy5ib3JkZXJDb2xvciA9IHBhcmFtcy5ib3JkZXJDb2xvciAhPSBudWxsID8gcGFyYW1zLmJvcmRlckNvbG9yIDogJyNmZmYnOwogICAgdGhpcy5ib2xkQ29ybmVyTGVuID0gcGFyYW1zLmJvbGRDb3JuZXJMZW4gIT0gbnVsbCA/IHBhcmFtcy5ib2xkQ29ybmVyTGVuIDogMjQ7CiAgICB0aGlzLmNvdmVyQ29sb3IgPSBwYXJhbXMuY292ZXJDb2xvciAhPSBudWxsID8gcGFyYW1zLmNvdmVyQ29sb3IgOiAncmdiYSgwLDAsMCwuMyknOwogICAgdGhpcy5jb3ZlckRyYXcgPSBwYXJhbXMuY292ZXJEcmF3ICE9IG51bGwgPyBwYXJhbXMuY292ZXJEcmF3IDogZnVuY3Rpb24gKCkge307CiAgICB0aGlzLmJvcmRlckRyYXcgPSBwYXJhbXMuYm9yZGVyRHJhdyAhPSBudWxsID8gcGFyYW1zLmJvcmRlckRyYXcgOiB0aGlzLmRlZmF1bHRCb3JkZXJEcmF3OwoKICAgIGlmICghb25seUluaXQpIHsKICAgICAgdGhpcy5ib3JkZXJEcmF3KHRoaXMuJGNyb3BDb3Zlcik7CiAgICAgIHRoaXMuY292ZXJEcmF3KHRoaXMuJGNyb3BDb3Zlcik7CiAgICB9CiAgfTsgLy/liJ3lp4vljJblip/og73mjInpkq4KCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmluaXRGdW5jQnRucyA9IGZ1bmN0aW9uIChwYXJhbXMpIHsKICAgIC8qKgogICAgICog6buY6K6k5Yqf6IO95oyJ6ZKu5Li65Y+W5raI44CB6KOB5Ymq44CBOTDluqbml4vovazjgIHph43nva4KICAgICAqIHVwbG9hZCDph43mlrDkuIrkvKAKICAgICAqIGNyb3Ag6KOB5YmqCiAgICAgKiBjbG9zZSDlj5bmtogKICAgICAqIGFyb3VuZCA5MOW6puaXi+i9rAogICAgICogcmVzZXQg6YeN572uCiAgICAgKi8KICAgIHRoaXMuZnVuY0J0bnMgPSBwYXJhbXMuZnVuY0J0bnMgIT0gbnVsbCA/IHBhcmFtcy5mdW5jQnRucyA6IFsnY2xvc2UnLCAnY3JvcCcsICdhcm91bmQnLCAncmVzZXQnXTsKICAgIHRoaXMuY3JvcENhbGxiYWNrID0gcGFyYW1zLmNyb3BDYWxsYmFjayAhPSBudWxsID8gcGFyYW1zLmNyb3BDYWxsYmFjayA6IGZ1bmN0aW9uICgpIHt9OwogICAgdGhpcy5jbG9zZUNhbGxiYWNrID0gcGFyYW1zLmNsb3NlQ2FsbGJhY2sgIT0gbnVsbCA/IHBhcmFtcy5jbG9zZUNhbGxiYWNrIDogZnVuY3Rpb24gKCkge307CiAgICB0aGlzLnVwbG9hZENhbGxiYWNrID0gcGFyYW1zLnVwbG9hZENhbGxiYWNrICE9IG51bGwgPyBwYXJhbXMudXBsb2FkQ2FsbGJhY2sgOiBmdW5jdGlvbiAoKSB7fTsKICAgIHRoaXMuJGNyb3BCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB0aGlzLmlkICsgJyAuY3JvcC1idG5zJyk7CiAgICB2YXIgaHRtbCA9ICcnOwoKICAgIGlmICh0aGlzLmZ1bmNCdG5zLmluY2x1ZGVzKCd1cGxvYWQnKSkgewogICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPSJ1cGxvYWQtYnRuLWNvbnRhaW5lciI+JzsKICAgICAgaHRtbCArPSAnPGJ1dHRvbiBjbGFzcz0idXBsb2FkLWJ0biI+PC9idXR0b24+JzsKICAgICAgaHRtbCArPSAnPGlucHV0IHR5cGU9ImZpbGUiIGFjY2VwdD0iaW1hZ2UvcG5nLGltYWdlL2pwZWciPic7CiAgICAgIGh0bWwgKz0gJzwvZGl2Pic7CiAgICB9CgogICAgaWYgKHRoaXMuZnVuY0J0bnMuaW5jbHVkZXMoJ2Nsb3NlJykpIHsKICAgICAgaHRtbCArPSAnPGJ1dHRvbiBjbGFzcz0iY3JvcC1jbG9zZSI+PC9idXR0b24+JzsKICAgIH0KCiAgICBpZiAodGhpcy5mdW5jQnRucy5pbmNsdWRlcygnYXJvdW5kJykpIHsKICAgICAgaHRtbCArPSAnPGJ1dHRvbiBjbGFzcz0iY3JvcC1hcm91bmQiPjwvYnV0dG9uPic7CiAgICB9CgogICAgaWYgKHRoaXMuZnVuY0J0bnMuaW5jbHVkZXMoJ3Jlc2V0JykpIHsKICAgICAgaHRtbCArPSAnPGJ1dHRvbiBjbGFzcz0iY3JvcC1yZXNldCI+PC9idXR0b24+JzsKICAgIH0KCiAgICBpZiAodGhpcy5mdW5jQnRucy5pbmNsdWRlcygnY3JvcCcpKSB7CiAgICAgIGh0bWwgKz0gJzxidXR0b24gY2xhc3M9ImNyb3AtYnRuIj48L2J1dHRvbj4nOwogICAgfQoKICAgIHRoaXMuJGNyb3BCdG5zLmlubmVySFRNTCA9IGh0bWw7IC8v6YeN5paw5LiK5LygCgogICAgaWYgKHRoaXMuZnVuY0J0bnMuaW5jbHVkZXMoJ3VwbG9hZCcpKSB7CiAgICAgIGlmICh0aGlzLiR1cGxvYWRCdG4pIHsKICAgICAgICB0aGlzLiR1cGxvYWRCdG4ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy5fX3VwbG9hZElucHV0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLl9fdXBsb2FkSW5wdXQgPSB0aGlzLnVwbG9hZElucHV0LmJpbmQodGhpcyk7CiAgICAgIH0KCiAgICAgIHRoaXMuJHVwbG9hZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdGhpcy5pZCArICcgLnVwbG9hZC1idG4tY29udGFpbmVyJyk7CiAgICAgIHRoaXMuJHVwbG9hZElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB0aGlzLmlkICsgJyAudXBsb2FkLWJ0bi1jb250YWluZXIgaW5wdXQnKTsKICAgICAgdGhpcy4kdXBsb2FkQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMuX191cGxvYWRJbnB1dCk7CiAgICB9IC8v6KOB5YmqCgoKICAgIGlmICh0aGlzLmZ1bmNCdG5zLmluY2x1ZGVzKCdjcm9wJykpIHsKICAgICAgaWYgKHRoaXMuJGNyb3BCdG4pIHsKICAgICAgICB0aGlzLiRjcm9wQnRuLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fX2Nyb3ApOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuX19jcm9wID0gdGhpcy5jcm9wLmJpbmQodGhpcyk7CiAgICAgIH0KCiAgICAgIHRoaXMuJGNyb3BCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHRoaXMuaWQgKyAnIC5jcm9wLWJ0bicpOwogICAgICB0aGlzLiRjcm9wQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fX2Nyb3ApOwogICAgfSAvL+aVtOinkuaXi+i9rAoKCiAgICBpZiAodGhpcy5mdW5jQnRucy5pbmNsdWRlcygnYXJvdW5kJykpIHsKICAgICAgaWYgKHRoaXMuJGFyb3VuZEJ0bikgewogICAgICAgIHRoaXMuJGFyb3VuZEJ0bi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX19hcm91bmQpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuX19hcm91bmQgPSB0aGlzLmFyb3VuZC5iaW5kKHRoaXMpOwogICAgICB9CgogICAgICB0aGlzLiRhcm91bmRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHRoaXMuaWQgKyAnIC5jcm9wLWFyb3VuZCcpOwogICAgICB0aGlzLiRhcm91bmRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9fYXJvdW5kKTsKICAgIH0gLy/ov5jljp8KCgogICAgaWYgKHRoaXMuZnVuY0J0bnMuaW5jbHVkZXMoJ3Jlc2V0JykpIHsKICAgICAgaWYgKHRoaXMuJHJlc2V0QnRuKSB7CiAgICAgICAgdGhpcy4kcmVzZXRCdG4ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnJlc2V0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLl9fcmVzZXQgPSB0aGlzLnJlc2V0LmJpbmQodGhpcyk7CiAgICAgIH0KCiAgICAgIHRoaXMuJHJlc2V0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB0aGlzLmlkICsgJyAuY3JvcC1yZXNldCcpOwogICAgICB0aGlzLiRyZXNldEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX19yZXNldCk7CiAgICB9IC8v5YWz6ZetCgoKICAgIGlmICh0aGlzLmZ1bmNCdG5zLmluY2x1ZGVzKCdjbG9zZScpKSB7CiAgICAgIGlmICh0aGlzLiRjbG9zZUJ0bikgewogICAgICAgIHRoaXMuJGNsb3NlQnRuLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbG9zZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5fX2Nsb3NlID0gdGhpcy5jbG9zZS5iaW5kKHRoaXMpOwogICAgICB9CgogICAgICB0aGlzLiRjbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdGhpcy5pZCArICcgLmNyb3AtY2xvc2UnKTsKICAgICAgdGhpcy4kY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9fY2xvc2UpOwogICAgfQoKICAgIGlmICh0aGlzLmZ1bmNCdG5zLmxlbmd0aCA+IDApIHsKICAgICAgdGhpcy4kY3JvcEJ0bnMuc3R5bGUudmlzaWJpbGl0eSA9ICcnOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy4kY3JvcEJ0bnMuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nOwogICAgfQogIH07IC8v5Yid5aeL5YyW5peL6L2s5Yi75bqm55uYCgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS5pbml0Um90YXRlU2xpZGVyID0gZnVuY3Rpb24gKHBhcmFtcykgewogICAgdGhpcy5yb3RhdGVTbGlkZXIgPSBwYXJhbXMucm90YXRlU2xpZGVyICE9IG51bGwgPyBwYXJhbXMucm90YXRlU2xpZGVyIDogdHJ1ZTsgLy/pu5jorqTlvIDlkK8KCiAgICB0aGlzLnN0YXJ0QW5nbGUgPSBwYXJhbXMuc3RhcnRBbmdsZSAhPSBudWxsID8gcGFyYW1zLnN0YXJ0QW5nbGUgOiAtOTA7CiAgICB0aGlzLmVuZEFuZ2xlID0gcGFyYW1zLmVuZEFuZ2xlICE9IG51bGwgPyBwYXJhbXMuZW5kQW5nbGUgOiA5MDsKICAgIHRoaXMuZ2FwQW5nbGUgPSBwYXJhbXMuZ2FwQW5nbGUgIT0gbnVsbCA/IHBhcmFtcy5nYXBBbmdsZSA6IDEwOwogICAgdGhpcy5saW5lYXRpb25JdGVtV2lkdGggPSBwYXJhbXMubGluZWF0aW9uSXRlbVdpZHRoICE9IG51bGwgPyBwYXJhbXMubGluZWF0aW9uSXRlbVdpZHRoIDogNDAuNTsKICAgIHRoaXMubGluZWF0aW9uSXRlbVdpZHRoID0gdGhpcy5saW5lYXRpb25JdGVtV2lkdGggPj0gNDAuNSA/IHRoaXMubGluZWF0aW9uSXRlbVdpZHRoIDogNDAuNTsgLy8g5pyA5bCP5a695bqm6ZmQ5Yi2CiAgICAvL+W8gOWni+inkuW6pumcgOimgeWwj+S6jjDvvIznu5PmnZ/op5LluqbpnIDopoHlpKfkuo4w77yM5LiU5byA5aeL6KeS5bqm5ZKM57uT5p2f6KeS5bqm5LmL6Ze05a2Y5Zyo5aSn5LqOMOeahOaVtOaVsOS4qumXtOmalAoKICAgIHRoaXMuc3RhcnRBbmdsZSA9IHRoaXMuc3RhcnRBbmdsZSA8IDAgPyBwYXJzZUludCh0aGlzLnN0YXJ0QW5nbGUpIDogMDsKICAgIHRoaXMuZW5kQW5nbGUgPSB0aGlzLmVuZEFuZ2xlID4gMCA/IHBhcnNlSW50KHRoaXMuZW5kQW5nbGUpIDogMDsKICAgIHRoaXMuZ2FwQW5nbGUgPSB0aGlzLmdhcEFuZ2xlID4gMCA/IHBhcnNlSW50KHRoaXMuZ2FwQW5nbGUpIDogMzsKCiAgICBpZiAoKHRoaXMuZW5kQW5nbGUgLSB0aGlzLnN0YXJ0QW5nbGUpICUgdGhpcy5nYXBBbmdsZSAhPSAwKSB7CiAgICAgIHRoaXMuZW5kQW5nbGUgPSBNYXRoLmNlaWwoKHRoaXMuZW5kQW5nbGUgLSB0aGlzLnN0YXJ0QW5nbGUpIC8gdGhpcy5nYXBBbmdsZSkgKiB0aGlzLmdhcEFuZ2xlICsgdGhpcy5zdGFydEFuZ2xlOwogICAgfQoKICAgIHRoaXMubGluZWF0aW9uV2lkdGggPSB0aGlzLmxpbmVhdGlvbkl0ZW1XaWR0aCAqICgodGhpcy5lbmRBbmdsZSAtIHRoaXMuc3RhcnRBbmdsZSkgLyB0aGlzLmdhcEFuZ2xlICsgMSk7CiAgICB0aGlzLiRjcm9wUm90YXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB0aGlzLmlkICsgJyAuY3JvcC1yb3RhdGUnKTsKICAgIHRoaXMuJGxpbmVhdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdGhpcy5pZCArICcgLmxpbmVhdGlvbicpOwogICAgdGhpcy4kcm90YXRlQ3VycmVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdGhpcy5pZCArICcgLmN1cnJlbnQnKTsKICAgIHZhciByb3RhdGVTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuJGNyb3BSb3RhdGUpOwogICAgdGhpcy5yb3RhdGVXaWR0aCA9IHBhcnNlRmxvYXQocm90YXRlU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnd2lkdGgnKSk7IC8vIOaXi+i9rOWIu+W6puebmOaYvuekuuWuveW6pgoKICAgIHRoaXMuX2Jhc2VNb3ZlWCA9IC0odGhpcy5saW5lYXRpb25XaWR0aCAqICgwIC0gdGhpcy5zdGFydEFuZ2xlICsgdGhpcy5nYXBBbmdsZSAvIDIpIC8gKHRoaXMuZW5kQW5nbGUgLSB0aGlzLnN0YXJ0QW5nbGUgKyB0aGlzLmdhcEFuZ2xlKSAtIHRoaXMucm90YXRlV2lkdGggLyAyKTsgLy/lvIDlp4vop5LluqblpKfkuo4gMCDkuJTnu5PmnZ/op5LluqblsI/kuo4gMO+8jOS7pSAwIOW6puS4uui1t+eCuQoKICAgIHZhciBhbmdsZSA9IHRoaXMucm90YXRlQW5nbGUgLSB0aGlzLl9iYXNlQW5nbGU7CiAgICB0aGlzLl9jdXJNb3ZlWCA9IGFuZ2xlICogdGhpcy5saW5lYXRpb25XaWR0aCAvICh0aGlzLmVuZEFuZ2xlIC0gdGhpcy5zdGFydEFuZ2xlICsgdGhpcy5nYXBBbmdsZSkgKyB0aGlzLl9iYXNlTW92ZVg7IC8v6LaF5Ye65rua5Yqo6L6555WM77yM5peL6L2s5Yi75bqm55uY6YeN572uCgogICAgaWYgKHRoaXMuX2N1ck1vdmVYID4gMCB8fCB0aGlzLl9jdXJNb3ZlWCA8IHRoaXMucm90YXRlV2lkdGggLSB0aGlzLmxpbmVhdGlvbldpZHRoKSB7CiAgICAgIHRoaXMuc3RhcnRDb250cm9sKCk7CiAgICAgIHRoaXMuX2N1ck1vdmVYID0gdGhpcy5fYmFzZU1vdmVYOwogICAgICB0aGlzLl9iYXNlQW5nbGUgPSAwOwogICAgICB0aGlzLnJvdGF0ZUFuZ2xlID0gMDsKICAgICAgdGhpcy5fY2hhbmdlZFggPSAwOwogICAgICB0aGlzLl9yb3RhdGVTY2FsZSA9IDE7CiAgICAgIHRoaXMudHJhbnNmb3JtKHRydWUpOwogICAgICB0aGlzLmVuZENvbnRyb2woKTsKICAgIH0gLy9zZXREYXRhCgoKICAgIHZhciBodG1sID0gJyc7CgogICAgZm9yICh2YXIgaSA9IHRoaXMuc3RhcnRBbmdsZTsgaSA8PSB0aGlzLmVuZEFuZ2xlOyBpICs9IHRoaXMuZ2FwQW5nbGUpIHsKICAgICAgaHRtbCArPSAnPGxpPjxkaXYgY2xhc3M9Im51bWJlciI+JyArIGkgKyAnPC9kaXY+PGRpdiBjbGFzcz0iYmciPjwvZGl2PjwvbGk+JzsKICAgIH0KCiAgICB0aGlzLiRsaW5lYXRpb24uaW5uZXJIVE1MID0gaHRtbDsKICAgIHRoaXMuJGxpbmVhdGlvbi5zdHlsZS53aWR0aCA9IHRoaXMubGluZWF0aW9uV2lkdGggKyAncHgnOwogICAgdGhpcy4kbGluZWF0aW9uLnN0eWxlW3RyYW5zZm9ybVByb3BlcnR5XSA9ICd0cmFuc2xhdGVYKCcgKyB0aGlzLl9jdXJNb3ZlWCArICdweCknOwoKICAgIGlmICh0aGlzLnJvdGF0ZVNsaWRlcikgewogICAgICB0aGlzLiRjcm9wUm90YXRlLnN0eWxlLnZpc2liaWxpdHkgPSAnJzsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuJGNyb3BSb3RhdGUuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nOwogICAgfQogIH07IC8v5Yid5aeL5YyW55u45YWz5a2Q5YWD57SgCgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS5pbml0Q2hpbGRzID0gZnVuY3Rpb24gKCkgewogICAgdGhpcy4kY3JvcE1hc2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHRoaXMuaWQgKyAnIC5jcm9wLW1hc2snKTsKICAgIHZhciBtYXNrU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLiRjcm9wTWFzayk7CiAgICB0aGlzLm1hc2tWaWV3U2l6ZSA9IHsKICAgICAgd2lkdGg6IHBhcnNlSW50KG1hc2tTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCd3aWR0aCcpKSwKICAgICAgaGVpZ2h0OiBwYXJzZUludChtYXNrU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnaGVpZ2h0JykpCiAgICB9OwogICAgdGhpcy4kY3JvcENvdmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB0aGlzLmlkICsgJyAuY3JvcC1jb3ZlcicpOwogICAgdGhpcy5jcm9wQ292ZXJDb250ZXh0ID0gdGhpcy4kY3JvcENvdmVyLmdldENvbnRleHQoJzJkJyk7CiAgICB0aGlzLiRjcm9wQ292ZXIud2lkdGggPSB0aGlzLm1hc2tWaWV3U2l6ZS53aWR0aCAqIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvOwogICAgdGhpcy4kY3JvcENvdmVyLmhlaWdodCA9IHRoaXMubWFza1ZpZXdTaXplLmhlaWdodCAqIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvOyAvL+a7keWKqOaOp+WItuadoQoKICAgIHRoaXMuJGNyb3BTY2FsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdGhpcy5pZCArICcgLmNyb3Atc2NhbGUnKTsKICAgIHRoaXMuJHNjYWxlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB0aGlzLmlkICsgJyAuc2NhbGUtYnRuJyk7CiAgICB0aGlzLiRzY2FsZU51bSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdGhpcy5pZCArICcgLnNjYWxlLW51bScpOwogICAgdGhpcy4kc2NhbGVPbmVUaW1lcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdGhpcy5pZCArICcgLm9uZS10aW1lcy1pY29uJyk7CiAgICB0aGlzLiRzY2FsZVR3b1RpbWVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB0aGlzLmlkICsgJyAudHdvLXRpbWVzLWljb24nKTsKICAgIHRoaXMuJHNjYWxlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB0aGlzLmlkICsgJyAuc2NhbGUtY29udGFpbmVyJyk7CiAgICB0aGlzLiRzY2FsZVZhbHVlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB0aGlzLmlkICsgJyAuc2NhbGUtdmFsdWUnKTsKICAgIHRoaXMuJG1heFNjYWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB0aGlzLmlkICsgJyAubWF4LXNjYWxlJyk7CiAgICB0aGlzLnNjYWxlRG93blggPSAwOwogICAgdGhpcy5zY2FsZUluaXRMZWZ0ID0gdGhpcy4kc2NhbGVCdG4uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDsKICAgIHRoaXMuc2NhbGVDdXJMZWZ0ID0gdGhpcy5zY2FsZUluaXRMZWZ0OwogICAgdGhpcy5zY2FsZVdpZHRoID0gdGhpcy4kc2NhbGVOdW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg7CiAgfTsgLy/moLnmja7oo4Hliarlm77niYfnm67moIflsLrlr7jjgIHoo4HliarmoYbmmL7npLrmr5TkvovjgIHoo4HliarmoYblgY/np7vmm7TmlrDnrYnlj4LmlbDmm7TmlrDlubbph43njrDnu5jliLboo4HliarmoYYKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLnVwZGF0ZUJveCA9IGZ1bmN0aW9uIChwYXJhbXMpIHsKICAgIHRoaXMuc2l6ZSA9IHBhcmFtcy5zaXplOwogICAgdGhpcy5wb3NpdGlvbk9mZnNldCA9IHBhcmFtcy5wb3NpdGlvbk9mZnNldCAhPSBudWxsID8gcGFyYW1zLnBvc2l0aW9uT2Zmc2V0IDogewogICAgICB0b3A6IDAsCiAgICAgIGxlZnQ6IDAKICAgIH07CiAgICB0aGlzLmNyb3BTaXplUGVyY2VudCA9IHBhcmFtcy5jcm9wU2l6ZVBlcmNlbnQgIT0gbnVsbCA/IHBhcmFtcy5jcm9wU2l6ZVBlcmNlbnQgOiAwLjU7IC8v6buY6K6kMC415YiZ6KGo56S66auY5bqm5oiW6ICF5a695bqm5pyA5aSa5Y2gNTAlCgogICAgdGhpcy50aW1lcyA9IHRoaXMuc2l6ZS53aWR0aCAvIHRoaXMubWFza1ZpZXdTaXplLndpZHRoID4gdGhpcy5zaXplLmhlaWdodCAvIHRoaXMubWFza1ZpZXdTaXplLmhlaWdodCA/IHRoaXMuc2l6ZS53aWR0aCAvIHRoaXMubWFza1ZpZXdTaXplLndpZHRoIC8gdGhpcy5jcm9wU2l6ZVBlcmNlbnQgOiB0aGlzLnNpemUuaGVpZ2h0IC8gdGhpcy5tYXNrVmlld1NpemUuaGVpZ2h0IC8gdGhpcy5jcm9wU2l6ZVBlcmNlbnQ7IC8v6KOB5Ymq5qGG5L2N572u55u45YWzCgogICAgdGhpcy5jcm9wUmVjdCA9IHsKICAgICAgd2lkdGg6IHRoaXMuc2l6ZS53aWR0aCAvIHRoaXMudGltZXMsCiAgICAgIGhlaWdodDogdGhpcy5zaXplLmhlaWdodCAvIHRoaXMudGltZXMKICAgIH07CiAgICB0aGlzLmNyb3BSZWN0LmxlZnQgPSAodGhpcy5tYXNrVmlld1NpemUud2lkdGggLSB0aGlzLmNyb3BSZWN0LndpZHRoKSAvIDIgLSB0aGlzLnBvc2l0aW9uT2Zmc2V0LmxlZnQ7CiAgICB0aGlzLmNyb3BSZWN0LnRvcCA9ICh0aGlzLm1hc2tWaWV3U2l6ZS5oZWlnaHQgLSB0aGlzLmNyb3BSZWN0LmhlaWdodCkgLyAyIC0gdGhpcy5wb3NpdGlvbk9mZnNldC50b3A7CiAgICB0aGlzLmNyb3BQb2ludHMgPSB0aGlzLnJlY3RUb1BvaW50cyh0aGlzLmNyb3BSZWN0KTsKICAgIHRoaXMuY3JvcENlbnRlciA9IHRoaXMuZ2V0UG9pbnRzQ2VudGVyKHRoaXMuY3JvcFBvaW50cyk7CiAgICB0aGlzLmJvcmRlckRyYXcodGhpcy4kY3JvcENvdmVyKTsKICAgIHRoaXMuY292ZXJEcmF3KHRoaXMuJGNyb3BDb3Zlcik7CiAgICB2YXIgc3JjID0gcGFyYW1zLnNyYyAhPSBudWxsID8gcGFyYW1zLnNyYyA6IHRoaXMuc3JjOwogICAgdGhpcy5zZXRJbWFnZShzcmMpOwogIH07IC8v6I635Y+W5pON5L2c54K5CgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS5nZXRDb250cm9sUG9pbnRzID0gZnVuY3Rpb24gKGUpIHsKICAgIGlmIChlLnRvdWNoZXMpIHsKICAgICAgcmV0dXJuIGUudG91Y2hlczsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBbewogICAgICAgIGNsaWVudFg6IGUuY2xpZW50WCwKICAgICAgICBjbGllbnRZOiBlLmNsaWVudFkKICAgICAgfV07CiAgICB9CiAgfTsgLy/ojrflj5bmk43kvZzkuovku7blkI3np7AKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmdldENvbnRyb2xFdmVudHMgPSBmdW5jdGlvbiAoKSB7CiAgICBpZiAodGhpcy5pc1N1cHBvcnRUb3VjaCkgewogICAgICByZXR1cm4gewogICAgICAgIHN0YXJ0OiAndG91Y2hzdGFydCcsCiAgICAgICAgbW92ZTogJ3RvdWNobW92ZScsCiAgICAgICAgZW5kOiAndG91Y2hlbmQnLAogICAgICAgIGNhbmNlbDogJ3RvdWNoY2FuY2VsJwogICAgICB9OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBzdGFydDogJ21vdXNlZG93bicsCiAgICAgICAgbW92ZTogJ21vdXNlbW92ZScsCiAgICAgICAgZW5kOiAnbW91c2V1cCcsCiAgICAgICAgY2FuY2VsOiAnbW91c2VsZWF2ZScKICAgICAgfTsKICAgIH0KICB9OyAvL+WIneWni+WMlua7keWKqOaOp+WItuadoQoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUuaW5pdFNjYWxlU2xpZGVyID0gZnVuY3Rpb24gKHBhcmFtcykgewogICAgaWYgKHBhcmFtcykgewogICAgICB0aGlzLnNjYWxlU2xpZGVyID0gcGFyYW1zLnNjYWxlU2xpZGVyICE9IG51bGwgPyBwYXJhbXMuc2NhbGVTbGlkZXIgOiBmYWxzZTsKICAgICAgdGhpcy5tYXhTY2FsZSA9IHBhcmFtcy5tYXhTY2FsZSA/IHBhcmFtcy5tYXhTY2FsZSA6IDE7IC8v5pyA5aSn57yp5pS+5YCN5pWw77yM6buY6K6k5Li65Y6f5aeL5bC65a+4CiAgICB9CgogICAgdGhpcy5zY2FsZVRpbWVzID0gdGhpcy5pbml0U2NhbGU7CiAgICB0aGlzLm1heFNjYWxlID0gdGhpcy5pbml0U2NhbGUgPCB0aGlzLm1heFNjYWxlID8gdGhpcy5tYXhTY2FsZSA6IE1hdGguY2VpbCh0aGlzLmluaXRTY2FsZSk7CiAgICB0aGlzLl9zY2FsZU1vdmVYID0gMDsKICAgIHRoaXMuc2NhbGVDdXJMZWZ0ID0gdGhpcy5zY2FsZUluaXRMZWZ0OwogICAgdGhpcy4kbWF4U2NhbGUuaW5uZXJUZXh0ID0gJyh4JyArIHRoaXMubWF4U2NhbGUgKyAnKSc7CiAgICB0aGlzLiRzY2FsZUJ0bi5zdHlsZVt0cmFuc2Zvcm1Qcm9wZXJ0eV0gPSAndHJhbnNsYXRlWCgwcHgpJzsKICAgIHRoaXMuJHNjYWxlVmFsdWUuc3R5bGUud2lkdGggPSAnMHB4JzsKCiAgICBpZiAodGhpcy5zY2FsZVNsaWRlcikgewogICAgICB0aGlzLiRjcm9wU2NhbGUuc3R5bGUudmlzaWJpbGl0eSA9ICcnOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy4kY3JvcFNjYWxlLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJzsKICAgIH0KCiAgICB0aGlzLnRyYW5zZm9ybShmYWxzZSwgdHJ1ZSk7CiAgfTsgLy9odG1s57uT5p6ECgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS5jb25zdHJ1Y3QgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgaHRtbCA9ICcnOwogICAgaHRtbCArPSAnPGRpdiBjbGFzcz0iY3JvcC1jb21wb25lbnQiPic7CiAgICBodG1sICs9ICc8cCBjbGFzcz0iY3JvcC10aXRsZSI+JyArIHRoaXMudGl0bGUgKyAnPC9wPic7CiAgICBodG1sICs9ICc8ZGl2IGNsYXNzPSJjcm9wLW1hc2siPic7CiAgICBodG1sICs9ICc8Y2FudmFzIGNsYXNzPSJjcm9wLWNvdmVyIj48L2NhbnZhcz4nOwogICAgaHRtbCArPSAnPC9kaXY+JzsgLy/mu5HliqjmjqfliLbmnaEKCiAgICBpZiAodGhpcy5zY2FsZVNsaWRlcikgewogICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPSJjcm9wLXNjYWxlIj4nOwogICAgfSBlbHNlIHsKICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz0iY3JvcC1zY2FsZSIgc3R5bGU9InZpc2liaWxpdHk6aGlkZGVuOyI+JzsKICAgIH0KCiAgICBodG1sICs9ICc8ZGl2IGNsYXNzPSJvbmUtdGltZXMtaWNvbiI+PC9kaXY+JzsKICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9InNjYWxlLWNvbnRhaW5lciI+JzsKICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9InNjYWxlLW51bSI+PHNwYW4gY2xhc3M9InNjYWxlLXZhbHVlIiBzdHlsZT0id2lkdGg6MHB4OyI+PC9zcGFuPjxzcGFuIGNsYXNzPSJzY2FsZS1idG4iIHN0eWxlPSJsZWZ0Oi04cHg7Ij48L3NwYW4+PC9kaXY+JzsKICAgIGh0bWwgKz0gJzwvZGl2Pic7CiAgICBodG1sICs9ICc8ZGl2IGNsYXNzPSJ0d28tdGltZXMtaWNvbiI+PC9kaXY+JzsKICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9Im1heC1zY2FsZSI+PC9kaXY+JzsKICAgIGh0bWwgKz0gJzwvZGl2Pic7IC8v5peL6L2s5Yi75bqm55uYCgogICAgaWYgKHRoaXMucm90YXRlU2xpZGVyKSB7CiAgICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9ImNyb3Atcm90YXRlIj4nOwogICAgfSBlbHNlIHsKICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz0iY3JvcC1yb3RhdGUiIHN0eWxlPSJ2aXNpYmlsaXR5OmhpZGRlbjsiPic7CiAgICB9CgogICAgaHRtbCArPSAnPHVsIGNsYXNzPSJsaW5lYXRpb24iPic7CiAgICBodG1sICs9ICc8L3VsPic7CiAgICBodG1sICs9ICc8ZGl2IGNsYXNzPSJjdXJyZW50Ij48L2Rpdj4nOwogICAgaHRtbCArPSAnPC9kaXY+JzsgLy/lip/og73mjInpkq4KCiAgICBodG1sICs9ICc8ZGl2IGNsYXNzPSJjcm9wLWJ0bnMiIHN0eWxlPSJ2aXNpYmlsaXR5OmhpZGRlbjsiPjwvZGl2Pic7CiAgICBodG1sICs9ICc8L2Rpdj4nOwogICAgdGhpcy4kdGFyZ2V0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICB0aGlzLiR0YXJnZXQuaWQgPSB0aGlzLmlkOwogICAgdGhpcy4kdGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2Nyb3Atd2hvbGUtY292ZXInKTsKCiAgICBpZiAodGhpcy52aXNpYmxlKSB7CiAgICAgIHRoaXMuJHRhcmdldC5zdHlsZS52aXNpYmlsaXR5ID0gJyc7CiAgICB9IGVsc2UgewogICAgICB0aGlzLiR0YXJnZXQuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nOwogICAgfQoKICAgIHRoaXMuJHRhcmdldC5pbm5lckhUTUwgPSBodG1sOwogICAgdGhpcy4kY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuJHRhcmdldCk7CiAgfTsgLy/pu5jorqTnu5jliLboo4HliarmoYYKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmRlZmF1bHRCb3JkZXJEcmF3ID0gZnVuY3Rpb24gKCRjcm9wQ292ZXIpIHsKICAgIHZhciBib3JkZXJXaWR0aCA9IHRoaXMuYm9yZGVyV2lkdGg7CiAgICB2YXIgYm9sZENvcm5lckxlbiA9IHRoaXMuYm9sZENvcm5lckxlbjsKICAgIGJvbGRDb3JuZXJMZW4gPSBib2xkQ29ybmVyTGVuID49IGJvcmRlcldpZHRoICogMiA/IGJvbGRDb3JuZXJMZW4gOiBib3JkZXJXaWR0aCAqIDI7CiAgICB2YXIgY292ZXJXaWR0aCA9ICRjcm9wQ292ZXIud2lkdGg7CiAgICB2YXIgY292ZXJIZWlnaHQgPSAkY3JvcENvdmVyLmhlaWdodDsKICAgIHRoaXMuY3JvcENvdmVyQ29udGV4dC5jbGVhclJlY3QoMCwgMCwgY292ZXJXaWR0aCwgY292ZXJIZWlnaHQpOwogICAgdGhpcy5jcm9wQ292ZXJDb250ZXh0LmZpbGxTdHlsZSA9IHRoaXMuY292ZXJDb2xvcjsKICAgIHRoaXMuY3JvcENvdmVyQ29udGV4dC5maWxsUmVjdCgwLCAwLCBjb3ZlcldpZHRoLCBjb3ZlckhlaWdodCk7IC8v57uY5Yi26L655qGG77yI6L655qGG5YaF5bWM77yJCgogICAgdmFyIGJvcmRlclJlY3QgPSB7CiAgICAgIGxlZnQ6IHRoaXMuY3JvcFJlY3QubGVmdCAqIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvLAogICAgICB0b3A6IHRoaXMuY3JvcFJlY3QudG9wICogd2luZG93LmRldmljZVBpeGVsUmF0aW8sCiAgICAgIHdpZHRoOiB0aGlzLmNyb3BSZWN0LndpZHRoICogd2luZG93LmRldmljZVBpeGVsUmF0aW8sCiAgICAgIGhlaWdodDogdGhpcy5jcm9wUmVjdC5oZWlnaHQgKiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbwogICAgfTsKICAgIHRoaXMuY3JvcENvdmVyQ29udGV4dC5maWxsU3R5bGUgPSB0aGlzLmJvcmRlckNvbG9yOwogICAgdGhpcy5jcm9wQ292ZXJDb250ZXh0LmZpbGxSZWN0KGJvcmRlclJlY3QubGVmdCwgYm9yZGVyUmVjdC50b3AsIGJvcmRlclJlY3Qud2lkdGgsIGJvcmRlclJlY3QuaGVpZ2h0KTsKCiAgICBpZiAodGhpcy5ib2xkQ29ybmVyTGVuID4gMCkgewogICAgICAvL+i+ueahhuWbm+S4quinkuWKoOeylwogICAgICB0aGlzLmNyb3BDb3ZlckNvbnRleHQuZmlsbFJlY3QoYm9yZGVyUmVjdC5sZWZ0IC0gYm9yZGVyV2lkdGgsIGJvcmRlclJlY3QudG9wIC0gYm9yZGVyV2lkdGgsIGJvbGRDb3JuZXJMZW4sIGJvbGRDb3JuZXJMZW4pOyAvL+W3puS4iuinkgoKICAgICAgdGhpcy5jcm9wQ292ZXJDb250ZXh0LmZpbGxSZWN0KGJvcmRlclJlY3QubGVmdCArIGJvcmRlclJlY3Qud2lkdGggLSBib2xkQ29ybmVyTGVuICsgYm9yZGVyV2lkdGgsIGJvcmRlclJlY3QudG9wIC0gYm9yZGVyV2lkdGgsIGJvbGRDb3JuZXJMZW4sIGJvbGRDb3JuZXJMZW4pOyAvL+WPs+S4iuinkgoKICAgICAgdGhpcy5jcm9wQ292ZXJDb250ZXh0LmZpbGxSZWN0KGJvcmRlclJlY3QubGVmdCAtIGJvcmRlcldpZHRoLCBib3JkZXJSZWN0LnRvcCArIGJvcmRlclJlY3QuaGVpZ2h0IC0gYm9sZENvcm5lckxlbiArIGJvcmRlcldpZHRoLCBib2xkQ29ybmVyTGVuLCBib2xkQ29ybmVyTGVuKTsgLy/lt6bkuIvop5IKCiAgICAgIHRoaXMuY3JvcENvdmVyQ29udGV4dC5maWxsUmVjdChib3JkZXJSZWN0LmxlZnQgKyBib3JkZXJSZWN0LndpZHRoIC0gYm9sZENvcm5lckxlbiArIGJvcmRlcldpZHRoLCBib3JkZXJSZWN0LnRvcCArIGJvcmRlclJlY3QuaGVpZ2h0IC0gYm9sZENvcm5lckxlbiArIGJvcmRlcldpZHRoLCBib2xkQ29ybmVyTGVuLCBib2xkQ29ybmVyTGVuKTsgLy/lj7PkuIvop5IKICAgIH0gLy/muIXnqbrlhoXlrrnljLrln58KCgogICAgdGhpcy5jcm9wQ292ZXJDb250ZXh0LmNsZWFyUmVjdChib3JkZXJSZWN0LmxlZnQgKyBib3JkZXJXaWR0aCwgYm9yZGVyUmVjdC50b3AgKyBib3JkZXJXaWR0aCwgYm9yZGVyUmVjdC53aWR0aCAtIDIgKiBib3JkZXJXaWR0aCwgYm9yZGVyUmVjdC5oZWlnaHQgLSAyICogYm9yZGVyV2lkdGgpOwogIH07IC8v5Yid5aeL5YyWCgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkgewogICAgdmFyIHdpZHRoID0gdGhpcy5jb250ZW50V2lkdGggLyAyOwogICAgdmFyIGhlaWdodCA9IHRoaXMuY29udGVudEhlaWdodCAvIDI7CiAgICB0aGlzLmluaXRDb250ZW50UG9pbnRzID0gW3sKICAgICAgeDogLXdpZHRoLAogICAgICB5OiBoZWlnaHQKICAgIH0sIHsKICAgICAgeDogd2lkdGgsCiAgICAgIHk6IGhlaWdodAogICAgfSwgewogICAgICB4OiB3aWR0aCwKICAgICAgeTogLWhlaWdodAogICAgfSwgewogICAgICB4OiAtd2lkdGgsCiAgICAgIHk6IC1oZWlnaHQKICAgIH1dOwogICAgdGhpcy5jb250ZW50UG9pbnRzID0gdGhpcy5pbml0Q29udGVudFBvaW50cy5zbGljZSgpOyAvL+iuoeeul+WIneWni+e8qeaUvuWAjeaVsAoKICAgIGlmICh0aGlzLnNpemUud2lkdGggLyB0aGlzLnNpemUuaGVpZ2h0ID4gdGhpcy5jb250ZW50V2lkdGggLyB0aGlzLmNvbnRlbnRIZWlnaHQpIHsKICAgICAgdGhpcy5pbml0U2NhbGUgPSB0aGlzLnNpemUud2lkdGggLyB0aGlzLmNvbnRlbnRXaWR0aDsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuaW5pdFNjYWxlID0gdGhpcy5zaXplLmhlaWdodCAvIHRoaXMuY29udGVudEhlaWdodDsKICAgIH0KCiAgICB0aGlzLnJlc2V0KCk7CiAgfTsgLy/ph43nva4KCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkgewogICAgdGhpcy5zdGFydENvbnRyb2woKTsKICAgIHRoaXMuX2NvbnRlbnRDdXJNb3ZlWCA9IC10aGlzLnBvc2l0aW9uT2Zmc2V0LmxlZnQ7CiAgICB0aGlzLl9jb250ZW50Q3VyTW92ZVkgPSAtdGhpcy5wb3NpdGlvbk9mZnNldC50b3A7CiAgICB0aGlzLl9yb3RhdGVTY2FsZSA9IDE7CiAgICB0aGlzLl9iYXNlQW5nbGUgPSAwOwogICAgdGhpcy5yb3RhdGVBbmdsZSA9IDA7CiAgICB0aGlzLl9jdXJNb3ZlWCA9IHRoaXMuX2Jhc2VNb3ZlWDsKICAgIHRoaXMuX2NoYW5nZWRYID0gMDsKICAgIHRoaXMuJGxpbmVhdGlvbi5zdHlsZVt0cmFuc2Zvcm1Qcm9wZXJ0eV0gPSAndHJhbnNsYXRlWCgnICsgdGhpcy5fYmFzZU1vdmVYICsgJ3B4KSc7CiAgICB0aGlzLmluaXRTY2FsZVNsaWRlcigpOwogICAgdGhpcy5lbmRDb250cm9sKCk7CiAgfTsgLy/liqDovb3lm77niYcKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CgogICAgc2VsZi5vcmlnaW5JbWFnZS5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIEVYSUYuZ2V0RGF0YShzZWxmLm9yaWdpbkltYWdlLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgc2VsZi5fb3JpZW50YXRpb24gPSBFWElGLmdldFRhZyh0aGlzLCAnT3JpZW50YXRpb24nKTsKICAgICAgICBzZWxmLmdldFJlYWxDb3RlbnRTaXplKCk7CiAgICAgICAgc2VsZi50cmFuc2Zvcm1Db29yZGluYXRlcygpOwogICAgICAgIHNlbGYuaW5pdCgpOwogICAgICB9KTsKICAgIH07CiAgfTsgLy/orr7nva7oo4Hliarlm77niYcKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLnNldEltYWdlID0gZnVuY3Rpb24gKGltYWdlKSB7CiAgICBpZiAoaW1hZ2UgIT0gbnVsbCAmJiBpbWFnZSAhPSAnJykgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIHZhciB0eXBlID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGltYWdlKTsKCiAgICAgIGlmICh0eXBlID09PSAnW29iamVjdCBTdHJpbmddJykgewogICAgICAgIC8v5a2X56ym5LiyCiAgICAgICAgc2VsZi5zcmMgPSBpbWFnZTsKICAgICAgICBzZWxmLm9yaWdpbkltYWdlID0gbmV3IEltYWdlKCk7CiAgICAgICAgc2VsZi5vcmlnaW5JbWFnZS5zcmMgPSBzZWxmLnNyYzsKICAgICAgICBzZWxmLmxvYWQoKTsKICAgICAgICBzZWxmLnVwbG9hZENhbGxiYWNrKHNlbGYuc3JjKTsKICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnW29iamVjdCBGaWxlXScpIHsKICAgICAgICAvL+aWh+S7tgogICAgICAgIHNlbGYuZmlsZVRvU3JjKGltYWdlLCBmdW5jdGlvbiAoc3JjKSB7CiAgICAgICAgICBzZWxmLnNyYyA9IHNyYzsKICAgICAgICAgIHNlbGYub3JpZ2luSW1hZ2UgPSBuZXcgSW1hZ2UoKTsKICAgICAgICAgIHNlbGYub3JpZ2luSW1hZ2Uuc3JjID0gc2VsZi5zcmM7CiAgICAgICAgICBzZWxmLmxvYWQoKTsKICAgICAgICAgIHNlbGYudXBsb2FkQ2FsbGJhY2soc2VsZi5zcmMpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfTsgLy/mmL7npLoKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoaW1hZ2UpIHsKICAgIGlmIChpbWFnZSkgewogICAgICB0aGlzLnNldEltYWdlKGltYWdlKTsKICAgIH0KCiAgICB0aGlzLnZpc2libGUgPSB0cnVlOwogICAgdGhpcy4kdGFyZ2V0LnN0eWxlLnZpc2liaWxpdHkgPSAnJzsKICB9OyAvL+makOiXjwoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUuaGlkZSA9IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlOwogICAgdGhpcy4kdGFyZ2V0LnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJzsKICB9OyAvL+WFs+mXrQoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmhpZGUoKTsKICAgIHRoaXMuY2xvc2VDYWxsYmFjaygpOwogIH07IC8v6KOB5YmqCgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKCkgewogICAgdGhpcy5nZXRDcm9wSW1hZ2UoKTsKICAgIHRoaXMuY3JvcENhbGxiYWNrKHRoaXMuJHJlc3VsdENhbnZhcyk7CiAgICB0aGlzLmhpZGUoKTsKICB9OyAvL+S4iuS8oAoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUudXBsb2FkSW5wdXQgPSBmdW5jdGlvbiAoZXZ0KSB7CiAgICB2YXIgZmlsZXMgPSBldnQudGFyZ2V0LmZpbGVzOwoKICAgIGlmIChmaWxlcy5sZW5ndGggPiAwKSB7CiAgICAgIHRoaXMuc2hvdyhmaWxlc1swXSk7CiAgICB9CgogICAgdGhpcy4kdXBsb2FkSW5wdXQudmFsdWUgPSAnJzsgLy/muIXnqbp2YWx1ZeWxnuaAp++8jOS7juiAjOS/neivgeeUqOaIt+S/ruaUueaWh+S7tuWGheWuueS9huaYr+ayoeacieS/ruaUueaWh+S7tuWQjeaXtuS+neeEtuiDveS4iuS8oOaIkOWKnwogIH07IC8v5pW06KeS5peL6L2sCgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS5hcm91bmQgPSBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLnN0YXJ0Q29udHJvbCgpOwogICAgdGhpcy5yb3RhdGVBbmdsZSA9ICh0aGlzLl9iYXNlQW5nbGUgLSA5MCkgJSAzNjA7CiAgICB0aGlzLl9iYXNlQW5nbGUgPSB0aGlzLnJvdGF0ZUFuZ2xlOwogICAgdGhpcy5fY3VyTW92ZVggPSB0aGlzLl9iYXNlTW92ZVg7CiAgICB0aGlzLl9jaGFuZ2VkWCA9IDA7CiAgICB0aGlzLl9yb3RhdGVTY2FsZSA9IDE7CiAgICB0aGlzLiRsaW5lYXRpb24uc3R5bGVbdHJhbnNmb3JtUHJvcGVydHldID0gJ3RyYW5zbGF0ZVgoJyArIHRoaXMuX2Jhc2VNb3ZlWCArICdweCknOwogICAgdGhpcy50cmFuc2Zvcm0oZmFsc2UsIHRydWUpOwogICAgdGhpcy5lbmRDb250cm9sKCk7CiAgfTsgLy/kuovku7bnm5HlkKwKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmJpbmRFdmVudCA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciBzZWxmID0gdGhpczsKICAgIHZhciBjb250cm9sRXZlbnRzID0gdGhpcy5nZXRDb250cm9sRXZlbnRzKCk7IC8v5ruR5Yqo5o6n5Yi25p2hCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0gLy8KCiAgICBzZWxmLiRzY2FsZUJ0bi5hZGRFdmVudExpc3RlbmVyKGNvbnRyb2xFdmVudHMuc3RhcnQsIGZ1bmN0aW9uIChldikgewogICAgICBzZWxmLnNjYWxlRG93blggPSBzZWxmLmdldENvbnRyb2xQb2ludHMoZXYpWzBdLmNsaWVudFg7CiAgICAgIHNlbGYuc3RhcnRDb250cm9sKCk7CiAgICB9KTsKICAgIHNlbGYuJHNjYWxlQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoY29udHJvbEV2ZW50cy5tb3ZlLCBmdW5jdGlvbiAoZXYpIHsKICAgICAgc2VsZi5zY2FsZU1vdmUoZXYpOwogICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTsKICAgIH0pOwogICAgc2VsZi4kc2NhbGVDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihjb250cm9sRXZlbnRzLmNhbmNlbCwgc2VsZi5lbmRDb250cm9sLmJpbmQoc2VsZikpOyAvL+e7k+adnwoKICAgIHNlbGYuJHNjYWxlQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoY29udHJvbEV2ZW50cy5lbmQsIHNlbGYuZW5kQ29udHJvbC5iaW5kKHNlbGYpKTsKICAgIHNlbGYuJHNjYWxlQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2KSB7CiAgICAgIHNlbGYuc3RhcnRDb250cm9sKCk7CiAgICAgIHZhciByZWN0ID0gc2VsZi4kc2NhbGVCdG4uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CgogICAgICBpZiAoc2VsZi5zY2FsZURvd25YIDw9IDApIHsKICAgICAgICBzZWxmLnNjYWxlRG93blggPSByZWN0LmxlZnQgKyByZWN0LndpZHRoICogMS4wIC8gMjsKICAgICAgfQoKICAgICAgc2VsZi5zY2FsZU1vdmUoZXYpOwogICAgICBzZWxmLmVuZENvbnRyb2woKTsKICAgIH0pOwogICAgc2VsZi4kc2NhbGVPbmVUaW1lcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgLy/mnoHlsI8KICAgICAgc2VsZi5zdGFydENvbnRyb2woKTsKICAgICAgc2VsZi5zY2FsZU1vdmVBdCgwKTsKICAgICAgc2VsZi5lbmRDb250cm9sKCk7CiAgICB9KTsKICAgIHNlbGYuJHNjYWxlVHdvVGltZXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgIC8v5p6B5aSnCiAgICAgIHNlbGYuc3RhcnRDb250cm9sKCk7CiAgICAgIHNlbGYuc2NhbGVNb3ZlQXQoc2VsZi5zY2FsZVdpZHRoKTsKICAgICAgc2VsZi5lbmRDb250cm9sKCk7CiAgICB9KTsgLy8gLS0tLS0tLS0tLS0tLS0tLS0tIC8vCiAgICAvL+aXi+i9rOWIu+W6puebmAogICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tIC8vCgogICAgc2VsZi4kY3JvcFJvdGF0ZS5hZGRFdmVudExpc3RlbmVyKGNvbnRyb2xFdmVudHMuc3RhcnQsIGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciB0b3VjaGVzID0gc2VsZi5nZXRDb250cm9sUG9pbnRzKGUpOwogICAgICBzZWxmLnN0YXJ0Q29udHJvbCh0b3VjaGVzKTsKICAgIH0pOwogICAgc2VsZi4kY3JvcFJvdGF0ZS5hZGRFdmVudExpc3RlbmVyKGNvbnRyb2xFdmVudHMubW92ZSwgZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHRvdWNoZXMgPSBzZWxmLmdldENvbnRyb2xQb2ludHMoZSk7CgogICAgICBpZiAoc2VsZi5fZG93blBvaW50cyAmJiBzZWxmLl9kb3duUG9pbnRzLmxlbmd0aCA+IDAgJiYgIXNlbGYuX211bHRpUG9pbnQpIHsKICAgICAgICB2YXIgcG9pbnQgPSB0b3VjaGVzWzBdOwogICAgICAgIHZhciBtb3ZlWCA9IHBvaW50LmNsaWVudFggLSBzZWxmLl9kb3duUG9pbnRzWzBdLmNsaWVudFg7CiAgICAgICAgdmFyIGxhc3RNb3ZlWCA9IHNlbGYuX2N1ck1vdmVYOwogICAgICAgIHZhciBjdXJNb3ZlWCA9IGxhc3RNb3ZlWCArIG1vdmVYOwoKICAgICAgICBpZiAoY3VyTW92ZVggPD0gMCAmJiBjdXJNb3ZlWCA+PSBzZWxmLnJvdGF0ZVdpZHRoIC0gc2VsZi5saW5lYXRpb25XaWR0aCkgewogICAgICAgICAgLy/mu5rliqjovrnnlYwKICAgICAgICAgIHZhciBhbmdsZSA9IChjdXJNb3ZlWCAtIHNlbGYuX2Jhc2VNb3ZlWCkgLyBzZWxmLmxpbmVhdGlvbldpZHRoICogKHNlbGYuZW5kQW5nbGUgLSBzZWxmLnN0YXJ0QW5nbGUgKyBzZWxmLmdhcEFuZ2xlKTsKICAgICAgICAgIHNlbGYuX2N1ck1vdmVYID0gY3VyTW92ZVg7CiAgICAgICAgICBzZWxmLl9jaGFuZ2VkWCA9IG1vdmVYOwogICAgICAgICAgc2VsZi4kbGluZWF0aW9uLnN0eWxlW3RyYW5zZm9ybVByb3BlcnR5XSA9ICd0cmFuc2xhdGVYKCcgKyBjdXJNb3ZlWCArICdweCknOwogICAgICAgICAgc2VsZi5yb3RhdGVBbmdsZSA9IHNlbGYuX2Jhc2VBbmdsZSArIGFuZ2xlOwogICAgICAgICAgc2VsZi50cmFuc2Zvcm0odHJ1ZSk7CiAgICAgICAgICBzZWxmLl9kb3duUG9pbnRzID0gdG91Y2hlczsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7IC8v6Zi75q2i5LqL5Lu25YaS5rOhCgogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICB9KTsKICAgIHNlbGYuJGNyb3BSb3RhdGUuYWRkRXZlbnRMaXN0ZW5lcihjb250cm9sRXZlbnRzLmVuZCwgc2VsZi5lbmRDb250cm9sLmJpbmQoc2VsZikpOyAvL+e7k+adnwoKICAgIHNlbGYuJGNyb3BSb3RhdGUuYWRkRXZlbnRMaXN0ZW5lcihjb250cm9sRXZlbnRzLmNhbmNlbCwgc2VsZi5lbmRDb250cm9sLmJpbmQoc2VsZikpOyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0gLy8KICAgIC8v6KOB5Ymq5Zu+54mH56e75Yqo44CB5Y+M5oyH57yp5pS+5pON5L2cCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0gLy8KCiAgICB2YXIgJGltYWdlTGlzdGVuZXJFbGUgPSBzZWxmLmlzU3VwcG9ydFRvdWNoID8gc2VsZi4kY29udGFpbmVyIDogc2VsZi4kY3JvcE1hc2s7CiAgICAkaW1hZ2VMaXN0ZW5lckVsZS5hZGRFdmVudExpc3RlbmVyKGNvbnRyb2xFdmVudHMuc3RhcnQsIGZ1bmN0aW9uIChldikgewogICAgICB2YXIgdG91Y2hlcyA9IHNlbGYuZ2V0Q29udHJvbFBvaW50cyhldik7CiAgICAgIHNlbGYuc3RhcnRDb250cm9sKHRvdWNoZXMpOwogICAgICBzZWxmLl9tdWx0aVBvaW50ID0gZmFsc2U7CgogICAgICBpZiAoc2VsZi5fZG93blBvaW50cyAmJiBzZWxmLl9kb3duUG9pbnRzLmxlbmd0aCA+PSAyKSB7CiAgICAgICAgc2VsZi5fbXVsdGlQb2ludCA9IHRydWU7CiAgICAgICAgdmFyIGNlbnRlciA9IHsKICAgICAgICAgIGNsaWVudFg6IChzZWxmLl9kb3duUG9pbnRzWzBdLmNsaWVudFggKyBzZWxmLl9kb3duUG9pbnRzWzFdLmNsaWVudFgpIC8gMiwKICAgICAgICAgIGNsaWVudFk6IChzZWxmLl9kb3duUG9pbnRzWzBdLmNsaWVudFkgKyBzZWxmLl9kb3duUG9pbnRzWzFdLmNsaWVudFkpIC8gMgogICAgICAgIH07CiAgICAgICAgc2VsZi5maW5nZXJMZW4gPSBNYXRoLnNxcnQoTWF0aC5wb3coc2VsZi5fZG93blBvaW50c1swXS5jbGllbnRYIC0gc2VsZi5fZG93blBvaW50c1sxXS5jbGllbnRYLCAyKSArIE1hdGgucG93KHNlbGYuX2Rvd25Qb2ludHNbMF0uY2xpZW50WSAtIHNlbGYuX2Rvd25Qb2ludHNbMV0uY2xpZW50WSwgMikpOwogICAgICAgIHNlbGYuZmluZ2VyU2NhbGUgPSAxOwogICAgICAgIHNlbGYuZmluZ2VyQ2VudGVyID0gewogICAgICAgICAgLy/lj4zmjIfmk43kvZzkuK3lv4MKICAgICAgICAgIHg6IGNlbnRlci5jbGllbnRYIC0gc2VsZi5tYXNrVmlld1NpemUud2lkdGggLyAyLAogICAgICAgICAgeTogc2VsZi5tYXNrVmlld1NpemUuaGVpZ2h0IC8gMiAtIGNlbnRlci5jbGllbnRZCiAgICAgICAgfTsKICAgICAgfQogICAgfSk7CiAgICB2YXIgb3B0aW9ucyA9IHNlbGYucGFzc2l2ZVN1cHBvcnRlZCA/IHsKICAgICAgLy8g5aaC5p6c5rWP6KeI5Zmo5pSv5oyBIHBhc3NpdmUgZXZlbnQgbGlzdGVuZXIg5Li65LqG5L+d6K+B5oiq5Zu+5pON5L2c5pe26aG16Z2i5LiN5rua5Yqo6ZyA6KaB6K6+572u5Li6IGZhbHNlCiAgICAgIHBhc3NpdmU6IGZhbHNlLAogICAgICBjYXB0dXJlOiBmYWxzZQogICAgfSA6IGZhbHNlOwogICAgJGltYWdlTGlzdGVuZXJFbGUuYWRkRXZlbnRMaXN0ZW5lcihjb250cm9sRXZlbnRzLm1vdmUsIGZ1bmN0aW9uIChldikgewogICAgICB2YXIgdG91Y2hlcyA9IHNlbGYuZ2V0Q29udHJvbFBvaW50cyhldik7CgogICAgICBpZiAoc2VsZi5fZG93blBvaW50cyAmJiBzZWxmLl9kb3duUG9pbnRzLmxlbmd0aCA+IDApIHsKICAgICAgICBpZiAoIXNlbGYuX211bHRpUG9pbnQpIHsKICAgICAgICAgIC8vIOWNleaMh+enu+WKqAogICAgICAgICAgc2VsZi5jb250ZW50TW92ZSh0b3VjaGVzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8g5Y+M5oyH57yp5pS+CiAgICAgICAgICB2YXIgbmV3RmluZ2VyTGVuID0gTWF0aC5zcXJ0KE1hdGgucG93KHRvdWNoZXNbMF0uY2xpZW50WCAtIHRvdWNoZXNbMV0uY2xpZW50WCwgMikgKyBNYXRoLnBvdyh0b3VjaGVzWzBdLmNsaWVudFkgLSB0b3VjaGVzWzFdLmNsaWVudFksIDIpKTsKICAgICAgICAgIHZhciBuZXdTY2FsZSA9IG5ld0ZpbmdlckxlbiAvIHNlbGYuZmluZ2VyTGVuOwogICAgICAgICAgc2VsZi5zY2FsZVRpbWVzID0gc2VsZi5zY2FsZVRpbWVzIC8gc2VsZi5maW5nZXJTY2FsZSAqIG5ld1NjYWxlOwogICAgICAgICAgdmFyIHRyYW5zbGF0ZSA9IHNlbGYuZ2V0RmluZ2VyU2NhbGVUcmFuc2xhdGUobmV3U2NhbGUgLyBzZWxmLmZpbmdlclNjYWxlKTsKICAgICAgICAgIHNlbGYuX2NvbnRlbnRDdXJNb3ZlWCAtPSB0cmFuc2xhdGUudHJhbnNsYXRlWDsKICAgICAgICAgIHNlbGYuX2NvbnRlbnRDdXJNb3ZlWSArPSB0cmFuc2xhdGUudHJhbnNsYXRlWTsKICAgICAgICAgIHNlbGYuZmluZ2VyU2NhbGUgPSBuZXdTY2FsZTsKICAgICAgICAgIHNlbGYudHJhbnNmb3JtKGZhbHNlLCB0cnVlKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChzZWxmLnZpc2libGUpIHsKICAgICAgICAvL+e7hOS7tuaYvuekuueKtuaAgeaJjeWxj+iUveaOieS4gOS6m+S6i+S7tueahOm7mOiupOihjOS4uu+8jOmYsuatoue7hOS7tuWFs+mXreWQjue7p+e7reW9seWTjemhtemdogogICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0KICAgIH0sIG9wdGlvbnMpOwogICAgJGltYWdlTGlzdGVuZXJFbGUuYWRkRXZlbnRMaXN0ZW5lcihjb250cm9sRXZlbnRzLmVuZCwgc2VsZi5lbmRDb250cm9sLmJpbmQoc2VsZikpOyAvL+e7k+adnwoKICAgICRpbWFnZUxpc3RlbmVyRWxlLmFkZEV2ZW50TGlzdGVuZXIoY29udHJvbEV2ZW50cy5jYW5jZWwsIHNlbGYuZW5kQ29udHJvbC5iaW5kKHNlbGYpKTsgLy8gLS0tLS0tLS0tLS0tLS0tLS0tIC8vCiAgfTsgLy/lj4zmjIfnvKnmlL7kvJjljJbkuLrku6Xlj4zmjIfkuK3lv4PkuLrln7rnoYDngrnvvIzlrp7pmYXlj5jmjaLku6XkuK3lv4PngrnkuLrln7rlh4bngrnvvIzlm6DmraTpnIDopoHorqHnrpfkuKTogIXnmoTlgY/np7sKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmdldEZpbmdlclNjYWxlVHJhbnNsYXRlID0gZnVuY3Rpb24gKHNjYWxlKSB7CiAgICB2YXIgZmluZ2VyUG9pbnRzID0gW107IC8v5Lul5Y+M5oyH5Lit5b+D57yp5pS+55qE5paw5Z2Q5qCHCgogICAgdmFyIGNlbnRlciA9IHRoaXMuZ2V0UG9pbnRzQ2VudGVyKHRoaXMuY29udGVudFBvaW50cyk7IC8v5Lit5b+D54K55LiN5Y+YCgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNvbnRlbnRQb2ludHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHBvaW50ID0gdGhpcy5jb250ZW50UG9pbnRzW2ldOwogICAgICBmaW5nZXJQb2ludHMucHVzaCh7CiAgICAgICAgeDogcG9pbnQueCAqIHNjYWxlIC0gdGhpcy5maW5nZXJDZW50ZXIueCAqIChzY2FsZSAtIDEpLAogICAgICAgIHk6IHBvaW50LnkgKiBzY2FsZSAtIHRoaXMuZmluZ2VyQ2VudGVyLnkgKiAoc2NhbGUgLSAxKQogICAgICB9KTsKICAgIH0KCiAgICB2YXIgbmV3Q2VudGVyID0gdGhpcy5nZXRQb2ludHNDZW50ZXIoZmluZ2VyUG9pbnRzKTsKICAgIHJldHVybiB7CiAgICAgIHRyYW5zbGF0ZVg6IGNlbnRlci54IC0gbmV3Q2VudGVyLngsCiAgICAgIHRyYW5zbGF0ZVk6IGNlbnRlci55IC0gbmV3Q2VudGVyLnkKICAgIH07CiAgfTsgLy/moLnmja7lm77niYfmlrnlkJHorqHnrpfmupDlm77niYflrp7pmYXlrr3pq5gKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmdldFJlYWxDb3RlbnRTaXplID0gZnVuY3Rpb24gKCkgewogICAgdGhpcy5jb250ZW50V2lkdGggPSB0aGlzLm9yaWdpbkltYWdlLndpZHRoOwogICAgdGhpcy5jb250ZW50SGVpZ2h0ID0gdGhpcy5vcmlnaW5JbWFnZS5oZWlnaHQ7IC8v5Zu+54mH5pa55ZCR5aSn5LqOIDQg5pe25a696auY5LqS5o2iCgogICAgaWYgKHRoaXMuX29yaWVudGF0aW9uID4gNCkgewogICAgICB0aGlzLmNvbnRlbnRXaWR0aCA9IHRoaXMub3JpZ2luSW1hZ2UuaGVpZ2h0OwogICAgICB0aGlzLmNvbnRlbnRIZWlnaHQgPSB0aGlzLm9yaWdpbkltYWdlLndpZHRoOwogICAgfQogIH07IC8v5aSE55CG5Zu+54mH5pa55ZCRCgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS50cmFuc2Zvcm1Db29yZGluYXRlcyA9IGZ1bmN0aW9uICgpIHsKICAgIGlmICh0aGlzLiRjcm9wQ29udGVudCkgewogICAgICB0aGlzLiRjcm9wTWFzay5yZW1vdmVDaGlsZCh0aGlzLiRjcm9wQ29udGVudCk7CiAgICB9CgogICAgdGhpcy4kY3JvcENvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTsKICAgIHRoaXMuJGNyb3BDb250ZW50LndpZHRoID0gdGhpcy5jb250ZW50V2lkdGg7CiAgICB0aGlzLiRjcm9wQ29udGVudC5oZWlnaHQgPSB0aGlzLmNvbnRlbnRIZWlnaHQ7CiAgICB2YXIgaW1hZ2VDdHggPSB0aGlzLiRjcm9wQ29udGVudC5nZXRDb250ZXh0KCcyZCcpOwogICAgdmFyIHdpZHRoID0gdGhpcy5vcmlnaW5JbWFnZS53aWR0aDsKICAgIHZhciBoZWlnaHQgPSB0aGlzLm9yaWdpbkltYWdlLmhlaWdodDsKCiAgICBzd2l0Y2ggKHRoaXMuX29yaWVudGF0aW9uKSB7CiAgICAgIGNhc2UgMjoKICAgICAgICAvLyBob3Jpem9udGFsIGZsaXAKICAgICAgICBpbWFnZUN0eC50cmFuc2xhdGUod2lkdGgsIDApOwogICAgICAgIGltYWdlQ3R4LnNjYWxlKC0xLCAxKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMzoKICAgICAgICAvLyAxODDCsCByb3RhdGUgbGVmdAogICAgICAgIGltYWdlQ3R4LnRyYW5zbGF0ZSh3aWR0aCwgaGVpZ2h0KTsKICAgICAgICBpbWFnZUN0eC5yb3RhdGUoTWF0aC5QSSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDQ6CiAgICAgICAgLy8gdmVydGljYWwgZmxpcAogICAgICAgIGltYWdlQ3R4LnRyYW5zbGF0ZSgwLCBoZWlnaHQpOwogICAgICAgIGltYWdlQ3R4LnNjYWxlKDEsIC0xKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNToKICAgICAgICAvLyB2ZXJ0aWNhbCBmbGlwICsgOTAgcm90YXRlIHJpZ2h0CiAgICAgICAgaW1hZ2VDdHgucm90YXRlKDAuNSAqIE1hdGguUEkpOwogICAgICAgIGltYWdlQ3R4LnNjYWxlKDEsIC0xKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNjoKICAgICAgICAvLyA5MMKwIHJvdGF0ZSByaWdodAogICAgICAgIGltYWdlQ3R4LnJvdGF0ZSgwLjUgKiBNYXRoLlBJKTsKICAgICAgICBpbWFnZUN0eC50cmFuc2xhdGUoMCwgLWhlaWdodCk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDc6CiAgICAgICAgLy8gaG9yaXpvbnRhbCBmbGlwICsgOTAgcm90YXRlIHJpZ2h0CiAgICAgICAgaW1hZ2VDdHgucm90YXRlKDAuNSAqIE1hdGguUEkpOwogICAgICAgIGltYWdlQ3R4LnRyYW5zbGF0ZSh3aWR0aCwgLWhlaWdodCk7CiAgICAgICAgaW1hZ2VDdHguc2NhbGUoLTEsIDEpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA4OgogICAgICAgIC8vIDkwwrAgcm90YXRlIGxlZnQKICAgICAgICBpbWFnZUN0eC5yb3RhdGUoLTAuNSAqIE1hdGguUEkpOwogICAgICAgIGltYWdlQ3R4LnRyYW5zbGF0ZSgtd2lkdGgsIDApOwogICAgICAgIGJyZWFrOwogICAgfQoKICAgIGltYWdlQ3R4LmRyYXdJbWFnZSh0aGlzLm9yaWdpbkltYWdlLCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTsgLy/liJ3lp4vkvY3nva7lnoLnm7TmsLTlubPlsYXkuK0KCiAgICB0aGlzLl9pbml0VHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKC01MCUsLTUwJSwwKSc7CiAgICB0aGlzLiRjcm9wQ29udGVudC5jbGFzc0xpc3QuYWRkKCdjcm9wLWNvbnRlbnQnKTsKICAgIHRoaXMuJGNyb3BDb250ZW50LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsKICAgIHRoaXMuJGNyb3BDb250ZW50LnN0eWxlLmxlZnQgPSAnNTAlJzsKICAgIHRoaXMuJGNyb3BDb250ZW50LnN0eWxlLnRvcCA9ICc1MCUnOwogICAgdGhpcy4kY3JvcENvbnRlbnQuc3R5bGVbdHJhbnNmb3JtUHJvcGVydHldID0gdGhpcy5faW5pdFRyYW5zZm9ybTsKICAgIHRoaXMuJGNyb3BNYXNrLmluc2VydEJlZm9yZSh0aGlzLiRjcm9wQ29udGVudCwgdGhpcy4kY3JvcENvdmVyKTsKICB9OyAvL+iOt+WPluijgeWJquWbvueJhwoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUuZ2V0Q3JvcEltYWdlID0gZnVuY3Rpb24gKCkgewogICAgdmFyIHNjYWxlTnVtID0gdGhpcy5zY2FsZVRpbWVzIC8gdGhpcy50aW1lcyAqIHRoaXMuX3JvdGF0ZVNjYWxlOwogICAgdmFyIGNvbnRlbnRXaWR0aCA9IHRoaXMuY29udGVudFdpZHRoOwogICAgdmFyIGNvbnRlbnRIZWlnaHQgPSB0aGlzLmNvbnRlbnRIZWlnaHQ7CiAgICB2YXIgY3JvcFdpZHRoID0gdGhpcy5zaXplLndpZHRoOwogICAgdmFyIGNyb3BIZWlnaHQgPSB0aGlzLnNpemUuaGVpZ2h0OyAvL+mcgOimgeiAg+iZkeijgeWJquWbvueJh+WunumZheWwuuWvuOavlOijgeWJquWwuuWvuOWwj+eahOaDheWGtQoKICAgIHZhciByYXRpbyA9IDE7CgogICAgaWYgKGNvbnRlbnRXaWR0aCA8IGNyb3BXaWR0aCB8fCBjb250ZW50SGVpZ2h0IDwgY3JvcEhlaWdodCkgewogICAgICAvLyDoo4HliarkuK3pl7TnlLvluIPlsLrlr7jlv4XpobvlpKfkuo7lrp7pmYXoo4HliarlsLrlr7gKICAgICAgaWYgKGNyb3BXaWR0aCAvIGNvbnRlbnRXaWR0aCA+IGNyb3BIZWlnaHQgLyBjb250ZW50SGVpZ2h0KSB7CiAgICAgICAgcmF0aW8gPSBjcm9wV2lkdGggLyBjb250ZW50V2lkdGg7CiAgICAgICAgY29udGVudEhlaWdodCA9IGNvbnRlbnRIZWlnaHQgKiByYXRpbzsKICAgICAgICBjb250ZW50V2lkdGggPSBjcm9wV2lkdGg7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmF0aW8gPSBjcm9wSGVpZ2h0IC8gY29udGVudEhlaWdodDsKICAgICAgICBjb250ZW50V2lkdGggPSBjb250ZW50V2lkdGggKiByYXRpbzsKICAgICAgICBjb250ZW50SGVpZ2h0ID0gY3JvcEhlaWdodDsKICAgICAgfQogICAgfQoKICAgIHZhciBjZW50ZXIgPSB7CiAgICAgIHg6IGNvbnRlbnRXaWR0aCAvIDIsCiAgICAgIHk6IGNvbnRlbnRIZWlnaHQgLyAyCiAgICB9OwogICAgdmFyICRjb250ZW50Q2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7CiAgICAkY29udGVudENhbnZhcy53aWR0aCA9IGNvbnRlbnRXaWR0aDsKICAgICRjb250ZW50Q2FudmFzLmhlaWdodCA9IGNvbnRlbnRIZWlnaHQ7CiAgICB2YXIgY29udGVudEN0eCA9ICRjb250ZW50Q2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgICBjb250ZW50Q3R4LnRyYW5zbGF0ZShjZW50ZXIueCwgY2VudGVyLnkpOwogICAgY29udGVudEN0eC5zY2FsZShzY2FsZU51bSAqIHRoaXMudGltZXMgLyByYXRpbywgc2NhbGVOdW0gKiB0aGlzLnRpbWVzIC8gcmF0aW8pOyAvLyDnvKnmlL4gdGhpcy50aW1lcwoKICAgIGNvbnRlbnRDdHgudHJhbnNsYXRlKCh0aGlzLl9jb250ZW50Q3VyTW92ZVggKyB0aGlzLnBvc2l0aW9uT2Zmc2V0LmxlZnQpIC8gc2NhbGVOdW0gKiByYXRpbywgKHRoaXMuX2NvbnRlbnRDdXJNb3ZlWSArIHRoaXMucG9zaXRpb25PZmZzZXQudG9wKSAvIHNjYWxlTnVtICogcmF0aW8pOwogICAgY29udGVudEN0eC5yb3RhdGUodGhpcy5yb3RhdGVBbmdsZSAvIDE4MCAqIE1hdGguUEkpOwogICAgY29udGVudEN0eC50cmFuc2xhdGUoLWNlbnRlci54LCAtY2VudGVyLnkpOwogICAgY29udGVudEN0eC5kcmF3SW1hZ2UodGhpcy4kY3JvcENvbnRlbnQsIDAsIDAsIGNvbnRlbnRXaWR0aCwgY29udGVudEhlaWdodCk7CiAgICB2YXIgJGNyb3BDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTsKICAgICRjcm9wQ2FudmFzLndpZHRoID0gY3JvcFdpZHRoOwogICAgJGNyb3BDYW52YXMuaGVpZ2h0ID0gY3JvcEhlaWdodDsKICAgIHZhciBjcm9wQ3R4ID0gJGNyb3BDYW52YXMuZ2V0Q29udGV4dCgnMmQnKTsKICAgIGNyb3BDdHguZHJhd0ltYWdlKCRjb250ZW50Q2FudmFzLCAoY29udGVudFdpZHRoIC0gY3JvcFdpZHRoKSAvIDIsIChjb250ZW50SGVpZ2h0IC0gY3JvcEhlaWdodCkgLyAyLCBjcm9wV2lkdGgsIGNyb3BIZWlnaHQsIDAsIDAsIGNyb3BXaWR0aCwgY3JvcEhlaWdodCk7CiAgICB0aGlzLiRyZXN1bHRDYW52YXMgPSAkY3JvcENhbnZhczsKICB9OyAvL+aTjeS9nOe7k+adnwoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUuZW5kQ29udHJvbCA9IGZ1bmN0aW9uICgpIHsKICAgIGlmICh0aGlzLl9pc0NvbnRyb2wpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB0aGlzLl9kb3duUG9pbnRzID0gW107CiAgICAgIHRoaXMuc2NhbGVEb3duWCA9IDA7CgogICAgICBpZiAodGhpcy4kY3JvcENvbnRlbnQgJiYgIXRoaXMuaXNXaG9sZUNvdmVyKHRoaXMuY29udGVudFBvaW50cywgdGhpcy5jcm9wUG9pbnRzKSkgewogICAgICAgIC8v5aaC5p6c5rKh5pyJ5a6M5YWo5YyF5ZCr5YiZ6ZyA6KaB6L+b6KGM6YCC6YWN5Y+Y5o2iCiAgICAgICAgdmFyIHNjYWxlTnVtID0gdGhpcy5zY2FsZVRpbWVzIC8gdGhpcy50aW1lcyAqIHRoaXMuX3JvdGF0ZVNjYWxlOwogICAgICAgIHZhciB0cmFuc2Zvcm0gPSAnJzsKICAgICAgICB0cmFuc2Zvcm0gKz0gJyBzY2FsZSgnICsgc2NhbGVOdW0gKyAnKSc7IC8v57yp5pS+CgogICAgICAgIHRyYW5zZm9ybSArPSAnIHRyYW5zbGF0ZVgoJyArIHRoaXMuX2NvbnRlbnRDdXJNb3ZlWCAvIHNjYWxlTnVtICsgJ3B4KSB0cmFuc2xhdGVZKCcgKyB0aGlzLl9jb250ZW50Q3VyTW92ZVkgLyBzY2FsZU51bSArICdweCknOyAvL+enu+WKqAoKICAgICAgICB0cmFuc2Zvcm0gKz0gJyByb3RhdGUoJyArIHRoaXMucm90YXRlQW5nbGUgKyAnZGVnKSAnOyAvL+mAgumFjeWPmOaNogoKICAgICAgICB2YXIgY292ZXJUciA9IHRoaXMuZ2V0Q292ZXJUcmFuc2Zvcm0odHJhbnNmb3JtKTsKICAgICAgICB2YXIgY292ZXJNYXQgPSB0aGlzLmdldFRyYW5zZm9ybU1hdHJpeChjb3ZlclRyKTsKICAgICAgICB0aGlzLl9jb250ZW50Q3VyTW92ZVggPSBjb3Zlck1hdC5lOwogICAgICAgIHRoaXMuX2NvbnRlbnRDdXJNb3ZlWSA9IGNvdmVyTWF0LmY7CiAgICAgICAgdGhpcy5jb250ZW50UG9pbnRzID0gdGhpcy5nZXRUcmFuc2Zvcm1Qb2ludHMoJ3NjYWxlWSgtMSknICsgY292ZXJUciwgdGhpcy5pbml0Q29udGVudFBvaW50cyk7CgogICAgICAgIGlmICghdGhpcy5kZWJ1ZykgewogICAgICAgICAgdGhpcy4kY3JvcENvbnRlbnQuc3R5bGVbdHJhbnNmb3JtUHJvcGVydHldID0gdGhpcy5faW5pdFRyYW5zZm9ybSArIGNvdmVyVHI7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJGNyb3BDb250ZW50LnN0eWxlW3RyYW5zaXRpb25Qcm9wZXJ0eV0gPSAndHJhbnNmb3JtIC41cyBsaW5lYXInOwogICAgICAgICAgdmFyIHN0YXJ0ID0gY292ZXJUci5pbmRleE9mKHRyYW5zZm9ybSkgKyB0cmFuc2Zvcm0ubGVuZ3RoOwogICAgICAgICAgdmFyIGNvdmVyVHJBciA9IGNvdmVyVHIuc3Vic3RyaW5nKHN0YXJ0LCBjb3ZlclRyLmxlbmd0aCkudHJpbSgpLnNwbGl0KCcgJyk7CiAgICAgICAgICB2YXIgbm8gPSAwOwogICAgICAgICAgdmFyIHRyID0gdGhpcy5faW5pdFRyYW5zZm9ybSArIHRyYW5zZm9ybSArIGNvdmVyVHJBcltub107CiAgICAgICAgICB0aGlzLiRjcm9wQ29udGVudC5zdHlsZVt0cmFuc2Zvcm1Qcm9wZXJ0eV0gPSB0cjsKICAgICAgICAgIHRoaXMuJGNyb3BDb250ZW50LmFkZEV2ZW50TGlzdGVuZXIodHJhbnNpdGlvbkVuZEV2ZW50LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIG5vKys7CgogICAgICAgICAgICBpZiAobm8gPCBjb3ZlclRyLmxlbmd0aCkgewogICAgICAgICAgICAgIHRyICs9IGNvdmVyVHJBcltub107CiAgICAgICAgICAgICAgc2VsZi4kY3JvcENvbnRlbnQuc3R5bGVbdHJhbnNmb3JtUHJvcGVydHldID0gdHI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5faXNDb250cm9sID0gZmFsc2U7CiAgICB9CiAgfTsgLy/mk43kvZzlvIDlp4sKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLnN0YXJ0Q29udHJvbCA9IGZ1bmN0aW9uICh0b3VjaGVzKSB7CiAgICB0b3VjaGVzID0gdG91Y2hlcyA/IHRvdWNoZXMgOiBbXTsKCiAgICBpZiAoIXRoaXMuX2lzQ29udHJvbCB8fCB0aGlzLmlzVHdvRmluZ2VyRXZlbnQodG91Y2hlcykpIHsKICAgICAgdGhpcy5faXNDb250cm9sID0gdHJ1ZTsKCiAgICAgIGlmICh0aGlzLiRjcm9wQ29udGVudCkgewogICAgICAgIHRoaXMuJGNyb3BDb250ZW50LnN0eWxlW3RyYW5zaXRpb25Qcm9wZXJ0eV0gPSAnbm9uZSc7CiAgICAgIH0KCiAgICAgIHRoaXMuX2Rvd25Qb2ludHMgPSB0b3VjaGVzOwogICAgfQogIH07IC8v5Y+M5oyH5pON5L2c5LqL5Lu2CgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS5pc1R3b0ZpbmdlckV2ZW50ID0gZnVuY3Rpb24gKHRvdWNoZXMpIHsKICAgIC8qKgogICAgICog5b6u5L+h5bCP56iL5bqP5Y+M5oyH5pON5L2c5pe277yM5Lya6Kem5Y+R5Lik5qyhIHRvdWNoc3RhcnQg5LqL5Lu25LiU5YmN5ZCO5Lik5qyh5LqL5Lu26Kem5pG454K55Z2Q5qCH5pyJ5LiA5Liq5Z2Q5qCH55u45ZCMCiAgICAgKi8KICAgIGlmICh0aGlzLl9pc0NvbnRyb2wgJiYgdGhpcy5fZG93blBvaW50cyAmJiB0aGlzLl9kb3duUG9pbnRzLmxlbmd0aCA9PSAxICYmIHRvdWNoZXMubGVuZ3RoID49IDIgJiYgKHRvdWNoZXNbMF0uY2xpZW50WCA9PSB0aGlzLl9kb3duUG9pbnRzWzBdLmNsaWVudFggJiYgdG91Y2hlc1swXS5jbGllbnRZID09IHRoaXMuX2Rvd25Qb2ludHNbMF0uY2xpZW50WSB8fCB0b3VjaGVzWzFdLmNsaWVudFggPT0gdGhpcy5fZG93blBvaW50c1swXS5jbGllbnRYICYmIHRvdWNoZXNbMV0uY2xpZW50WSA9PSB0aGlzLl9kb3duUG9pbnRzWzBdLmNsaWVudFkpKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9OyAvL+a7keWKqOaOp+WItuadoeaMiemSruenu+WKqAoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUuc2NhbGVNb3ZlID0gZnVuY3Rpb24gKGV2KSB7CiAgICBpZiAodGhpcy5zY2FsZURvd25YID4gMCkgewogICAgICB2YXIgcG9pbnRYID0gdGhpcy5nZXRDb250cm9sUG9pbnRzKGV2KVswXS5jbGllbnRYOwogICAgICB2YXIgbW92ZVggPSBwb2ludFggLSB0aGlzLnNjYWxlRG93blg7CiAgICAgIHZhciBuZXdDdXJMZWZ0ID0gdGhpcy5zY2FsZUN1ckxlZnQgKyBtb3ZlWDsKCiAgICAgIGlmIChuZXdDdXJMZWZ0ID49IHRoaXMuc2NhbGVJbml0TGVmdCAmJiBuZXdDdXJMZWZ0IDw9IHRoaXMuc2NhbGVXaWR0aCArIHRoaXMuc2NhbGVJbml0TGVmdCkgewogICAgICAgIHZhciBsYXN0TW92ZVggPSB0aGlzLl9zY2FsZU1vdmVYOwoKICAgICAgICBpZiAoIWxhc3RNb3ZlWCkgewogICAgICAgICAgbGFzdE1vdmVYID0gMDsKICAgICAgICB9CgogICAgICAgIHZhciBjdXJNb3ZlWCA9IGxhc3RNb3ZlWCArIG1vdmVYOwogICAgICAgIHRoaXMuc2NhbGVEb3duWCA9IHBvaW50WDsKICAgICAgICB0aGlzLnNjYWxlTW92ZUF0KGN1ck1vdmVYKTsKICAgICAgfQogICAgfQogIH07IC8v56e75Yqo5ruR5Yqo5o6n5Yi25p2h5oyJ6ZKu5Yiw5p+Q5Liq5L2N572uCgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS5zY2FsZU1vdmVBdCA9IGZ1bmN0aW9uIChjdXJNb3ZlWCkgewogICAgdGhpcy4kc2NhbGVCdG4uc3R5bGVbdHJhbnNmb3JtUHJvcGVydHldID0gJ3RyYW5zbGF0ZVgoJyArIGN1ck1vdmVYICsgJ3B4KSc7CiAgICB0aGlzLiRzY2FsZVZhbHVlLnN0eWxlLndpZHRoID0gY3VyTW92ZVggKyAncHgnOwogICAgdGhpcy5fc2NhbGVNb3ZlWCA9IGN1ck1vdmVYOwogICAgdGhpcy5zY2FsZUN1ckxlZnQgPSB0aGlzLnNjYWxlSW5pdExlZnQgKyBjdXJNb3ZlWDsKICAgIHRoaXMuc2NhbGVUaW1lcyA9IHRoaXMuaW5pdFNjYWxlICsgY3VyTW92ZVggKiAxLjAgLyB0aGlzLnNjYWxlV2lkdGggKiAodGhpcy5tYXhTY2FsZSAtIHRoaXMuaW5pdFNjYWxlKTsKICAgIHRoaXMudHJhbnNmb3JtKGZhbHNlLCB0cnVlKTsKICB9OyAvL+WGheWuueWbvueJh+enu+WKqAoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUuY29udGVudE1vdmUgPSBmdW5jdGlvbiAodG91Y2hlcykgewogICAgdmFyIHBvaW50ID0gdG91Y2hlc1swXTsKICAgIHZhciBtb3ZlWCA9IHBvaW50LmNsaWVudFggLSB0aGlzLl9kb3duUG9pbnRzWzBdLmNsaWVudFg7CiAgICB2YXIgbW92ZVkgPSBwb2ludC5jbGllbnRZIC0gdGhpcy5fZG93blBvaW50c1swXS5jbGllbnRZOwogICAgdGhpcy5fY29udGVudEN1ck1vdmVYICs9IG1vdmVYOwogICAgdGhpcy5fY29udGVudEN1ck1vdmVZICs9IG1vdmVZOwogICAgdGhpcy5fZG93blBvaW50cyA9IHRvdWNoZXM7CiAgICB0aGlzLnRyYW5zZm9ybSgpOwogIH07IC8v5peL6L2s44CB57yp5pS+44CB56e75YqoCgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS50cmFuc2Zvcm0gPSBmdW5jdGlvbiAocm90YXRlQ292ZXIsIHNjYWxlS2VlcENvdmVyKSB7CiAgICBpZiAodGhpcy4kY3JvcENvbnRlbnQpIHsKICAgICAgdmFyIHNjYWxlTnVtID0gdGhpcy5zY2FsZVRpbWVzIC8gdGhpcy50aW1lcyAqIHRoaXMuX3JvdGF0ZVNjYWxlOwogICAgICB2YXIgdHJhbnNmb3JtID0gJyc7CiAgICAgIHRyYW5zZm9ybSArPSAnIHNjYWxlKCcgKyBzY2FsZU51bSArICcpJzsgLy/nvKnmlL4KCiAgICAgIHRyYW5zZm9ybSArPSAnIHRyYW5zbGF0ZVgoJyArIHRoaXMuX2NvbnRlbnRDdXJNb3ZlWCAvIHNjYWxlTnVtICsgJ3B4KSB0cmFuc2xhdGVZKCcgKyB0aGlzLl9jb250ZW50Q3VyTW92ZVkgLyBzY2FsZU51bSArICdweCknOyAvL+enu+WKqAoKICAgICAgdHJhbnNmb3JtICs9ICcgcm90YXRlKCcgKyB0aGlzLnJvdGF0ZUFuZ2xlICsgJ2RlZyknOwoKICAgICAgaWYgKHNjYWxlS2VlcENvdmVyKSB7CiAgICAgICAgLy/nvKnmlL7ml7bkuLrkuobkv53or4Hoo4HliarmoYbkuI3lh7rnjrDnqbrnmb3vvIzpnIDopoHlnKjljp/mnInlj5jmjaLnmoTln7rnoYDkuIrlho3ov5vooYzkuIDlrprnmoTkvY3np7vlj5jmjaIKICAgICAgICB0cmFuc2Zvcm0gPSB0aGlzLmdldENvdmVyVHJhbnNmb3JtKHRyYW5zZm9ybSwgdHJ1ZSk7CiAgICAgICAgdmFyIHNjTWF0ID0gdGhpcy5nZXRUcmFuc2Zvcm1NYXRyaXgodHJhbnNmb3JtKTsKICAgICAgICB0aGlzLl9jb250ZW50Q3VyTW92ZVggPSBzY01hdC5lOwogICAgICAgIHRoaXMuX2NvbnRlbnRDdXJNb3ZlWSA9IHNjTWF0LmY7CiAgICAgIH0KCiAgICAgIGlmIChyb3RhdGVDb3ZlcikgewogICAgICAgIC8v5peL6L2s5pe26ZyA6KaB5L+d6K+B6KOB5Ymq5qGG5LiN5Ye6546w56m655m977yM6ZyA6KaB5Zyo5Y6f5pyJ5Y+Y5o2i55qE5Z+656GA5LiK5YaN6L+b6KGM5LiA5a6a55qE6YCC6YWN5Y+Y5o2iCiAgICAgICAgdmFyIHJvdGF0ZVBvaW50cyA9IHRoaXMuZ2V0VHJhbnNmb3JtUG9pbnRzKCdzY2FsZVkoLTEpJyArIHRyYW5zZm9ybSwgdGhpcy5pbml0Q29udGVudFBvaW50cyk7CiAgICAgICAgdmFyIGNvdmVyU2NhbGUgPSB0aGlzLmdldENvdmVyUmVjdFNjYWxlKHJvdGF0ZVBvaW50cywgdGhpcy5jcm9wUG9pbnRzKTsKICAgICAgICB2YXIgY2hhbmdlZFggPSB0aGlzLl9jaGFuZ2VkWDsKICAgICAgICB2YXIgY3VyTW92ZVggPSB0aGlzLl9jdXJNb3ZlWDsKICAgICAgICB2YXIgdG90YWxNb3ZlWCA9IGN1ck1vdmVYIC0gY2hhbmdlZFggLSB0aGlzLl9iYXNlTW92ZVg7CiAgICAgICAgdmFyIHJvdGF0ZUNlbnRlciA9IHRoaXMuZ2V0UG9pbnRzQ2VudGVyKHJvdGF0ZVBvaW50cyk7CiAgICAgICAgdmFyIGNlbnRlclZlYyA9IHsKICAgICAgICAgIHg6IHJvdGF0ZUNlbnRlci54IC0gdGhpcy5jcm9wQ2VudGVyLngsCiAgICAgICAgICB5OiByb3RhdGVDZW50ZXIueSAtIHRoaXMuY3JvcENlbnRlci55CiAgICAgICAgfTsKICAgICAgICB2YXIgcGVyY2VudCA9IE1hdGguYWJzKGNoYW5nZWRYKSAvIE1hdGguYWJzKHRvdGFsTW92ZVgpOwoKICAgICAgICBpZiAoY292ZXJTY2FsZSA+IDEpIHsKICAgICAgICAgIHRoaXMuX3JvdGF0ZVNjYWxlID0gdGhpcy5fcm90YXRlU2NhbGUgKiBjb3ZlclNjYWxlOwogICAgICAgICAgc2NhbGVOdW0gPSBzY2FsZU51bSAqIGNvdmVyU2NhbGU7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnZlY0xlbihjZW50ZXJWZWMpIDwgMSAmJiBwZXJjZW50ID4gMCkgewogICAgICAgICAgLy/kuK3lv4PngrnmjqXov5Hph43lkIjml7bvvIzml4vovazmlK/mjIHoh6rpgILlupTnvKnlsI8KICAgICAgICAgIGlmIChjb3ZlclNjYWxlIDwgMSAtIHBlcmNlbnQpIHsKICAgICAgICAgICAgLy/kuI3og73nqoHlj5gKICAgICAgICAgICAgY292ZXJTY2FsZSA9IDEgLSBwZXJjZW50OwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLl9yb3RhdGVTY2FsZSAqIGNvdmVyU2NhbGUgPiAxKSB7CiAgICAgICAgICAgIHRoaXMuX3JvdGF0ZVNjYWxlID0gdGhpcy5fcm90YXRlU2NhbGUgKiBjb3ZlclNjYWxlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy/kuI3og73lvbHlk40gc2NhbGVUaW1lcwogICAgICAgICAgICB0aGlzLl9yb3RhdGVTY2FsZSA9IDE7CiAgICAgICAgICAgIGNvdmVyU2NhbGUgPSAxOwogICAgICAgICAgfQoKICAgICAgICAgIHNjYWxlTnVtID0gc2NhbGVOdW0gKiBjb3ZlclNjYWxlOwogICAgICAgIH0KICAgICAgfSAvL+aTjeS9nOWPmOaNogoKCiAgICAgIHRyYW5zZm9ybSA9ICcnOwogICAgICB0cmFuc2Zvcm0gKz0gJyBzY2FsZSgnICsgc2NhbGVOdW0gKyAnKSc7IC8v57yp5pS+CgogICAgICB0cmFuc2Zvcm0gKz0gJyB0cmFuc2xhdGVYKCcgKyB0aGlzLl9jb250ZW50Q3VyTW92ZVggLyBzY2FsZU51bSArICdweCkgdHJhbnNsYXRlWSgnICsgdGhpcy5fY29udGVudEN1ck1vdmVZIC8gc2NhbGVOdW0gKyAncHgpJzsgLy/np7vliqgKCiAgICAgIHRyYW5zZm9ybSArPSAnIHJvdGF0ZSgnICsgdGhpcy5yb3RhdGVBbmdsZSArICdkZWcpJzsKICAgICAgdGhpcy4kY3JvcENvbnRlbnQuc3R5bGVbdHJhbnNmb3JtUHJvcGVydHldID0gdGhpcy5faW5pdFRyYW5zZm9ybSArIHRyYW5zZm9ybTsKICAgICAgdGhpcy5jb250ZW50UG9pbnRzID0gdGhpcy5nZXRUcmFuc2Zvcm1Qb2ludHMoJ3NjYWxlWSgtMSknICsgdHJhbnNmb3JtLCB0aGlzLmluaXRDb250ZW50UG9pbnRzKTsKICAgIH0KICB9OyAvL+iuoeeul+S4gOS4quefqeW9ouWImuWlveWMheWQq+WPpuS4gOS4quefqeW9oumcgOimgeeahOe8qeaUvuWAjeaVsAoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUuZ2V0Q292ZXJSZWN0U2NhbGUgPSBmdW5jdGlvbiAob3V0ZXIsIGlubmVyKSB7CiAgICB2YXIgc2NhbGUgPSAwOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5uZXIubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIG51bSA9IHRoaXMuZ2V0Q292ZXJQb2ludFNjYWxlKGlubmVyW2ldLCBvdXRlcik7CgogICAgICBpZiAobnVtID4gc2NhbGUpIHsKICAgICAgICBzY2FsZSA9IG51bTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBzY2FsZTsKICB9OyAvL+WIpOaWrSDnn6nlvaJBIOaYr+WQpuWujOWFqOWMheWQqyDnn6nlvaJCCgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS5pc1dob2xlQ292ZXIgPSBmdW5jdGlvbiAocmVjdEEsIHJlY3RCKSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlY3RCLmxlbmd0aDsgaSsrKSB7CiAgICAgIGlmICghdGhpcy5pc1BvaW50SW5SZWN0Q2hlY2tCeUxlbihyZWN0QltpXSwgcmVjdEEpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfTsgLy/orqHnrpfkuIDkuKrnn6nlvaLliJrlpb3ljIXlkKvnn6nlvaLlpJbkuIDngrnpnIDopoHnmoTnvKnmlL7lgI3mlbAKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmdldENvdmVyUG9pbnRTY2FsZSA9IGZ1bmN0aW9uIChwb2ludCwgcmVjdFBvaW50cykgewogICAgdmFyIHBjdiA9IHRoaXMuZ2V0UENWZWN0b3JQcm9qT25VcEFuZFJpZ2h0KHBvaW50LCByZWN0UG9pbnRzKTsgLy/orqHnrpfnn6nlvaLlpJbkuIDngrnliLDnn6nlvaLkuK3lv4PlkJHph4/lnKjnn6nlvaLovrnmoYblkJHph4/kuIrnmoTmipXlvbHot53nprsKCiAgICB2YXIgdUxlbiA9IHRoaXMudmVjTGVuKHBjdi51cHJvaik7CiAgICB2YXIgaGVpZ2h0ID0gdGhpcy52ZWNMZW4ocGN2LnVwKSAvIDI7CiAgICB2YXIgckxlbiA9IHRoaXMudmVjTGVuKHBjdi5ycHJvaik7CiAgICB2YXIgd2lkdGggPSB0aGlzLnZlY0xlbihwY3YucmlnaHQpIC8gMjsgLy/moLnmja7mipXlvbHot53nprvorqHnrpfnvKnmlL7lgI3mlbAKCiAgICBpZiAodUxlbiAvIGhlaWdodCA+IHJMZW4gLyB3aWR0aCkgewogICAgICByZXR1cm4gMSArICh1TGVuIC0gaGVpZ2h0KSAvIGhlaWdodDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiAxICsgKHJMZW4gLSB3aWR0aCkgLyB3aWR0aDsKICAgIH0KICB9OyAvL+iuoeeul+WbvueJh+WGheWuueWImuWlveWMheWQq+ijgeWJquahhueahHRyYW5zZm9ybeWPmOaNogoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUuZ2V0Q292ZXJUcmFuc2Zvcm0gPSBmdW5jdGlvbiAodHJhbnNmb3JtLCBvbmx5VHJhbnNsYXRlKSB7CiAgICB2YXIgY1JlY3QgPSB0aGlzLmdldENvdmVSZWN0KHRoaXMuY3JvcFBvaW50cywgdGhpcy5yb3RhdGVBbmdsZSk7CiAgICBvbmx5VHJhbnNsYXRlID0gb25seVRyYW5zbGF0ZSA/IG9ubHlUcmFuc2xhdGUgOiBmYWxzZTsgLy/orqHnrpfmlL7lpKflgI3mlbAKCiAgICB2YXIgdVNjYWxlID0gMTsgLy/msLTlubPnvKnmlL7lgI3mlbDlkozlnoLnm7TnvKnmlL7lgI3mlbAKCiAgICB2YXIgclNjYWxlID0gMTsKICAgIHZhciBjdXAgPSB7CiAgICAgIHg6IHRoaXMuY29udGVudFBvaW50c1sxXS54IC0gdGhpcy5jb250ZW50UG9pbnRzWzJdLngsCiAgICAgIHk6IHRoaXMuY29udGVudFBvaW50c1sxXS55IC0gdGhpcy5jb250ZW50UG9pbnRzWzJdLnkKICAgIH07CiAgICB2YXIgY3JpZ2h0ID0gewogICAgICB4OiB0aGlzLmNvbnRlbnRQb2ludHNbMV0ueCAtIHRoaXMuY29udGVudFBvaW50c1swXS54LAogICAgICB5OiB0aGlzLmNvbnRlbnRQb2ludHNbMV0ueSAtIHRoaXMuY29udGVudFBvaW50c1swXS55CiAgICB9OwogICAgdmFyIHR1cCA9IHsKICAgICAgeDogY1JlY3RbMV0ueCAtIGNSZWN0WzJdLngsCiAgICAgIHk6IGNSZWN0WzFdLnkgLSBjUmVjdFsyXS55CiAgICB9OwogICAgdmFyIHRyaWdodCA9IHsKICAgICAgeDogY1JlY3RbMV0ueCAtIGNSZWN0WzBdLngsCiAgICAgIHk6IGNSZWN0WzFdLnkgLSBjUmVjdFswXS55CiAgICB9OwogICAgdmFyIHVBbmcgPSB0aGlzLnZlY0FuZ2xlKGN1cCwgdHVwKTsKCiAgICBpZiAoTWF0aC5hYnMoMTgwIC0gdUFuZykgPCBNYXRoLmFicyg5MCAtIHVBbmcpIHx8IE1hdGguYWJzKDAgLSB1QW5nKSA8IE1hdGguYWJzKDkwIC0gdUFuZykpIHsKICAgICAgLy/mm7TmjqXov5ExODDmiJbogIUwCiAgICAgIHVTY2FsZSA9IHRoaXMudmVjTGVuKHR1cCkgLyB0aGlzLnZlY0xlbihjdXApOwogICAgICByU2NhbGUgPSB0aGlzLnZlY0xlbih0cmlnaHQpIC8gdGhpcy52ZWNMZW4oY3JpZ2h0KTsKICAgIH0gZWxzZSB7CiAgICAgIHVTY2FsZSA9IHRoaXMudmVjTGVuKHR1cCkgLyB0aGlzLnZlY0xlbihjcmlnaHQpOwogICAgICByU2NhbGUgPSB0aGlzLnZlY0xlbih0cmlnaHQpIC8gdGhpcy52ZWNMZW4oY3VwKTsKICAgIH0KCiAgICB1U2NhbGUgPSB1U2NhbGUgPCAxID8gMSA6IHVTY2FsZTsKICAgIHJTY2FsZSA9IHJTY2FsZSA8IDEgPyAxIDogclNjYWxlOwogICAgdmFyIHNjYWxlID0gdVNjYWxlID4gclNjYWxlID8gdVNjYWxlIDogclNjYWxlOwoKICAgIGlmIChvbmx5VHJhbnNsYXRlICYmIHNjYWxlID4gMSkgewogICAgICByZXR1cm4gdHJhbnNmb3JtOwogICAgfSAvL+WkjeWItuWdkOaghwoKCiAgICB2YXIgc2NhbGVQb2ludHMgPSBbXTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY29udGVudFBvaW50cy5sZW5ndGg7IGkrKykgewogICAgICBzY2FsZVBvaW50cy5wdXNoKHsKICAgICAgICB4OiB0aGlzLmNvbnRlbnRQb2ludHNbaV0ueCwKICAgICAgICB5OiB0aGlzLmNvbnRlbnRQb2ludHNbaV0ueQogICAgICB9KTsKICAgIH0gLy/orqHnrpfmlL7lpKflkI7nmoTmlrDlnZDmoIcKCgogICAgaWYgKHNjYWxlID4gMSkgewogICAgICB0cmFuc2Zvcm0gKz0gJyBzY2FsZSgnICsgc2NhbGUgKyAnKSc7CiAgICAgIHRoaXMuc2NhbGVUaW1lcyA9IHRoaXMuc2NhbGVUaW1lcyAqIHNjYWxlOyAvL3RoaXMuX3JvdGF0ZVNjYWxlID0gdGhpcy5fcm90YXRlU2NhbGUgKiBzY2FsZTsgLy8gdGhpcy5fcm90YXRlU2NhbGUg5Y+q6IO95Y+X5peL6L2s6KeS5bqm5b2x5ZONCgogICAgICBzY2FsZVBvaW50cyA9IHRoaXMuZ2V0VHJhbnNmb3JtUG9pbnRzKCdzY2FsZVkoLTEpJyArIHRyYW5zZm9ybSwgdGhpcy5pbml0Q29udGVudFBvaW50cyk7CiAgICB9IC8v5L2N56e75Y+Y5o2iCgoKICAgIHZhciBzY2FsZU51bSA9IHRoaXMuc2NhbGVUaW1lcyAvIHRoaXMudGltZXMgKiB0aGlzLl9yb3RhdGVTY2FsZTsKICAgIHZhciBjb3VudCA9IDA7CiAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICB2YXIgb3V0RGV0YWlscyA9IFtdOwoKICAgIGRvIHsKICAgICAgLy/mib7lh7roo4HliarmoYbotoXlh7rnmoTpobbngrkKICAgICAgb3V0RGV0YWlscyA9IHRoaXMuZ2V0T3V0RGV0YWlscyh0aGlzLmNyb3BQb2ludHMsIHNjYWxlUG9pbnRzKTsKCiAgICAgIGlmIChvdXREZXRhaWxzLmxlbmd0aCA+IDApIHsKICAgICAgICBjb3VudCsrOwogICAgICAgIG91dERldGFpbHMuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgLy/mib7lh7rot53nprvmnIDov5znmoTngrkKICAgICAgICAgIHZhciBhTGVuID0gc2VsZi52ZWNMZW4oYS5pdik7CiAgICAgICAgICB2YXIgYkxlbiA9IHNlbGYudmVjTGVuKGIuaXYpOwoKICAgICAgICAgIGlmIChhTGVuIDwgYkxlbikgewogICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoYUxlbiA+IGJMZW4pIHsKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0pOyAvL+W8gOWni+enu+WKqAoKICAgICAgICB2YXIgbWF4RmFyT3V0ID0gb3V0RGV0YWlsc1swXTsKICAgICAgICB2YXIgbWF4RmFyUGN2ID0gbWF4RmFyT3V0LnBjdjsgLy/orqHnrpdY6L205L2N56e7CgogICAgICAgIHVBbmcgPSB0aGlzLnZlY0FuZ2xlKG1heEZhclBjdi51cCwgbWF4RmFyUGN2LnVwcm9qKTsKICAgICAgICB2YXIgdUxlbiA9IHRoaXMudmVjTGVuKG1heEZhclBjdi51cHJvaik7CiAgICAgICAgdmFyIG1vdmVZID0gMDsgLy9pZih1QW5nID09IDApeyAvL+WQjOaWueWQkQoKICAgICAgICBpZiAoTWF0aC5hYnModUFuZykgPCA5MCkgewogICAgICAgICAgLy/mta7ngrnmlbDnsr7luqbpl67popjvvIzmjqXov5Ew5pe25bCP5LqOOTAg77yM5o6l6L+RMTgw5pe25aSn5LqOOTAKICAgICAgICAgIG1vdmVZID0gLXVMZW4gKiBtYXhGYXJPdXQudU92ZXI7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG1vdmVZID0gdUxlbiAqIG1heEZhck91dC51T3ZlcjsKICAgICAgICB9CgogICAgICAgIGlmIChtb3ZlWSAhPSAwKSB7CiAgICAgICAgICB0cmFuc2Zvcm0gKz0gJyB0cmFuc2xhdGVZKCcgKyBtb3ZlWSAvIHNjYWxlTnVtICsgJ3B4KSc7CiAgICAgICAgfSAvL+iuoeeul1novbTkvY3np7sKCgogICAgICAgIHZhciByQW5nID0gdGhpcy52ZWNBbmdsZShtYXhGYXJQY3YucmlnaHQsIG1heEZhclBjdi5ycHJvaik7CiAgICAgICAgdmFyIHJMZW4gPSB0aGlzLnZlY0xlbihtYXhGYXJQY3YucnByb2opOwogICAgICAgIHZhciBtb3ZlWCA9IDA7CgogICAgICAgIGlmIChNYXRoLmFicyhyQW5nKSA8IDkwKSB7CiAgICAgICAgICAvL+WQjOaWueWQkQogICAgICAgICAgbW92ZVggPSByTGVuICogbWF4RmFyT3V0LnJPdmVyOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBtb3ZlWCA9IC1yTGVuICogbWF4RmFyT3V0LnJPdmVyOwogICAgICAgIH0KCiAgICAgICAgaWYgKG1vdmVYICE9IDApIHsKICAgICAgICAgIHRyYW5zZm9ybSArPSAnIHRyYW5zbGF0ZVgoJyArIG1vdmVYIC8gc2NhbGVOdW0gKyAncHgpJzsKICAgICAgICB9IC8v6K6h566X5L2N56e75ZCO55qE5paw5Z2Q5qCHCgoKICAgICAgICBpZiAobW92ZVggIT0gMCB8fCBtb3ZlWSAhPSAwKSB7CiAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2NhbGVQb2ludHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgc2NhbGVQb2ludHNbaV0ueCA9IHNjYWxlUG9pbnRzW2ldLnggKyBtYXhGYXJPdXQuaXYueCwgc2NhbGVQb2ludHNbaV0ueSA9IHNjYWxlUG9pbnRzW2ldLnkgKyBtYXhGYXJPdXQuaXYueTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0gd2hpbGUgKGNvdW50IDwgMiAmJiBvdXREZXRhaWxzLmxlbmd0aCA+IDApOwoKICAgIHJldHVybiB0cmFuc2Zvcm07CiAgfTsgLy/mib7lh7rkuIDkuKrnn6nlvaLlnKjlj6bkuIDkuKrnn6nlvaLlpJbnmoTpobbngrnmlbDmja4KCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmdldE91dERldGFpbHMgPSBmdW5jdGlvbiAoaW5uZXIsIG91dGVyKSB7CiAgICB2YXIgb3V0RGV0YWlscyA9IFtdOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5uZXIubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHB0ID0gaW5uZXJbaV07CgogICAgICBpZiAoIXRoaXMuaXNQb2ludEluUmVjdENoZWNrQnlMZW4ocHQsIG91dGVyKSkgewogICAgICAgIHZhciBwY3YgPSB0aGlzLmdldFBDVmVjdG9yUHJvak9uVXBBbmRSaWdodChwdCwgb3V0ZXIpOwogICAgICAgIHZhciBpdiA9IHsKICAgICAgICAgIHg6IDAsCiAgICAgICAgICB5OiAwCiAgICAgICAgfTsKICAgICAgICB2YXIgdUxlbiA9IHRoaXMudmVjTGVuKHBjdi51cHJvaik7CiAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMudmVjTGVuKHBjdi51cCkgLyAyOwogICAgICAgIHZhciByTGVuID0gdGhpcy52ZWNMZW4ocGN2LnJwcm9qKTsKICAgICAgICB2YXIgd2lkdGggPSB0aGlzLnZlY0xlbihwY3YucmlnaHQpIC8gMjsKICAgICAgICB2YXIgdU92ZXIgPSAwOwogICAgICAgIHZhciByT3ZlciA9IDA7CgogICAgICAgIGlmICh1TGVuID4gaGVpZ2h0KSB7CiAgICAgICAgICB1T3ZlciA9ICh1TGVuIC0gaGVpZ2h0KSAvIHVMZW47CiAgICAgICAgICBpdi54ICs9IHBjdi51cHJvai54ICogdU92ZXI7CiAgICAgICAgICBpdi55ICs9IHBjdi51cHJvai55ICogdU92ZXI7CiAgICAgICAgfQoKICAgICAgICBpZiAockxlbiA+IHdpZHRoKSB7CiAgICAgICAgICByT3ZlciA9IChyTGVuIC0gd2lkdGgpIC8gckxlbjsKICAgICAgICAgIGl2LnggKz0gcGN2LnJwcm9qLnggKiByT3ZlcjsKICAgICAgICAgIGl2LnkgKz0gcGN2LnJwcm9qLnkgKiByT3ZlcjsKICAgICAgICB9CgogICAgICAgIG91dERldGFpbHMucHVzaCh7CiAgICAgICAgICB4OiBwdC54LAogICAgICAgICAgeTogcHQueSwKICAgICAgICAgIGl2OiBpdiwKICAgICAgICAgIHVPdmVyOiB1T3ZlciwKICAgICAgICAgIHJPdmVyOiByT3ZlciwKICAgICAgICAgIHBjdjogcGN2CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gb3V0RGV0YWlsczsKICB9OyAvL+iOt+WPluWImuWlveWMheWQq+afkOS4quefqeW9oueahOaWsOefqeW9ogoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUuZ2V0Q292ZVJlY3QgPSBmdW5jdGlvbiAocmVjdCwgYW5nbGUpIHsKICAgIGlmIChhbmdsZSA8IDApIHsKICAgICAgYW5nbGUgPSA5MCArIGFuZ2xlICUgOTA7CiAgICB9IGVsc2UgewogICAgICBhbmdsZSA9IGFuZ2xlICUgOTA7CiAgICB9CgogICAgdmFyIHJhZCA9IGFuZ2xlIC8gMTgwICogTWF0aC5QSTsKICAgIHZhciB1cCA9IHsKICAgICAgeDogcmVjdFsxXS54IC0gcmVjdFsyXS54LAogICAgICB5OiByZWN0WzFdLnkgLSByZWN0WzJdLnkKICAgIH07CiAgICB2YXIgcmlnaHQgPSB7CiAgICAgIHg6IHJlY3RbMV0ueCAtIHJlY3RbMF0ueCwKICAgICAgeTogcmVjdFsxXS55IC0gcmVjdFswXS55CiAgICB9OwogICAgdmFyIHJMZW4gPSB0aGlzLnZlY0xlbihyaWdodCk7CiAgICB2YXIgdUxlbiA9IHRoaXMudmVjTGVuKHVwKTsKICAgIHZhciBuUmVjdCA9IFtdOwogICAgblJlY3RbMF0gPSB7fTsKICAgIG5SZWN0WzBdLnggPSByZWN0WzBdLnggKyByTGVuICogTWF0aC5zaW4ocmFkKSAqIE1hdGguc2luKHJhZCk7CiAgICBuUmVjdFswXS55ID0gcmVjdFswXS55ICsgckxlbiAqIE1hdGguc2luKHJhZCkgKiBNYXRoLmNvcyhyYWQpOwogICAgblJlY3RbMV0gPSB7fTsKICAgIG5SZWN0WzFdLnggPSByZWN0WzFdLnggKyB1TGVuICogTWF0aC5zaW4ocmFkKSAqIE1hdGguY29zKHJhZCk7CiAgICBuUmVjdFsxXS55ID0gcmVjdFsxXS55IC0gdUxlbiAqIE1hdGguc2luKHJhZCkgKiBNYXRoLnNpbihyYWQpOwogICAgblJlY3RbMl0gPSB7fTsKICAgIG5SZWN0WzJdLnggPSByZWN0WzJdLnggLSByTGVuICogTWF0aC5zaW4ocmFkKSAqIE1hdGguc2luKHJhZCk7CiAgICBuUmVjdFsyXS55ID0gcmVjdFsyXS55IC0gckxlbiAqIE1hdGguc2luKHJhZCkgKiBNYXRoLmNvcyhyYWQpOwogICAgblJlY3RbM10gPSB7fTsKICAgIG5SZWN0WzNdLnggPSByZWN0WzNdLnggLSB1TGVuICogTWF0aC5zaW4ocmFkKSAqIE1hdGguY29zKHJhZCk7CiAgICBuUmVjdFszXS55ID0gcmVjdFszXS55ICsgdUxlbiAqIE1hdGguc2luKHJhZCkgKiBNYXRoLnNpbihyYWQpOwogICAgcmV0dXJuIG5SZWN0OwogIH07IC8v6K6h566X5paw55qE5Y+Y5o2i5Z2Q5qCHCgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS5nZXRUcmFuc2Zvcm1Qb2ludHMgPSBmdW5jdGlvbiAodHJhbnNmb3JtLCBwb2ludHMpIHsKICAgIHZhciBtYXRyaXggPSB0aGlzLmdldFRyYW5zZm9ybU1hdHJpeCh0cmFuc2Zvcm0pOwogICAgdmFyIG5Qb2ludHMgPSBbXTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvaW50cy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgaXRlbSA9IHsKICAgICAgICB4OiBwb2ludHNbaV0ueCwKICAgICAgICB5OiBwb2ludHNbaV0ueQogICAgICB9OwogICAgICBpdGVtID0gVHJhbnNmb3JtYXRpb25NYXRyaXguYXBwbHlUb1BvaW50KG1hdHJpeCwgaXRlbSk7CiAgICAgIG5Qb2ludHMucHVzaChpdGVtKTsKICAgIH0KCiAgICBuUG9pbnRzLnJldmVyc2UoKTsgLy/pobbngrnpobrluo/lj5HnlJ/kuoblj5jljJbvvIzpnIDopoHpoqDlgJIKCiAgICByZXR1cm4gblBvaW50czsKICB9OyAvL+iOt+W+l+efqeW9oueCueWdkOagh+S4reW/gwoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUuZ2V0UG9pbnRzQ2VudGVyID0gZnVuY3Rpb24gKHBvaW50cykgewogICAgdmFyIGNlbnRlciA9IHsKICAgICAgeDogKHBvaW50c1swXS54ICsgcG9pbnRzWzJdLngpIC8gMiwKICAgICAgeTogKHBvaW50c1swXS55ICsgcG9pbnRzWzJdLnkpIC8gMgogICAgfTsKICAgIHJldHVybiBjZW50ZXI7CiAgfTsgLy/nn6nlvaLkvY3nva7lvaLlvI/ovazmjaLkuLrpobbngrnlnZDmoIflvaLlvI8KCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLnJlY3RUb1BvaW50cyA9IGZ1bmN0aW9uIChyZWN0KSB7CiAgICB2YXIgcG9pbnRzID0gW107CiAgICBwb2ludHMucHVzaCh7CiAgICAgIHg6IC0odGhpcy5tYXNrVmlld1NpemUud2lkdGggLyAyIC0gcmVjdC5sZWZ0KSwKICAgICAgeTogdGhpcy5tYXNrVmlld1NpemUuaGVpZ2h0IC8gMiAtIHJlY3QudG9wCiAgICB9KTsKICAgIHBvaW50cy5wdXNoKHsKICAgICAgeDogcG9pbnRzWzBdLnggKyByZWN0LndpZHRoLAogICAgICB5OiBwb2ludHNbMF0ueQogICAgfSk7CiAgICBwb2ludHMucHVzaCh7CiAgICAgIHg6IHBvaW50c1sxXS54LAogICAgICB5OiBwb2ludHNbMV0ueSAtIHJlY3QuaGVpZ2h0CiAgICB9KTsKICAgIHBvaW50cy5wdXNoKHsKICAgICAgeDogcG9pbnRzWzBdLngsCiAgICAgIHk6IHBvaW50c1syXS55CiAgICB9KTsKICAgIHJldHVybiBwb2ludHM7CiAgfTsgLy/ojrflj5YgY3NzIHRyYW5zZm9ybSDlsZ7mgKflr7nlupTnmoTnn6nlvaLlvaLlvI8KCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmdldFRyYW5zZm9ybU1hdHJpeCA9IGZ1bmN0aW9uICh0cmFuc2Zvcm0pIHsKICAgIHZhciB0cmFuc2Zvcm1zID0gdHJhbnNmb3JtLnNwbGl0KCcgJyk7CiAgICB2YXIgcGFyYW1zID0gW107CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0cmFuc2Zvcm1zLmxlbmd0aDsgaSsrKSB7CiAgICAgIGlmICh0cmFuc2Zvcm1zW2ldLnRyaW0oKSAhPSAnJykgewogICAgICAgIC8vIOS4jeiDveS4uuepugogICAgICAgIHZhciBmdW5jID0gdGhpcy5nZXRUcmFuc2Zvcm1GdW5jdGlvbk5hbWUodHJhbnNmb3Jtc1tpXSk7CiAgICAgICAgdmFyIHJlc3VsdDsKCiAgICAgICAgaWYgKGZ1bmMubmFtZSAhPSAncm90YXRlJykgewogICAgICAgICAgcmVzdWx0ID0gVHJhbnNmb3JtYXRpb25NYXRyaXhbZnVuYy5uYW1lXShmdW5jLnBhcmFtc1swXSwgZnVuYy5wYXJhbXNbMV0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQgPSBUcmFuc2Zvcm1hdGlvbk1hdHJpeFtmdW5jLm5hbWVdKGZ1bmMucGFyYW1zWzBdKTsKICAgICAgICB9CgogICAgICAgIHBhcmFtcy5wdXNoKHJlc3VsdCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gVHJhbnNmb3JtYXRpb25NYXRyaXguY29tcG9zZShwYXJhbXMpOwogIH07IC8v5qC55o2uIGNzcyB0cmFuc2Zvcm0g5bGe5oCn6I635Y+WIHRyYW5zZm9ybWF0aW9uLW1hdHJpeCDlr7nlupTnmoTlh73mlbDlkI3np7Dku6Xlj4rlj4LmlbAKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmdldFRyYW5zZm9ybUZ1bmN0aW9uTmFtZSA9IGZ1bmN0aW9uICh0cmFuc2Zvcm0pIHsKICAgIHZhciBzdGFydCA9IHRyYW5zZm9ybS5pbmRleE9mKCcoJyk7CiAgICB2YXIgZW5kID0gdHJhbnNmb3JtLmluZGV4T2YoJyknKTsKICAgIHZhciBmdW5jID0ge307IC8v5Y+C5pWwCgogICAgdmFyIHBhcmFtcyA9IHRyYW5zZm9ybS5zdWJzdHJpbmcoc3RhcnQgKyAxLCBlbmQpLnNwbGl0KCcsJyk7CiAgICB2YXIgYXJyID0gW107CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJhbXMubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyLnB1c2gocGFyc2VGbG9hdChwYXJhbXNbaV0pKTsKICAgIH0KCiAgICBmdW5jLnBhcmFtcyA9IGFycjsgLy/lkI3np7AKCiAgICB2YXIgbmFtZSA9IHRyYW5zZm9ybS5zdWJzdHJpbmcoMCwgc3RhcnQpLnRvTG93ZXJDYXNlKCk7CiAgICB2YXIgZGVmUGFyYW1zID0gMDsgLy/pu5jorqTlj4LmlbAKCiAgICBpZiAobmFtZS5pbmRleE9mKCdzY2FsZScpICE9IC0xKSB7CiAgICAgIGZ1bmMubmFtZSA9ICdzY2FsZSc7CiAgICAgIGRlZlBhcmFtcyA9IDE7CiAgICB9IGVsc2UgaWYgKG5hbWUuaW5kZXhPZigndHJhbnNsYXRlJykgIT0gLTEpIHsKICAgICAgZnVuYy5uYW1lID0gJ3RyYW5zbGF0ZSc7CiAgICB9IGVsc2UgaWYgKG5hbWUuaW5kZXhPZignc2tldycpICE9IC0xKSB7CiAgICAgIGZ1bmMubmFtZSA9ICdza2V3REVHJzsKICAgIH0gZWxzZSBpZiAobmFtZS5pbmRleE9mKCdyb3RhdGUnKSAhPSAtMSkgewogICAgICBmdW5jLm5hbWUgPSAncm90YXRlREVHJzsgLy8g6KeS5bqmCiAgICB9IC8v5Yqg5YWl6buY6K6k5Y+C5pWwCgoKICAgIGlmIChuYW1lLmluZGV4T2YoJ3gnKSAhPSAtMSkgewogICAgICBmdW5jLnBhcmFtcy5wdXNoKGRlZlBhcmFtcyk7CiAgICB9IGVsc2UgaWYgKG5hbWUuaW5kZXhPZigneScpICE9IC0xKSB7CiAgICAgIGZ1bmMucGFyYW1zLnVuc2hpZnQoZGVmUGFyYW1zKTsKICAgIH0gZWxzZSBpZiAobmFtZS5pbmRleE9mKCdyb3RhdGUnKSA9PSAtMSAmJiBmdW5jLnBhcmFtcy5sZW5ndGggPD0gMSkgewogICAgICAvLyDpmaTkuoYgcm90YXRlIOWFtuWug+WHveaVsOaUr+aMgSB444CBeSDkuKTkuKrlj4LmlbDvvIzlpoLmnpwgY3NzIHRyYW5zZm9ybSDlsZ7mgKflj4LmlbDlj6rmnInkuIDkuKrliJnlj6bkuIDkuKrlj4LmlbDkuZ/mmK/lpoLmraTjgIIKICAgICAgZnVuYy5wYXJhbXMucHVzaChmdW5jLnBhcmFtc1swXSk7CiAgICB9CgogICAgcmV0dXJuIGZ1bmM7CiAgfTsgLy/orqHnrpflkJHph48gYSDlnKjlkJHph48gYiDkuIrnmoTmipXlvbHlkJHph48KCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmdldFByb2plY3Rpb25WZWN0b3IgPSBmdW5jdGlvbiAodmVjQSwgdmVjQikgewogICAgdmFyIGJMZW4gPSB0aGlzLnZlY0xlbih2ZWNCKTsKICAgIHZhciBhYiA9IHZlY0EueCAqIHZlY0IueCArIHZlY0EueSAqIHZlY0IueTsKICAgIHZhciBwcm9qID0gewogICAgICB4OiBhYiAvIE1hdGgucG93KGJMZW4sIDIpICogdmVjQi54LAogICAgICB5OiBhYiAvIE1hdGgucG93KGJMZW4sIDIpICogdmVjQi55CiAgICB9OwogICAgcmV0dXJuIHByb2o7CiAgfTsgLy/orqHnrpfnn6nlvaLkuK3lv4PliLDmn5DngrnnmoTlkJHph4/lnKjnn6nlvaLoh6rouqvlnZDmoIfns7vkuIrmlrnlkJHlkozlj7PmlrnlkJHkuIrnmoTmipXlvbHlkJHph48KCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmdldFBDVmVjdG9yUHJvak9uVXBBbmRSaWdodCA9IGZ1bmN0aW9uIChwb2ludCwgcmVjdFBvaW50cykgewogICAgLy/orqHnrpfnn6nlvaLoh6rouqvlnZDmoIfns7vnmoTkuIrmlrnlkJHlkJHph4/lkozlj7PmlrnlkJHlkJHph48KICAgIHZhciB1cCA9IHsKICAgICAgeDogcmVjdFBvaW50c1sxXS54IC0gcmVjdFBvaW50c1syXS54LAogICAgICB5OiByZWN0UG9pbnRzWzFdLnkgLSByZWN0UG9pbnRzWzJdLnkKICAgIH07CiAgICB2YXIgcmlnaHQgPSB7CiAgICAgIHg6IHJlY3RQb2ludHNbMV0ueCAtIHJlY3RQb2ludHNbMF0ueCwKICAgICAgeTogcmVjdFBvaW50c1sxXS55IC0gcmVjdFBvaW50c1swXS55CiAgICB9OyAvL+iuoeeul+efqeW9ouS4reW/g+eCuQoKICAgIHZhciBjZW50ZXIgPSB0aGlzLmdldFBvaW50c0NlbnRlcihyZWN0UG9pbnRzKTsKICAgIHZhciBsaW5lID0gewogICAgICB4OiBwb2ludC54IC0gY2VudGVyLngsCiAgICAgIHk6IHBvaW50LnkgLSBjZW50ZXIueQogICAgfTsKICAgIHZhciB1cHJvaiA9IHRoaXMuZ2V0UHJvamVjdGlvblZlY3RvcihsaW5lLCB1cCk7CiAgICB2YXIgcnByb2ogPSB0aGlzLmdldFByb2plY3Rpb25WZWN0b3IobGluZSwgcmlnaHQpOwogICAgcmV0dXJuIHsKICAgICAgdXA6IHVwLAogICAgICB1cHJvajogdXByb2osCiAgICAgIHJpZ2h0OiByaWdodCwKICAgICAgcnByb2o6IHJwcm9qCiAgICB9OwogIH07IC8v5qC55o2u55+p5b2i5Lit5b+D5Yiw5p+Q5LiA54K55ZCR6YeP5Zyo55+p5b2i6L655qGG5ZCR6YeP55qE5oqV5b2x6ZW/5bqm5Yik5pat6K+l54K55piv5ZCm5Zyo55+p5b2i5YaFCgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS5pc1BvaW50SW5SZWN0Q2hlY2tCeUxlbiA9IGZ1bmN0aW9uIChwb2ludCwgcmVjdFBvaW50cykgewogICAgdmFyIHBjdiA9IHRoaXMuZ2V0UENWZWN0b3JQcm9qT25VcEFuZFJpZ2h0KHBvaW50LCByZWN0UG9pbnRzKTsKICAgIHZhciBwcmVjaXNpb24gPSAxMDA7IC8v5L+d55WZ5Lik5L2N5bCP5pWwCgogICAgdmFyIHVMZW4gPSBNYXRoLnJvdW5kKHRoaXMudmVjTGVuKHBjdi51cHJvaikgKiBwcmVjaXNpb24pOwogICAgdmFyIGhlaWdodCA9IE1hdGgucm91bmQodGhpcy52ZWNMZW4ocGN2LnVwKSAvIDIgKiBwcmVjaXNpb24pOwogICAgdmFyIHJMZW4gPSBNYXRoLnJvdW5kKHRoaXMudmVjTGVuKHBjdi5ycHJvaikgKiBwcmVjaXNpb24pOwogICAgdmFyIHdpZHRoID0gTWF0aC5yb3VuZCh0aGlzLnZlY0xlbihwY3YucmlnaHQpIC8gMiAqIHByZWNpc2lvbik7CgogICAgaWYgKHVMZW4gPD0gaGVpZ2h0ICYmIHJMZW4gPD0gd2lkdGgpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfTsgLy/moLnmja7op5LluqblkozliKTmlq3ngrnmmK/lkKblnKjnn6nlvaLlhoUKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmlzUG9pbnRJblJlY3RDaGVja0J5QW5nbGUgPSBmdW5jdGlvbiAocG9pbnQsIHJlY3RQb2ludHMpIHsKICAgIC8v5YWI6K6h566X5Zub5Liq5ZCR6YePCiAgICB2YXIgdmVjcyA9IFtdOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVjdFBvaW50cy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgcCA9IHJlY3RQb2ludHNbaV07CiAgICAgIHZlY3MucHVzaCh7CiAgICAgICAgeDogcC54IC0gcG9pbnQueCwKICAgICAgICB5OiBwLnkgLSBwb2ludC55CiAgICAgIH0pOwogICAgfSAvL+iuoeeul+aooeacgOWwj+WQkemHjwoKCiAgICB2YXIgc0luZGV4ID0gMDsKICAgIHZhciBzTGVuID0gMDsKCiAgICBmb3IgKGkgPSAwOyBpIDwgdmVjcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgbGVuID0gdGhpcy52ZWNMZW4odmVjc1tpXSk7CgogICAgICBpZiAobGVuID09IDAgfHwgbGVuIDwgc0xlbikgewogICAgICAgIHNJbmRleCA9IGk7CiAgICAgICAgc0xlbiA9IGxlbjsKICAgICAgfQogICAgfQoKICAgIGxlbiA9IHZlY3MubGVuZ3RoOwogICAgdmFyIHNWZWMgPSB2ZWNzLnNwbGljZShzSW5kZXgsIDEpWzBdOwogICAgdmFyIHRWZWMgPSBzVmVjOwogICAgdmFyIGVWZWM7IC8v5L6d5qyh6K6h566X5Zub5Liq5ZCR6YeP55qE5aS56KeSCgogICAgdmFyIGFuZ2xlcyA9IFtdOwoKICAgIGZvciAoaSA9IDE7IGkgPCBsZW47IGkrKykgewogICAgICB2YXIgZGF0YSA9IHRoaXMuZ2V0TWluQW5nbGUodFZlYywgdmVjcyk7CiAgICAgIHRWZWMgPSBkYXRhLnZlYzsKICAgICAgdmVjcy5zcGxpY2UoZGF0YS5pbmRleCwgMSk7CiAgICAgIGFuZ2xlcy5wdXNoKGRhdGEuYW5nbGUpOwoKICAgICAgaWYgKHZlY3MubGVuZ3RoID09IDEpIHsKICAgICAgICBlVmVjID0gdmVjc1swXTsKICAgICAgfQogICAgfQoKICAgIGFuZ2xlcy5wdXNoKHRoaXMuZ2V0TWluQW5nbGUoZVZlYywgW3NWZWNdKS5hbmdsZSk7CiAgICB2YXIgc3VtID0gMDsKCiAgICBmb3IgKGkgPSAwOyBpIDwgYW5nbGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHN1bSArPSBhbmdsZXNbaV07CiAgICB9IC8v5ZCR6YeP5LmL6Ze055qE5aS56KeS562J5LqOMzYw5bqm5YiZ6KGo56S654K55Zyo55+p5b2i5YaFCgoKICAgIHN1bSA9IHN1bS50b1ByZWNpc2lvbigxMik7IC8v5Y+WMTLkvY3nsr7luqbog73lnKjlpKfpg6jliIbmg4XlhrXkuIvop6PlhrPmta7ngrnmlbDor6/lt67lr7zoh7TnmoTnsr7luqbpl67popgKCiAgICBpZiAoc3VtIDwgMzYwKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH07IC8v6K6h566X5ZCR6YeP5pWw57uE55qE5Lit5ZCR6YeP5ZKM55uu5qCH5ZCR6YeP55qE5pyA5bCP5aS56KeSCgoKICBTaW1wbGVDcm9wLnByb3RvdHlwZS5nZXRNaW5BbmdsZSA9IGZ1bmN0aW9uICh0VmVjLCBhVmVjKSB7CiAgICB2YXIgbWluQW5nbGUgPSB0aGlzLnZlY0FuZ2xlKHRWZWMsIGFWZWNbMF0pOwogICAgdmFyIG1pbkluZGV4ID0gMDsKCiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFWZWMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIGFuZ2xlID0gdGhpcy52ZWNBbmdsZSh0VmVjLCBhVmVjW2ldKTsKCiAgICAgIGlmIChhbmdsZSA8IG1pbkFuZ2xlKSB7CiAgICAgICAgbWluQW5nbGUgPSBhbmdsZTsKICAgICAgICBtaW5JbmRleCA9IGk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gewogICAgICBhbmdsZTogbWluQW5nbGUsCiAgICAgIHZlYzogYVZlY1ttaW5JbmRleF0sCiAgICAgIGluZGV4OiBtaW5JbmRleAogICAgfTsKICB9OyAvL+iuoeeul+WQkemHj+WkueinkgoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUudmVjQW5nbGUgPSBmdW5jdGlvbiAodmVjMSwgdmVjMikgewogICAgdmFyIGFjb3MgPSAodmVjMS54ICogdmVjMi54ICsgdmVjMS55ICogdmVjMi55KSAvICh0aGlzLnZlY0xlbih2ZWMxKSAqIHRoaXMudmVjTGVuKHZlYzIpKTsKCiAgICBpZiAoTWF0aC5hYnMoYWNvcykgPiAxKSB7CiAgICAgIC8v5Zug5Li65rWu54K55pWw57K+5bqm57uT5p6c5pyJ5Y+v6IO96LaF6L+HMe+8jE1hdGguYWNvcygxLjAwMDAwMDEpID0gTmFOCiAgICAgIGFjb3MgPSBhY29zID4gMCA/IDEgOiAtMTsKICAgIH0KCiAgICB2YXIgcmFkID0gTWF0aC5hY29zKGFjb3MpOwogICAgdmFyIGFuZ2xlID0gcmFkICogMTgwIC8gTWF0aC5QSTsKICAgIHJldHVybiBhbmdsZTsKICB9OyAvL+iuoeeul+WQkemHj+eahOaooQoKCiAgU2ltcGxlQ3JvcC5wcm90b3R5cGUudmVjTGVuID0gZnVuY3Rpb24gKHZlYykgewogICAgcmV0dXJuIE1hdGguc3FydCh2ZWMueCAqIHZlYy54ICsgdmVjLnkgKiB2ZWMueSk7CiAgfTsgLy9maWxl6L2saW1hZ2UKCgogIFNpbXBsZUNyb3AucHJvdG90eXBlLmZpbGVUb1NyYyA9IGZ1bmN0aW9uIChmaWxlLCBjYWxsYmFjaykgewogICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CgogICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIGNhbGxiYWNrKGUudGFyZ2V0LnJlc3VsdCk7CiAgICB9OwoKICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpOwogIH07CgogIHJldHVybiBTaW1wbGVDcm9wOwp9KTs="},{"version":3,"sources":["/Users/suhang/Template/tradingview/demo2/src/components/sSimpleCrop/modules/index.js"],"names":["factory","define","amd","module","exports","require","window","SimpleCrop","Prefix","EXIF","TransformationMatrix","whichTransitionEvent","t","el","document","createElement","transitions","style","undefined","transitionEndEvent","transformProperty","prefix","transitionProperty","Array","prototype","includes","Object","defineProperty","value","valueToFind","fromIndex","o","len","length","n","k","Math","max","abs","sameValueZero","x","y","isNaN","params","id","Date","getTime","visible","title","debug","$container","body","scaleSlider","maxScale","self","passiveSupported","options","get","addEventListener","err","isSupportTouch","_multiPoint","_rotateScale","_baseMoveX","_curMoveX","_changedX","_downPoints","_isControl","_scaleMoveX","_baseAngle","scaleTimes","rotateAngle","construct","initFuncBtns","initRotateSlider","initChilds","initBoxBorder","updateBox","bindEvent","initTitle","$title","querySelector","innerText","visibility","onlyInit","borderWidth","borderColor","boldCornerLen","coverColor","coverDraw","borderDraw","defaultBorderDraw","$cropCover","funcBtns","cropCallback","closeCallback","uploadCallback","$cropBtns","html","innerHTML","$uploadBtn","removeEventListener","__uploadInput","uploadInput","bind","$uploadInput","$cropBtn","__crop","crop","$aroundBtn","__around","around","$resetBtn","reset","__reset","$closeBtn","close","__close","rotateSlider","startAngle","endAngle","gapAngle","lineationItemWidth","parseInt","ceil","lineationWidth","$cropRotate","$lineation","$rotateCurrent","rotateStyle","getComputedStyle","rotateWidth","parseFloat","getPropertyValue","angle","startControl","transform","endControl","i","width","$cropMask","maskStyle","maskViewSize","height","cropCoverContext","getContext","devicePixelRatio","$cropScale","$scaleBtn","$scaleNum","$scaleOneTimes","$scaleTwoTimes","$scaleContainer","$scaleValue","$maxScale","scaleDownX","scaleInitLeft","getBoundingClientRect","left","scaleCurLeft","scaleWidth","size","positionOffset","top","cropSizePercent","times","cropRect","cropPoints","rectToPoints","cropCenter","getPointsCenter","src","setImage","getControlPoints","e","touches","clientX","clientY","getControlEvents","start","move","end","cancel","initScaleSlider","initScale","$target","classList","add","appendChild","coverWidth","coverHeight","clearRect","fillStyle","fillRect","borderRect","init","contentWidth","contentHeight","initContentPoints","contentPoints","slice","_contentCurMoveX","_contentCurMoveY","load","originImage","onload","getData","_orientation","getTag","getRealCotentSize","transformCoordinates","image","type","toString","call","Image","fileToSrc","show","hide","getCropImage","$resultCanvas","evt","files","target","controlEvents","ev","scaleMove","stopPropagation","rect","scaleMoveAt","point","moveX","lastMoveX","curMoveX","preventDefault","$imageListenerEle","center","fingerLen","sqrt","pow","fingerScale","fingerCenter","passive","capture","contentMove","newFingerLen","newScale","translate","getFingerScaleTranslate","translateX","translateY","scale","fingerPoints","push","newCenter","$cropContent","removeChild","imageCtx","rotate","PI","drawImage","_initTransform","position","insertBefore","scaleNum","cropWidth","cropHeight","ratio","$contentCanvas","contentCtx","$cropCanvas","cropCtx","isWholeCover","coverTr","getCoverTransform","coverMat","getTransformMatrix","f","getTransformPoints","indexOf","coverTrAr","substring","trim","split","no","tr","isTwoFingerEvent","pointX","newCurLeft","moveY","rotateCover","scaleKeepCover","scMat","rotatePoints","coverScale","getCoverRectScale","changedX","totalMoveX","rotateCenter","centerVec","percent","vecLen","outer","inner","num","getCoverPointScale","rectA","rectB","isPointInRectCheckByLen","rectPoints","pcv","getPCVectorProjOnUpAndRight","uLen","uproj","up","rLen","rproj","right","onlyTranslate","cRect","getCoveRect","uScale","rScale","cup","cright","tup","tright","uAng","vecAngle","scalePoints","count","outDetails","getOutDetails","sort","a","b","aLen","iv","bLen","maxFarOut","maxFarPcv","uOver","rAng","rOver","pt","rad","nRect","sin","cos","points","matrix","nPoints","item","applyToPoint","reverse","transforms","func","getTransformFunctionName","result","name","compose","arr","toLowerCase","defParams","unshift","getProjectionVector","vecA","vecB","ab","proj","line","precision","round","isPointInRectCheckByAngle","vecs","p","sIndex","sLen","sVec","splice","tVec","eVec","angles","data","getMinAngle","vec","index","sum","toPrecision","aVec","minAngle","minIndex","vec1","vec2","acos","file","callback","reader","FileReader","readAsDataURL"],"mappings":"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","sourcesContent":["/* eslint-disable no-undef */\n(function (factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['prefix-umd', 'exif-js', 'transformation-matrix'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node/CommonJS\n        module.exports = factory(require('prefix-umd'), require('exif-js'), require('transformation-matrix'));\n    } else {\n        // Browser globals\n        window.SimpleCrop = factory(window.Prefix, window.EXIF, window.TransformationMatrix);\n    }\n}(function (Prefix, EXIF, TransformationMatrix) {\n    //兼容性处理\n    function whichTransitionEvent() {\n        var t;\n        var el = document.createElement('div');\n        var transitions = {\n            'transition': 'transitionend',\n            'OTransition': 'oTransitionEnd',\n            'MozTransition': 'transitionend',\n            'WebkitTransition': 'webkitTransitionEnd',\n            'MsTransition': 'msTransitionEnd'\n        };\n        for (t in transitions) {\n            if (el.style[t] !== undefined) {\n                return transitions[t];\n            }\n        }\n    }\n    var transitionEndEvent = whichTransitionEvent();\n    var transformProperty = Prefix.prefix('transform');\n    var transitionProperty = Prefix.prefix('transition');\n\n    //includes方法兼容\n    if (!Array.prototype.includes) {\n        Object.defineProperty(Array.prototype, 'includes', {\n            value: function (valueToFind, fromIndex) {\n                var o = Object(this);\n                var len = o.length >>> 0;\n                if (len === 0) {\n                    return false;\n                }\n\n                var n = fromIndex | 0;\n                var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\n\n                function sameValueZero(x, y) {\n                    return x === y || (typeof x === 'number' && typeof y === 'number' && isNaN(x) && isNaN(y));\n                }\n                while (k < len) {\n                    if (sameValueZero(o[k], valueToFind)) {\n                        return true;\n                    }\n                    k++;\n                }\n                return false;\n            }\n        });\n    }\n\n    /**\n     * ------------------------------------\n     * 配置\n     * @param title 标题\n     * @param visible 组件是否可见\n     * @param debug 是否开启调试模式（pc、mobile）\n     * @param $container 容器（pc、mobile）\n     * ------------------------------------\n     * 裁剪图片\n     * @param src   图片地址\n     * @param size 裁剪图片目标尺寸\n     * originImage 初始图片\n     * _orientation 图片方向\n     * ------------------------------------\n     * 裁剪框\n     * @param positionOffset 裁剪框屏幕偏移\n     * @param boldCornerLen 裁剪框边角加粗长度\n     * @param coverColor 遮罩背景颜色\n     * @param cropSizePercent 裁剪框占裁剪显示区域的比例\n     * @param borderWidth 裁剪框边框宽度\n     * @param borderColor 裁剪框边框颜色\n     * @param coverDraw 裁剪框辅助线绘制函数\n     * @param borderDraw 裁剪框边框绘制函数\n     * ------------------------------------\n     * 功能按钮\n     * @param funcBtns 功能按钮配置数组\n     * @param cropCallback 图片裁剪完成回调函数\n     * @param uploadCallback 重新上传裁剪图片回调函数\n     * @param closeCallback 关闭裁剪组件回调函数\n     * ------------------------------------\n     * 滑动控制条\n     * @param scaleSlider 是否开启滑动控制条（pc、mobile）\n     * @param maxScale 最大缩放倍数（pc、mobile）\n     * ------------------------------------\n     * 旋转刻度盘\n     * @param rotateSlider 是否开启旋转刻度盘\n     * @param startAngle 旋转刻度盘开始角度\n     * @param endAngle 旋转刻度盘结束角度\n     * @param gapAngle 旋转刻度盘间隔角度\n     * @param lineationItemWidth 旋转刻度盘间隔宽度\n     * lineationWidth 根据上述参数计算出的旋转刻度盘总宽度\n     * rotateWidth 旋转刻度盘显示宽度\n     * ------------------------------------\n     * 尺寸（为了减少计算的复杂性，所有坐标都统一为屏幕坐标及尺寸）\n     * maskViewSize 容器屏幕尺寸\n     * cropRect 截图框屏幕尺寸\n     * cropPoints 裁剪框顶点坐标\n     * cropCenter 裁剪框中心点坐标\n     * contentWidth 图片显示宽度\n     * contentHeight 图片显示高度\n     * contentPoints 图片顶点坐标\n     * initContentPoints 图片初始顶点坐标\n     * _contentCurMoveX 图片 X 轴方向上的总位移\n     * _contentCurMoveY 图片 Y 轴方向上的总位移\n     * ------------------------------------\n     * 双指缩放\n     * _multiPoint 是否开始多点触控\n     * fingerLen 双指距离\n     * fingerScale 双指缩放倍数\n     * fingerCenter 双指操作中心\n     * ------------------------------------\n     * 其它\n     * times 实际尺寸/显示尺寸\n     * initScale 初始缩放倍数\n     * $resultCanvas 裁切结果（pc、mobile）\n     * resultSrc 裁剪结果（wechat）\n     * isSupportTouch 是否支持 touch 事件（pc、mobile）\n     * passiveSupported 事件是否支持 passive（pc、mobile）\n     */\n    function SimpleCrop(params) {\n        //配置\n        this.id = 'crop-' + new Date().getTime();\n        this.visible = params.visible != null ? params.visible : true; //默认显示\n        this.title = params.title != null ? params.title : '';\n        this.debug = params.debug != null ? params.debug : false;\n        this.$container = params.$container != null ? params.$container : document.body; //容器\n\n        //滑动控制条\n        this.scaleSlider = params.scaleSlider != null ? params.scaleSlider : false;\n        this.maxScale = params.maxScale ? params.maxScale : 1; //最大缩放倍数，默认为原始尺寸\n\n        //其它\n        var self = this;\n        self.passiveSupported = false; //判断是否支持 passive\n        try {\n            var options = Object.defineProperty({}, 'passive', {\n                get: function () {\n                    self.passiveSupported = true;\n                }\n            })\n            window.addEventListener('test', null, options)\n        } catch (err) {\n            //nothing\n        }\n        this.isSupportTouch = 'ontouchend' in document ? true : false; //判断是否支持 touch 事件\n\n        //操作状态\n        this._multiPoint = false; //是否开始多点触控\n        this._rotateScale = 1; //旋转缩放倍数\n        this._baseMoveX = 0; //旋转刻度盘位置初始化偏移量\n        this._curMoveX = 0; //旋转刻度盘位置当前总偏移量\n        this._changedX = 0; //旋转刻度盘当前偏移量\n        this._downPoints = []; //操作点坐标数组\n        this._isControl = false; //是否正在操作\n        this._scaleMoveX = 0; //滑动缩放控件偏移量\n        /**\n         * 旋转交互分为两种：\n         * 一种是整角旋转（90度）；\n         * 另一种是基于整角旋转的基础上正负45度旋转。\n         */\n        this._baseAngle = 0;\n        this.scaleTimes = 1; //缩放倍数\n        this.rotateAngle = 0; //旋转角度\n\n        this.construct();\n        //注意 construct 和 bindEvent 中间函数的先后顺序\n        this.initFuncBtns(params); //初始化功能按钮\n        this.initRotateSlider(params); //初始化旋转刻度盘\n        this.initChilds();\n        this.initBoxBorder(params, true);\n        this.updateBox(params);\n        this.bindEvent();\n    }\n\n    //初始化标题\n    SimpleCrop.prototype.initTitle = function (params) {\n        this.title = params.title != null ? params.title : '';\n        this.$title = document.querySelector('#' + this.id + ' .crop-title');\n        this.$title.innerText = this.title;\n        if (!params.title) {\n            this.$title.style.visibility = '';\n        } else {\n            this.$title.style.visibility = 'hidden';\n        }\n    };\n\n    //初始化裁剪框边框以及辅助线\n    SimpleCrop.prototype.initBoxBorder = function (params, onlyInit) {\n        this.borderWidth = params.borderWidth != null ? params.borderWidth : 1;\n        this.borderColor = params.borderColor != null ? params.borderColor : '#fff';\n        this.boldCornerLen = params.boldCornerLen != null ? params.boldCornerLen : 24;\n        this.coverColor = params.coverColor != null ? params.coverColor : 'rgba(0,0,0,.3)';\n        this.coverDraw = params.coverDraw != null ? params.coverDraw : function () {};\n        this.borderDraw = params.borderDraw != null ? params.borderDraw : this.defaultBorderDraw;\n\n        if (!onlyInit) {\n            this.borderDraw(this.$cropCover);\n            this.coverDraw(this.$cropCover);\n        }\n    };\n\n    //初始化功能按钮\n    SimpleCrop.prototype.initFuncBtns = function (params) {\n        /**\n         * 默认功能按钮为取消、裁剪、90度旋转、重置\n         * upload 重新上传\n         * crop 裁剪\n         * close 取消\n         * around 90度旋转\n         * reset 重置\n         */\n        this.funcBtns = params.funcBtns != null ? params.funcBtns : ['close', 'crop', 'around', 'reset'];\n        this.cropCallback = params.cropCallback != null ? params.cropCallback : function () {};\n        this.closeCallback = params.closeCallback != null ? params.closeCallback : function () {};\n        this.uploadCallback = params.uploadCallback != null ? params.uploadCallback : function () {};\n\n        this.$cropBtns = document.querySelector('#' + this.id + ' .crop-btns');\n        var html = '';\n        if (this.funcBtns.includes('upload')) {\n            html += '<div class=\"upload-btn-container\">';\n            html += '<button class=\"upload-btn\"></button>';\n            html += '<input type=\"file\" accept=\"image/png,image/jpeg\">';\n            html += '</div>';\n        }\n        if (this.funcBtns.includes('close')) {\n            html += '<button class=\"crop-close\"></button>';\n        }\n        if (this.funcBtns.includes('around')) {\n            html += '<button class=\"crop-around\"></button>';\n        }\n        if (this.funcBtns.includes('reset')) {\n            html += '<button class=\"crop-reset\"></button>';\n        }\n        if (this.funcBtns.includes('crop')) {\n            html += '<button class=\"crop-btn\"></button>';\n        }\n        this.$cropBtns.innerHTML = html;\n\n        //重新上传\n        if (this.funcBtns.includes('upload')) {\n            if (this.$uploadBtn) {\n                this.$uploadBtn.removeEventListener('change', this.__uploadInput);\n            } else {\n                this.__uploadInput = this.uploadInput.bind(this);\n            }\n            this.$uploadBtn = document.querySelector('#' + this.id + ' .upload-btn-container');\n            this.$uploadInput = document.querySelector('#' + this.id + ' .upload-btn-container input');\n            this.$uploadBtn.addEventListener('change', this.__uploadInput);\n        }\n\n        //裁剪\n        if (this.funcBtns.includes('crop')) {\n            if (this.$cropBtn) {\n                this.$cropBtn.removeEventListener('click', this.__crop);\n            } else {\n                this.__crop = this.crop.bind(this);\n            }\n            this.$cropBtn = document.querySelector('#' + this.id + ' .crop-btn');\n            this.$cropBtn.addEventListener('click', this.__crop);\n        }\n\n        //整角旋转\n        if (this.funcBtns.includes('around')) {\n            if (this.$aroundBtn) {\n                this.$aroundBtn.removeEventListener('click', this.__around);\n            } else {\n                this.__around = this.around.bind(this);\n            }\n            this.$aroundBtn = document.querySelector('#' + this.id + ' .crop-around');\n            this.$aroundBtn.addEventListener('click', this.__around);\n        }\n\n        //还原\n        if (this.funcBtns.includes('reset')) {\n            if (this.$resetBtn) {\n                this.$resetBtn.removeEventListener('click', this.reset);\n            } else {\n                this.__reset = this.reset.bind(this);\n            }\n            this.$resetBtn = document.querySelector('#' + this.id + ' .crop-reset');\n            this.$resetBtn.addEventListener('click', this.__reset);\n        }\n\n        //关闭\n        if (this.funcBtns.includes('close')) {\n            if (this.$closeBtn) {\n                this.$closeBtn.removeEventListener('click', this.close);\n            } else {\n                this.__close = this.close.bind(this);\n            }\n            this.$closeBtn = document.querySelector('#' + this.id + ' .crop-close');\n            this.$closeBtn.addEventListener('click', this.__close);\n        }\n\n        if (this.funcBtns.length > 0) {\n            this.$cropBtns.style.visibility = '';\n        } else {\n            this.$cropBtns.style.visibility = 'hidden';\n        }\n    };\n\n    //初始化旋转刻度盘\n    SimpleCrop.prototype.initRotateSlider = function (params) {\n        this.rotateSlider = params.rotateSlider != null ? params.rotateSlider : true; //默认开启\n        this.startAngle = params.startAngle != null ? params.startAngle : -90;\n        this.endAngle = params.endAngle != null ? params.endAngle : 90;\n        this.gapAngle = params.gapAngle != null ? params.gapAngle : 10;\n        this.lineationItemWidth = params.lineationItemWidth != null ? params.lineationItemWidth : 40.5;\n        this.lineationItemWidth = this.lineationItemWidth >= 40.5 ? this.lineationItemWidth : 40.5; // 最小宽度限制\n\n        //开始角度需要小于0，结束角度需要大于0，且开始角度和结束角度之间存在大于0的整数个间隔\n        this.startAngle = this.startAngle < 0 ? parseInt(this.startAngle) : 0;\n        this.endAngle = this.endAngle > 0 ? parseInt(this.endAngle) : 0;\n        this.gapAngle = this.gapAngle > 0 ? parseInt(this.gapAngle) : 3;\n        if ((this.endAngle - this.startAngle) % this.gapAngle != 0) {\n            this.endAngle = Math.ceil((this.endAngle - this.startAngle) / this.gapAngle) * this.gapAngle + this.startAngle;\n        }\n        this.lineationWidth = this.lineationItemWidth * ((this.endAngle - this.startAngle) / this.gapAngle + 1);\n\n        this.$cropRotate = document.querySelector('#' + this.id + ' .crop-rotate');\n        this.$lineation = document.querySelector('#' + this.id + ' .lineation');\n        this.$rotateCurrent = document.querySelector('#' + this.id + ' .current');\n        var rotateStyle = window.getComputedStyle(this.$cropRotate);\n        this.rotateWidth = parseFloat(rotateStyle.getPropertyValue('width')); // 旋转刻度盘显示宽度\n        this._baseMoveX = -(this.lineationWidth * (0 - this.startAngle + this.gapAngle / 2) / (this.endAngle - this.startAngle + this.gapAngle) - this.rotateWidth / 2); //开始角度大于 0 且结束角度小于 0，以 0 度为起点\n        var angle = this.rotateAngle - this._baseAngle;\n        this._curMoveX = angle * this.lineationWidth / (this.endAngle - this.startAngle + this.gapAngle) + this._baseMoveX;\n\n        //超出滚动边界，旋转刻度盘重置\n        if (this._curMoveX > 0 || this._curMoveX < this.rotateWidth - this.lineationWidth) {\n            this.startControl();\n            this._curMoveX = this._baseMoveX;\n            this._baseAngle = 0;\n            this.rotateAngle = 0;\n            this._changedX = 0;\n            this._rotateScale = 1;\n            this.transform(true);\n            this.endControl();\n        }\n\n        //setData\n        var html = '';\n        for (var i = this.startAngle; i <= this.endAngle; i += this.gapAngle) {\n            html += '<li><div class=\"number\">' + i + '</div><div class=\"bg\"></div></li>';\n        }\n        this.$lineation.innerHTML = html;\n        this.$lineation.style.width = this.lineationWidth + 'px';\n        this.$lineation.style[transformProperty] = 'translateX(' + this._curMoveX + 'px)';\n        if (this.rotateSlider) {\n            this.$cropRotate.style.visibility = '';\n        } else {\n            this.$cropRotate.style.visibility = 'hidden';\n        }\n    };\n\n    //初始化相关子元素\n    SimpleCrop.prototype.initChilds = function () {\n        this.$cropMask = document.querySelector('#' + this.id + ' .crop-mask');\n        var maskStyle = window.getComputedStyle(this.$cropMask);\n        this.maskViewSize = {\n            width: parseInt(maskStyle.getPropertyValue('width')),\n            height: parseInt(maskStyle.getPropertyValue('height'))\n        }\n        this.$cropCover = document.querySelector('#' + this.id + ' .crop-cover');\n        this.cropCoverContext = this.$cropCover.getContext('2d');\n        this.$cropCover.width = this.maskViewSize.width * window.devicePixelRatio;\n        this.$cropCover.height = this.maskViewSize.height * window.devicePixelRatio;\n\n        //滑动控制条\n        this.$cropScale = document.querySelector('#' + this.id + ' .crop-scale');\n        this.$scaleBtn = document.querySelector('#' + this.id + ' .scale-btn');\n        this.$scaleNum = document.querySelector('#' + this.id + ' .scale-num');\n        this.$scaleOneTimes = document.querySelector('#' + this.id + ' .one-times-icon');\n        this.$scaleTwoTimes = document.querySelector('#' + this.id + ' .two-times-icon');\n        this.$scaleContainer = document.querySelector('#' + this.id + ' .scale-container');\n        this.$scaleValue = document.querySelector('#' + this.id + ' .scale-value');\n        this.$maxScale = document.querySelector('#' + this.id + ' .max-scale');\n        this.scaleDownX = 0;\n        this.scaleInitLeft = this.$scaleBtn.getBoundingClientRect().left;\n        this.scaleCurLeft = this.scaleInitLeft;\n        this.scaleWidth = this.$scaleNum.getBoundingClientRect().width;\n    };\n\n    //根据裁剪图片目标尺寸、裁剪框显示比例、裁剪框偏移更新等参数更新并重现绘制裁剪框\n    SimpleCrop.prototype.updateBox = function (params) {\n        this.size = params.size;\n        this.positionOffset = params.positionOffset != null ? params.positionOffset : {\n            top: 0,\n            left: 0\n        };\n        this.cropSizePercent = params.cropSizePercent != null ? params.cropSizePercent : 0.5; //默认0.5则表示高度或者宽度最多占50%\n        this.times = (this.size.width / this.maskViewSize.width > this.size.height / this.maskViewSize.height) ? this.size.width / this.maskViewSize.width / this.cropSizePercent : this.size.height / this.maskViewSize.height / this.cropSizePercent;\n\n        //裁剪框位置相关\n        this.cropRect = {\n            width: this.size.width / this.times,\n            height: this.size.height / this.times,\n        };\n        this.cropRect.left = (this.maskViewSize.width - this.cropRect.width) / 2 - this.positionOffset.left;\n        this.cropRect.top = (this.maskViewSize.height - this.cropRect.height) / 2 - this.positionOffset.top;\n        this.cropPoints = this.rectToPoints(this.cropRect);\n        this.cropCenter = this.getPointsCenter(this.cropPoints);\n\n        this.borderDraw(this.$cropCover);\n        this.coverDraw(this.$cropCover);\n\n        var src = params.src != null ? params.src : this.src;\n        this.setImage(src)\n    };\n\n    //获取操作点\n    SimpleCrop.prototype.getControlPoints = function (e) {\n        if (e.touches) {\n            return e.touches;\n        } else {\n            return [{\n                clientX: e.clientX,\n                clientY: e.clientY\n            }]\n        }\n    };\n\n    //获取操作事件名称\n    SimpleCrop.prototype.getControlEvents = function () {\n        if (this.isSupportTouch) {\n            return {\n                start: 'touchstart',\n                move: 'touchmove',\n                end: 'touchend',\n                cancel: 'touchcancel'\n            }\n        } else {\n            return {\n                start: 'mousedown',\n                move: 'mousemove',\n                end: 'mouseup',\n                cancel: 'mouseleave'\n            }\n        }\n    };\n\n    //初始化滑动控制条\n    SimpleCrop.prototype.initScaleSlider = function (params) {\n        if (params) {\n            this.scaleSlider = params.scaleSlider != null ? params.scaleSlider : false;\n            this.maxScale = params.maxScale ? params.maxScale : 1; //最大缩放倍数，默认为原始尺寸\n        }\n        this.scaleTimes = this.initScale;\n        this.maxScale = this.initScale < this.maxScale ? this.maxScale : Math.ceil(this.initScale);\n\n        this._scaleMoveX = 0;\n        this.scaleCurLeft = this.scaleInitLeft;\n        this.$maxScale.innerText = '(x' + this.maxScale + ')';\n        this.$scaleBtn.style[transformProperty] = 'translateX(0px)';\n        this.$scaleValue.style.width = '0px';\n\n        if (this.scaleSlider) {\n            this.$cropScale.style.visibility = '';\n        } else {\n            this.$cropScale.style.visibility = 'hidden';\n        }\n        this.transform(false, true);\n    };\n\n    //html结构\n    SimpleCrop.prototype.construct = function () {\n        var html = '';\n        html += '<div class=\"crop-component\">';\n        html += '<p class=\"crop-title\">' + this.title + '</p>';\n        html += '<div class=\"crop-mask\">'\n        html += '<canvas class=\"crop-cover\"></canvas>';\n        html += '</div>';\n\n        //滑动控制条\n        if (this.scaleSlider) {\n            html += '<div class=\"crop-scale\">';\n        } else {\n            html += '<div class=\"crop-scale\" style=\"visibility:hidden;\">';\n        }\n        html += '<div class=\"one-times-icon\"></div>';\n        html += '<div class=\"scale-container\">';\n        html += '<div class=\"scale-num\"><span class=\"scale-value\" style=\"width:0px;\"></span><span class=\"scale-btn\" style=\"left:-8px;\"></span></div>';\n        html += '</div>';\n        html += '<div class=\"two-times-icon\"></div>';\n        html += '<div class=\"max-scale\"></div>'\n        html += '</div>';\n\n        //旋转刻度盘\n        if (this.rotateSlider) {\n            html += '<div class=\"crop-rotate\">'\n        } else {\n            html += '<div class=\"crop-rotate\" style=\"visibility:hidden;\">'\n        }\n        html += '<ul class=\"lineation\">';\n        html += '</ul>';\n        html += '<div class=\"current\"></div>';\n        html += '</div>';\n\n        //功能按钮\n        html += '<div class=\"crop-btns\" style=\"visibility:hidden;\"></div>';\n        html += '</div>';\n\n        this.$target = document.createElement('div');\n        this.$target.id = this.id;\n        this.$target.classList.add('crop-whole-cover');\n        if (this.visible) {\n            this.$target.style.visibility = '';\n        } else {\n            this.$target.style.visibility = 'hidden';\n        }\n        this.$target.innerHTML = html;\n        this.$container.appendChild(this.$target);\n\n    };\n\n    //默认绘制裁剪框\n    SimpleCrop.prototype.defaultBorderDraw = function ($cropCover) {\n        var borderWidth = this.borderWidth;\n        var boldCornerLen = this.boldCornerLen;\n        boldCornerLen = boldCornerLen >= borderWidth * 2 ? boldCornerLen : borderWidth * 2;\n\n        var coverWidth = $cropCover.width;\n        var coverHeight = $cropCover.height;\n        this.cropCoverContext.clearRect(0, 0, coverWidth, coverHeight);\n        this.cropCoverContext.fillStyle = this.coverColor;\n        this.cropCoverContext.fillRect(0, 0, coverWidth, coverHeight);\n\n        //绘制边框（边框内嵌）\n        var borderRect = {\n            left: this.cropRect.left * window.devicePixelRatio,\n            top: this.cropRect.top * window.devicePixelRatio,\n            width: this.cropRect.width * window.devicePixelRatio,\n            height: this.cropRect.height * window.devicePixelRatio\n        }\n        this.cropCoverContext.fillStyle = this.borderColor;\n        this.cropCoverContext.fillRect(borderRect.left, borderRect.top, borderRect.width, borderRect.height);\n\n        if (this.boldCornerLen > 0) {\n            //边框四个角加粗\n            this.cropCoverContext.fillRect(borderRect.left - borderWidth, borderRect.top - borderWidth, boldCornerLen, boldCornerLen); //左上角\n            this.cropCoverContext.fillRect(borderRect.left + borderRect.width - boldCornerLen + borderWidth, borderRect.top - borderWidth, boldCornerLen, boldCornerLen); //右上角\n            this.cropCoverContext.fillRect(borderRect.left - borderWidth, borderRect.top + borderRect.height - boldCornerLen + borderWidth, boldCornerLen, boldCornerLen); //左下角\n            this.cropCoverContext.fillRect(borderRect.left + borderRect.width - boldCornerLen + borderWidth, borderRect.top + borderRect.height - boldCornerLen + borderWidth, boldCornerLen, boldCornerLen); //右下角\n        }\n\n        //清空内容区域\n        this.cropCoverContext.clearRect(borderRect.left + borderWidth, borderRect.top + borderWidth, borderRect.width - 2 * borderWidth, borderRect.height - 2 * borderWidth);\n    };\n\n    //初始化\n    SimpleCrop.prototype.init = function () {\n        var width = this.contentWidth / 2;\n        var height = this.contentHeight / 2;\n        this.initContentPoints = [{\n            x: -width,\n            y: height\n        }, {\n            x: width,\n            y: height\n        }, {\n            x: width,\n            y: -height\n        }, {\n            x: -width,\n            y: -height\n        }]\n        this.contentPoints = this.initContentPoints.slice();\n\n        //计算初始缩放倍数\n        if (this.size.width / this.size.height > this.contentWidth / this.contentHeight) {\n            this.initScale = this.size.width / this.contentWidth;\n        } else {\n            this.initScale = this.size.height / this.contentHeight;\n        }\n\n        this.reset();\n    };\n\n    //重置\n    SimpleCrop.prototype.reset = function () {\n        this.startControl();\n        this._contentCurMoveX = -this.positionOffset.left;\n        this._contentCurMoveY = -this.positionOffset.top;\n\n        this._rotateScale = 1;\n        this._baseAngle = 0;\n        this.rotateAngle = 0;\n        this._curMoveX = this._baseMoveX;\n        this._changedX = 0;\n        this.$lineation.style[transformProperty] = 'translateX(' + this._baseMoveX + 'px)';\n\n        this.initScaleSlider();\n        this.endControl();\n    };\n\n    //加载图片\n    SimpleCrop.prototype.load = function () {\n        var self = this;\n        self.originImage.onload = function () {\n            EXIF.getData(self.originImage, function () {\n                self._orientation = EXIF.getTag(this, 'Orientation');\n                self.getRealCotentSize();\n                self.transformCoordinates();\n                self.init();\n            });\n        }\n    };\n\n    //设置裁剪图片\n    SimpleCrop.prototype.setImage = function (image) {\n        if (image != null && image != '') {\n            var self = this;\n            var type = Object.prototype.toString.call(image);\n            if (type === '[object String]') { //字符串\n                self.src = image;\n                self.originImage = new Image();\n                self.originImage.src = self.src;\n                self.load();\n                self.uploadCallback(self.src);\n            } else if (type === '[object File]') { //文件\n                self.fileToSrc(image, function (src) {\n                    self.src = src;\n                    self.originImage = new Image();\n                    self.originImage.src = self.src;\n                    self.load();\n                    self.uploadCallback(self.src);\n                });\n            }\n        }\n    };\n\n    //显示\n    SimpleCrop.prototype.show = function (image) {\n        if (image) {\n            this.setImage(image);\n        }\n        this.visible = true;\n        this.$target.style.visibility = '';\n    };\n\n    //隐藏\n    SimpleCrop.prototype.hide = function () {\n        this.visible = false;\n        this.$target.style.visibility = 'hidden';\n    };\n\n    //关闭\n    SimpleCrop.prototype.close = function () {\n        this.hide();\n        this.closeCallback();\n    };\n\n    //裁剪\n    SimpleCrop.prototype.crop = function () {\n        this.getCropImage();\n        this.cropCallback(this.$resultCanvas);\n        this.hide();\n    };\n\n    //上传\n    SimpleCrop.prototype.uploadInput = function (evt) {\n        var files = evt.target.files;\n        if (files.length > 0) {\n            this.show(files[0]);\n        }\n        this.$uploadInput.value = ''; //清空value属性，从而保证用户修改文件内容但是没有修改文件名时依然能上传成功\n    };\n\n    //整角旋转\n    SimpleCrop.prototype.around = function () {\n        this.startControl();\n        this.rotateAngle = (this._baseAngle - 90) % 360;\n        this._baseAngle = this.rotateAngle;\n        this._curMoveX = this._baseMoveX;\n        this._changedX = 0;\n        this._rotateScale = 1;\n        this.$lineation.style[transformProperty] = 'translateX(' + this._baseMoveX + 'px)';\n        this.transform(false, true);\n        this.endControl();\n    };\n\n    //事件监听\n    SimpleCrop.prototype.bindEvent = function () {\n        var self = this;\n        var controlEvents = this.getControlEvents();\n\n        //滑动控制条\n        // ------------------ //\n        self.$scaleBtn.addEventListener(controlEvents.start, function (ev) {\n            self.scaleDownX = self.getControlPoints(ev)[0].clientX;\n            self.startControl();\n        });\n        self.$scaleContainer.addEventListener(controlEvents.move, function (ev) {\n            self.scaleMove(ev);\n            ev.stopPropagation();\n        });\n        self.$scaleContainer.addEventListener(controlEvents.cancel, self.endControl.bind(self)); //结束\n        self.$scaleContainer.addEventListener(controlEvents.end, self.endControl.bind(self));\n        self.$scaleContainer.addEventListener('click', function (ev) {\n            self.startControl();\n            var rect = self.$scaleBtn.getBoundingClientRect();\n            if (self.scaleDownX <= 0) {\n                self.scaleDownX = rect.left + rect.width * 1.0 / 2;\n            }\n            self.scaleMove(ev);\n            self.endControl();\n        });\n        self.$scaleOneTimes.addEventListener('click', function () { //极小\n            self.startControl();\n            self.scaleMoveAt(0);\n            self.endControl();\n        });\n        self.$scaleTwoTimes.addEventListener('click', function () { //极大\n            self.startControl();\n            self.scaleMoveAt(self.scaleWidth);\n            self.endControl();\n        });\n        // ------------------ //\n\n        //旋转刻度盘\n        // ------------------ //\n        self.$cropRotate.addEventListener(controlEvents.start, function (e) {\n            var touches = self.getControlPoints(e);\n            self.startControl(touches);\n        });\n        self.$cropRotate.addEventListener(controlEvents.move, function (e) {\n            var touches = self.getControlPoints(e);\n            if (self._downPoints && self._downPoints.length > 0 && !self._multiPoint) {\n                var point = touches[0];\n                var moveX = point.clientX - self._downPoints[0].clientX;\n                var lastMoveX = self._curMoveX;\n                var curMoveX = lastMoveX + moveX;\n                if (curMoveX <= 0 && curMoveX >= (self.rotateWidth - self.lineationWidth)) { //滚动边界\n                    var angle = (curMoveX - self._baseMoveX) / self.lineationWidth * (self.endAngle - self.startAngle + self.gapAngle);\n                    self._curMoveX = curMoveX;\n                    self._changedX = moveX;\n                    self.$lineation.style[transformProperty] = 'translateX(' + curMoveX + 'px)';\n                    self.rotateAngle = self._baseAngle + angle;\n                    self.transform(true);\n                    self._downPoints = touches;\n                }\n            }\n            e.stopPropagation(); //阻止事件冒泡\n            e.preventDefault();\n        });\n        self.$cropRotate.addEventListener(controlEvents.end, self.endControl.bind(self)); //结束\n        self.$cropRotate.addEventListener(controlEvents.cancel, self.endControl.bind(self));\n        // ------------------ //\n\n        //裁剪图片移动、双指缩放操作\n        // ------------------ //\n        var $imageListenerEle = self.isSupportTouch ? self.$container : self.$cropMask;\n        $imageListenerEle.addEventListener(controlEvents.start, function (ev) {\n            var touches = self.getControlPoints(ev);\n            self.startControl(touches);\n            self._multiPoint = false;\n            if (self._downPoints && self._downPoints.length >= 2) {\n                self._multiPoint = true;\n                var center = {\n                    clientX: (self._downPoints[0].clientX + self._downPoints[1].clientX) / 2,\n                    clientY: (self._downPoints[0].clientY + self._downPoints[1].clientY) / 2\n                };\n                self.fingerLen = Math.sqrt(Math.pow(self._downPoints[0].clientX - self._downPoints[1].clientX, 2) + Math.pow(self._downPoints[0].clientY - self._downPoints[1].clientY, 2));\n                self.fingerScale = 1;\n                self.fingerCenter = { //双指操作中心\n                    x: center.clientX - self.maskViewSize.width / 2,\n                    y: self.maskViewSize.height / 2 - center.clientY\n                }\n            }\n        });\n        var options = self.passiveSupported ? { // 如果浏览器支持 passive event listener 为了保证截图操作时页面不滚动需要设置为 false\n            passive: false,\n            capture: false\n        } : false;\n        $imageListenerEle.addEventListener(controlEvents.move, function (ev) {\n            var touches = self.getControlPoints(ev);\n            if (self._downPoints && self._downPoints.length > 0) {\n                if (!self._multiPoint) { // 单指移动\n                    self.contentMove(touches);\n                } else { // 双指缩放\n                    var newFingerLen = Math.sqrt(Math.pow(touches[0].clientX - touches[1].clientX, 2) + Math.pow(touches[0].clientY - touches[1].clientY, 2));\n                    var newScale = newFingerLen / self.fingerLen;\n                    self.scaleTimes = self.scaleTimes / self.fingerScale * newScale;\n                    var translate = self.getFingerScaleTranslate(newScale / self.fingerScale);\n                    self._contentCurMoveX -= translate.translateX;\n                    self._contentCurMoveY += translate.translateY;\n                    self.fingerScale = newScale;\n                    self.transform(false, true);\n                }\n            }\n            if (self.visible) { //组件显示状态才屏蔽掉一些事件的默认行为，防止组件关闭后继续影响页面\n                ev.preventDefault();\n            }\n        }, options);\n        $imageListenerEle.addEventListener(controlEvents.end, self.endControl.bind(self)); //结束\n        $imageListenerEle.addEventListener(controlEvents.cancel, self.endControl.bind(self));\n        // ------------------ //\n    };\n\n    //双指缩放优化为以双指中心为基础点，实际变换以中心点为基准点，因此需要计算两者的偏移\n    SimpleCrop.prototype.getFingerScaleTranslate = function (scale) {\n        var fingerPoints = []; //以双指中心缩放的新坐标\n        var center = this.getPointsCenter(this.contentPoints); //中心点不变\n        for (var i = 0; i < this.contentPoints.length; i++) {\n            var point = this.contentPoints[i];\n            fingerPoints.push({\n                x: point.x * scale - this.fingerCenter.x * (scale - 1),\n                y: point.y * scale - this.fingerCenter.y * (scale - 1)\n            })\n        }\n        var newCenter = this.getPointsCenter(fingerPoints);\n        return {\n            translateX: center.x - newCenter.x,\n            translateY: center.y - newCenter.y\n        }\n    }\n\n    //根据图片方向计算源图片实际宽高\n    SimpleCrop.prototype.getRealCotentSize = function () {\n        this.contentWidth = this.originImage.width;\n        this.contentHeight = this.originImage.height;\n        //图片方向大于 4 时宽高互换\n        if (this._orientation > 4) {\n            this.contentWidth = this.originImage.height;\n            this.contentHeight = this.originImage.width;\n        }\n    }\n\n    //处理图片方向\n    SimpleCrop.prototype.transformCoordinates = function () {\n        if (this.$cropContent) {\n            this.$cropMask.removeChild(this.$cropContent);\n        }\n\n        this.$cropContent = document.createElement('canvas');\n        this.$cropContent.width = this.contentWidth;\n        this.$cropContent.height = this.contentHeight;\n        var imageCtx = this.$cropContent.getContext('2d');\n\n        var width = this.originImage.width;\n        var height = this.originImage.height;\n\n        switch (this._orientation) {\n            case 2:\n                // horizontal flip\n                imageCtx.translate(width, 0);\n                imageCtx.scale(-1, 1);\n                break;\n            case 3:\n                // 180° rotate left\n                imageCtx.translate(width, height);\n                imageCtx.rotate(Math.PI);\n                break;\n            case 4:\n                // vertical flip\n                imageCtx.translate(0, height);\n                imageCtx.scale(1, -1);\n                break;\n            case 5:\n                // vertical flip + 90 rotate right\n                imageCtx.rotate(0.5 * Math.PI);\n                imageCtx.scale(1, -1);\n                break;\n            case 6:\n                // 90° rotate right\n                imageCtx.rotate(0.5 * Math.PI);\n                imageCtx.translate(0, -height);\n                break;\n            case 7:\n                // horizontal flip + 90 rotate right\n                imageCtx.rotate(0.5 * Math.PI);\n                imageCtx.translate(width, -height);\n                imageCtx.scale(-1, 1);\n                break;\n            case 8:\n                // 90° rotate left\n                imageCtx.rotate(-0.5 * Math.PI);\n                imageCtx.translate(-width, 0);\n                break;\n        }\n        imageCtx.drawImage(this.originImage, 0, 0, width, height);\n\n        //初始位置垂直水平居中\n        this._initTransform = 'translate3d(-50%,-50%,0)';\n        this.$cropContent.classList.add('crop-content');\n        this.$cropContent.style.position = 'absolute';\n        this.$cropContent.style.left = '50%';\n        this.$cropContent.style.top = '50%';\n        this.$cropContent.style[transformProperty] = this._initTransform;\n        this.$cropMask.insertBefore(this.$cropContent, this.$cropCover);\n    }\n\n    //获取裁剪图片\n    SimpleCrop.prototype.getCropImage = function () {\n        var scaleNum = this.scaleTimes / this.times * this._rotateScale;\n        var contentWidth = this.contentWidth;\n        var contentHeight = this.contentHeight;\n        var cropWidth = this.size.width;\n        var cropHeight = this.size.height;\n\n        //需要考虑裁剪图片实际尺寸比裁剪尺寸小的情况\n        var ratio = 1;\n        if (contentWidth < cropWidth || contentHeight < cropHeight) { // 裁剪中间画布尺寸必须大于实际裁剪尺寸\n            if (cropWidth / contentWidth > cropHeight / contentHeight) {\n                ratio = cropWidth / contentWidth;\n                contentHeight = contentHeight * ratio;\n                contentWidth = cropWidth;\n            } else {\n                ratio = cropHeight / contentHeight;\n                contentWidth = contentWidth * ratio\n                contentHeight = cropHeight;\n            }\n        }\n        var center = {\n            x: contentWidth / 2,\n            y: contentHeight / 2\n        };\n\n        var $contentCanvas = document.createElement('canvas');\n        $contentCanvas.width = contentWidth;\n        $contentCanvas.height = contentHeight;\n        var contentCtx = $contentCanvas.getContext('2d');\n        contentCtx.translate(center.x, center.y);\n        contentCtx.scale(scaleNum * this.times / ratio, scaleNum * this.times / ratio) // 缩放 this.times\n        contentCtx.translate((this._contentCurMoveX + this.positionOffset.left) / scaleNum * ratio, (this._contentCurMoveY + this.positionOffset.top) / scaleNum * ratio);\n        contentCtx.rotate(this.rotateAngle / 180 * Math.PI);\n        contentCtx.translate(-center.x, -center.y);\n        contentCtx.drawImage(this.$cropContent, 0, 0, contentWidth, contentHeight);\n\n        var $cropCanvas = document.createElement('canvas');\n        $cropCanvas.width = cropWidth;\n        $cropCanvas.height = cropHeight;\n        var cropCtx = $cropCanvas.getContext('2d');\n        cropCtx.drawImage($contentCanvas, (contentWidth - cropWidth) / 2, (contentHeight - cropHeight) / 2, cropWidth, cropHeight, 0, 0, cropWidth, cropHeight);\n        this.$resultCanvas = $cropCanvas;\n    };\n\n    //操作结束\n    SimpleCrop.prototype.endControl = function () {\n        if (this._isControl) {\n            var self = this;\n            this._downPoints = [];\n            this.scaleDownX = 0;\n\n            if (this.$cropContent && !this.isWholeCover(this.contentPoints, this.cropPoints)) { //如果没有完全包含则需要进行适配变换\n                var scaleNum = this.scaleTimes / this.times * this._rotateScale;\n                var transform = '';\n                transform += ' scale(' + scaleNum + ')'; //缩放\n                transform += ' translateX(' + this._contentCurMoveX / scaleNum + 'px) translateY(' + this._contentCurMoveY / scaleNum + 'px)'; //移动\n                transform += ' rotate(' + this.rotateAngle + 'deg) ';\n\n                //适配变换\n                var coverTr = this.getCoverTransform(transform);\n                var coverMat = this.getTransformMatrix(coverTr);\n                this._contentCurMoveX = coverMat.e;\n                this._contentCurMoveY = coverMat.f;\n                this.contentPoints = this.getTransformPoints('scaleY(-1)' + coverTr, this.initContentPoints);\n\n                if (!this.debug) {\n                    this.$cropContent.style[transformProperty] = this._initTransform + coverTr;\n                } else {\n                    this.$cropContent.style[transitionProperty] = 'transform .5s linear';\n                    var start = coverTr.indexOf(transform) + transform.length;\n                    var coverTrAr = coverTr.substring(start, coverTr.length).trim().split(' ');\n                    var no = 0;\n                    var tr = this._initTransform + transform + coverTrAr[no];\n                    this.$cropContent.style[transformProperty] = tr;\n                    this.$cropContent.addEventListener(transitionEndEvent, function () {\n                        no++;\n                        if (no < coverTr.length) {\n                            tr += coverTrAr[no];\n                            self.$cropContent.style[transformProperty] = tr;\n                        }\n                    });\n                }\n            }\n\n            this._isControl = false;\n        }\n    };\n\n    //操作开始\n    SimpleCrop.prototype.startControl = function (touches) {\n        touches = touches ? touches : [];\n        if (!this._isControl || this.isTwoFingerEvent(touches)) {\n            this._isControl = true;\n            if (this.$cropContent) {\n                this.$cropContent.style[transitionProperty] = 'none';\n            }\n            this._downPoints = touches;\n        }\n    };\n\n    //双指操作事件\n    SimpleCrop.prototype.isTwoFingerEvent = function (touches) {\n        /**\n         * 微信小程序双指操作时，会触发两次 touchstart 事件且前后两次事件触摸点坐标有一个坐标相同\n         */\n        if (this._isControl && this._downPoints && this._downPoints.length == 1 && touches.length >= 2 &&\n            ((touches[0].clientX == this._downPoints[0].clientX && touches[0].clientY == this._downPoints[0].clientY) || (touches[1].clientX == this._downPoints[0].clientX && touches[1].clientY == this._downPoints[0].clientY))) {\n            return true;\n        }\n        return false;\n    };\n\n    //滑动控制条按钮移动\n    SimpleCrop.prototype.scaleMove = function (ev) {\n        if (this.scaleDownX > 0) {\n            var pointX = this.getControlPoints(ev)[0].clientX;\n            var moveX = pointX - this.scaleDownX;\n            var newCurLeft = this.scaleCurLeft + moveX;\n            if (newCurLeft >= this.scaleInitLeft && newCurLeft <= (this.scaleWidth + this.scaleInitLeft)) {\n                var lastMoveX = this._scaleMoveX;\n                if (!lastMoveX) {\n                    lastMoveX = 0;\n                }\n                var curMoveX = lastMoveX + moveX;\n                this.scaleDownX = pointX;\n                this.scaleMoveAt(curMoveX);\n            }\n        }\n    }\n\n    //移动滑动控制条按钮到某个位置\n    SimpleCrop.prototype.scaleMoveAt = function (curMoveX) {\n        this.$scaleBtn.style[transformProperty] = 'translateX(' + curMoveX + 'px)';\n        this.$scaleValue.style.width = curMoveX + 'px';\n        this._scaleMoveX = curMoveX;\n        this.scaleCurLeft = this.scaleInitLeft + curMoveX;\n        this.scaleTimes = this.initScale + curMoveX * 1.0 / this.scaleWidth * (this.maxScale - this.initScale);\n        this.transform(false, true);\n    };\n\n    //内容图片移动\n    SimpleCrop.prototype.contentMove = function (touches) {\n        var point = touches[0];\n        var moveX = point.clientX - this._downPoints[0].clientX;\n        var moveY = point.clientY - this._downPoints[0].clientY;\n\n        this._contentCurMoveX += moveX;\n        this._contentCurMoveY += moveY;\n        this._downPoints = touches;\n\n        this.transform();\n    };\n\n    //旋转、缩放、移动\n    SimpleCrop.prototype.transform = function (rotateCover, scaleKeepCover) {\n        if (this.$cropContent) {\n            var scaleNum = this.scaleTimes / this.times * this._rotateScale;\n            var transform = '';\n            transform += ' scale(' + scaleNum + ')'; //缩放\n            transform += ' translateX(' + this._contentCurMoveX / scaleNum + 'px) translateY(' + this._contentCurMoveY / scaleNum + 'px)'; //移动\n            transform += ' rotate(' + this.rotateAngle + 'deg)';\n\n            if (scaleKeepCover) { //缩放时为了保证裁剪框不出现空白，需要在原有变换的基础上再进行一定的位移变换\n                transform = this.getCoverTransform(transform, true);\n                var scMat = this.getTransformMatrix(transform);\n                this._contentCurMoveX = scMat.e;\n                this._contentCurMoveY = scMat.f;\n            }\n\n            if (rotateCover) { //旋转时需要保证裁剪框不出现空白，需要在原有变换的基础上再进行一定的适配变换\n                var rotatePoints = this.getTransformPoints('scaleY(-1)' + transform, this.initContentPoints);\n                var coverScale = this.getCoverRectScale(rotatePoints, this.cropPoints);\n                var changedX = this._changedX;\n                var curMoveX = this._curMoveX;\n                var totalMoveX = curMoveX - changedX - this._baseMoveX;\n                var rotateCenter = this.getPointsCenter(rotatePoints);\n                var centerVec = {\n                    x: rotateCenter.x - this.cropCenter.x,\n                    y: rotateCenter.y - this.cropCenter.y\n                }\n                var percent = Math.abs(changedX) / Math.abs(totalMoveX);\n                if (coverScale > 1) {\n                    this._rotateScale = this._rotateScale * coverScale;\n                    scaleNum = scaleNum * coverScale;\n                } else if (this.vecLen(centerVec) < 1 && percent > 0) { //中心点接近重合时，旋转支持自适应缩小\n                    if (coverScale < (1 - percent)) { //不能突变\n                        coverScale = 1 - percent;\n                    }\n                    if (this._rotateScale * coverScale > 1) {\n                        this._rotateScale = this._rotateScale * coverScale;\n                    } else { //不能影响 scaleTimes\n                        this._rotateScale = 1;\n                        coverScale = 1;\n                    }\n                    scaleNum = scaleNum * coverScale;\n                }\n            }\n\n            //操作变换\n            transform = '';\n            transform += ' scale(' + scaleNum + ')'; //缩放\n            transform += ' translateX(' + this._contentCurMoveX / scaleNum + 'px) translateY(' + this._contentCurMoveY / scaleNum + 'px)'; //移动\n            transform += ' rotate(' + this.rotateAngle + 'deg)';\n            this.$cropContent.style[transformProperty] = this._initTransform + transform;\n            this.contentPoints = this.getTransformPoints('scaleY(-1)' + transform, this.initContentPoints);\n        }\n    };\n\n    //计算一个矩形刚好包含另一个矩形需要的缩放倍数\n    SimpleCrop.prototype.getCoverRectScale = function (outer, inner) {\n        var scale = 0;\n        for (var i = 0; i < inner.length; i++) {\n            var num = this.getCoverPointScale(inner[i], outer);\n            if (num > scale) {\n                scale = num;\n            }\n        }\n        return scale;\n    };\n\n    //判断 矩形A 是否完全包含 矩形B\n    SimpleCrop.prototype.isWholeCover = function (rectA, rectB) {\n        for (var i = 0; i < rectB.length; i++) {\n            if (!this.isPointInRectCheckByLen(rectB[i], rectA)) {\n                return false;\n            }\n        }\n        return true;\n    };\n\n    //计算一个矩形刚好包含矩形外一点需要的缩放倍数\n    SimpleCrop.prototype.getCoverPointScale = function (point, rectPoints) {\n        var pcv = this.getPCVectorProjOnUpAndRight(point, rectPoints);\n\n        //计算矩形外一点到矩形中心向量在矩形边框向量上的投影距离\n        var uLen = this.vecLen(pcv.uproj);\n        var height = this.vecLen(pcv.up) / 2;\n        var rLen = this.vecLen(pcv.rproj);\n        var width = this.vecLen(pcv.right) / 2;\n\n        //根据投影距离计算缩放倍数\n        if (uLen / height > rLen / width) {\n            return 1 + (uLen - height) / height;\n        } else {\n            return 1 + (rLen - width) / width;\n        }\n    };\n\n    //计算图片内容刚好包含裁剪框的transform变换\n    SimpleCrop.prototype.getCoverTransform = function (transform, onlyTranslate) {\n        var cRect = this.getCoveRect(this.cropPoints, this.rotateAngle);\n        onlyTranslate = onlyTranslate ? onlyTranslate : false;\n\n        //计算放大倍数\n        var uScale = 1; //水平缩放倍数和垂直缩放倍数\n        var rScale = 1;\n        var cup = {\n            x: this.contentPoints[1].x - this.contentPoints[2].x,\n            y: this.contentPoints[1].y - this.contentPoints[2].y\n        }\n        var cright = {\n            x: this.contentPoints[1].x - this.contentPoints[0].x,\n            y: this.contentPoints[1].y - this.contentPoints[0].y\n        }\n        var tup = {\n            x: cRect[1].x - cRect[2].x,\n            y: cRect[1].y - cRect[2].y\n        }\n        var tright = {\n            x: cRect[1].x - cRect[0].x,\n            y: cRect[1].y - cRect[0].y\n        }\n        var uAng = this.vecAngle(cup, tup);\n        if (Math.abs(180 - uAng) < Math.abs(90 - uAng) || Math.abs(0 - uAng) < Math.abs(90 - uAng)) { //更接近180或者0\n            uScale = this.vecLen(tup) / this.vecLen(cup);\n            rScale = this.vecLen(tright) / this.vecLen(cright);\n        } else {\n            uScale = this.vecLen(tup) / this.vecLen(cright);\n            rScale = this.vecLen(tright) / this.vecLen(cup);\n        }\n        uScale = uScale < 1 ? 1 : uScale;\n        rScale = rScale < 1 ? 1 : rScale;\n\n        var scale = uScale > rScale ? uScale : rScale;\n\n        if (onlyTranslate && scale > 1) {\n            return transform;\n        }\n\n        //复制坐标\n        var scalePoints = [];\n        for (var i = 0; i < this.contentPoints.length; i++) {\n            scalePoints.push({\n                x: this.contentPoints[i].x,\n                y: this.contentPoints[i].y\n            });\n        }\n\n        //计算放大后的新坐标\n        if (scale > 1) {\n            transform += ' scale(' + scale + ')';\n            this.scaleTimes = this.scaleTimes * scale;\n            //this._rotateScale = this._rotateScale * scale; // this._rotateScale 只能受旋转角度影响\n            scalePoints = this.getTransformPoints('scaleY(-1)' + transform, this.initContentPoints);\n        }\n\n        //位移变换\n        var scaleNum = this.scaleTimes / this.times * this._rotateScale;\n        var count = 0;\n        var self = this;\n        var outDetails = [];\n        do {\n            //找出裁剪框超出的顶点\n            outDetails = this.getOutDetails(this.cropPoints, scalePoints);\n            if (outDetails.length > 0) {\n                count++;\n                outDetails.sort(function (a, b) { //找出距离最远的点\n                    var aLen = self.vecLen(a.iv);\n                    var bLen = self.vecLen(b.iv);\n                    if (aLen < bLen) {\n                        return 1;\n                    }\n                    if (aLen > bLen) {\n                        return -1;\n                    }\n                    return 0;\n                });\n\n                //开始移动\n                var maxFarOut = outDetails[0];\n                var maxFarPcv = maxFarOut.pcv;\n\n                //计算X轴位移\n                uAng = this.vecAngle(maxFarPcv.up, maxFarPcv.uproj);\n                var uLen = this.vecLen(maxFarPcv.uproj);\n                var moveY = 0;\n\n                //if(uAng == 0){ //同方向\n                if (Math.abs(uAng) < 90) { //浮点数精度问题，接近0时小于90 ，接近180时大于90\n                    moveY = -uLen * maxFarOut.uOver;\n                } else {\n                    moveY = uLen * maxFarOut.uOver;\n                }\n                if (moveY != 0) {\n                    transform += ' translateY(' + moveY / scaleNum + 'px)';\n                }\n\n                //计算Y轴位移\n                var rAng = this.vecAngle(maxFarPcv.right, maxFarPcv.rproj);\n                var rLen = this.vecLen(maxFarPcv.rproj);\n                var moveX = 0;\n\n                if (Math.abs(rAng) < 90) { //同方向\n                    moveX = rLen * maxFarOut.rOver;\n                } else {\n                    moveX = -rLen * maxFarOut.rOver;\n                }\n                if (moveX != 0) {\n                    transform += ' translateX(' + moveX / scaleNum + 'px)';\n                }\n\n                //计算位移后的新坐标\n                if (moveX != 0 || moveY != 0) {\n                    for (i = 0; i < scalePoints.length; i++) {\n                        scalePoints[i].x = scalePoints[i].x + maxFarOut.iv.x,\n                            scalePoints[i].y = scalePoints[i].y + maxFarOut.iv.y;\n                    }\n                }\n            }\n        } while (count < 2 && outDetails.length > 0)\n\n        return transform;\n    }\n\n    //找出一个矩形在另一个矩形外的顶点数据\n    SimpleCrop.prototype.getOutDetails = function (inner, outer) {\n        var outDetails = [];\n        for (var i = 0; i < inner.length; i++) {\n            var pt = inner[i];\n            if (!this.isPointInRectCheckByLen(pt, outer)) {\n                var pcv = this.getPCVectorProjOnUpAndRight(pt, outer);\n                var iv = {\n                    x: 0,\n                    y: 0\n                };\n                var uLen = this.vecLen(pcv.uproj);\n                var height = this.vecLen(pcv.up) / 2;\n                var rLen = this.vecLen(pcv.rproj);\n                var width = this.vecLen(pcv.right) / 2;\n                var uOver = 0;\n                var rOver = 0;\n                if (uLen > height) {\n                    uOver = (uLen - height) / uLen;\n                    iv.x += pcv.uproj.x * uOver;\n                    iv.y += pcv.uproj.y * uOver;\n                }\n                if (rLen > width) {\n                    rOver = (rLen - width) / rLen;\n                    iv.x += pcv.rproj.x * rOver;\n                    iv.y += pcv.rproj.y * rOver;\n                }\n                outDetails.push({\n                    x: pt.x,\n                    y: pt.y,\n                    iv: iv,\n                    uOver: uOver,\n                    rOver: rOver,\n                    pcv: pcv\n                });\n            }\n        }\n        return outDetails;\n    }\n\n    //获取刚好包含某个矩形的新矩形\n    SimpleCrop.prototype.getCoveRect = function (rect, angle) {\n        if (angle < 0) {\n            angle = 90 + angle % 90;\n        } else {\n            angle = angle % 90;\n        }\n        var rad = angle / 180 * Math.PI;\n\n        var up = {\n            x: rect[1].x - rect[2].x,\n            y: rect[1].y - rect[2].y\n        }\n        var right = {\n            x: rect[1].x - rect[0].x,\n            y: rect[1].y - rect[0].y\n        }\n        var rLen = this.vecLen(right);\n        var uLen = this.vecLen(up);\n\n        var nRect = [];\n        nRect[0] = {};\n        nRect[0].x = rect[0].x + rLen * Math.sin(rad) * Math.sin(rad);\n        nRect[0].y = rect[0].y + rLen * Math.sin(rad) * Math.cos(rad);\n\n        nRect[1] = {};\n        nRect[1].x = rect[1].x + uLen * Math.sin(rad) * Math.cos(rad);\n        nRect[1].y = rect[1].y - uLen * Math.sin(rad) * Math.sin(rad);\n\n        nRect[2] = {};\n        nRect[2].x = rect[2].x - rLen * Math.sin(rad) * Math.sin(rad);\n        nRect[2].y = rect[2].y - rLen * Math.sin(rad) * Math.cos(rad);\n\n        nRect[3] = {};\n        nRect[3].x = rect[3].x - uLen * Math.sin(rad) * Math.cos(rad);\n        nRect[3].y = rect[3].y + uLen * Math.sin(rad) * Math.sin(rad);\n\n        return nRect;\n    }\n\n    //计算新的变换坐标\n    SimpleCrop.prototype.getTransformPoints = function (transform, points) {\n        var matrix = this.getTransformMatrix(transform);\n        var nPoints = [];\n        for (var i = 0; i < points.length; i++) {\n            var item = {\n                x: points[i].x,\n                y: points[i].y\n            };\n            item = TransformationMatrix.applyToPoint(matrix, item);\n            nPoints.push(item);\n        }\n        nPoints.reverse(); //顶点顺序发生了变化，需要颠倒\n\n        return nPoints;\n    }\n\n    //获得矩形点坐标中心\n    SimpleCrop.prototype.getPointsCenter = function (points) {\n        var center = {\n            x: (points[0].x + points[2].x) / 2,\n            y: (points[0].y + points[2].y) / 2,\n        }\n        return center;\n    };\n\n    //矩形位置形式转换为顶点坐标形式\n    SimpleCrop.prototype.rectToPoints = function (rect) {\n        var points = [];\n        points.push({\n            x: -(this.maskViewSize.width / 2 - rect.left),\n            y: this.maskViewSize.height / 2 - rect.top\n        });\n        points.push({\n            x: points[0].x + rect.width,\n            y: points[0].y\n        });\n        points.push({\n            x: points[1].x,\n            y: points[1].y - rect.height\n        });\n        points.push({\n            x: points[0].x,\n            y: points[2].y\n        });\n\n        return points;\n    };\n\n    //获取 css transform 属性对应的矩形形式\n    SimpleCrop.prototype.getTransformMatrix = function (transform) {\n        var transforms = transform.split(' ');\n        var params = [];\n        for (var i = 0; i < transforms.length; i++) {\n            if (transforms[i].trim() != '') { // 不能为空\n                var func = this.getTransformFunctionName(transforms[i]);\n                var result;\n                if (func.name != 'rotate') {\n                    result = TransformationMatrix[func.name](func.params[0], func.params[1]);\n                } else {\n                    result = TransformationMatrix[func.name](func.params[0]);\n                }\n                params.push(result);\n            }\n        }\n\n        return TransformationMatrix.compose(params);\n    };\n\n    //根据 css transform 属性获取 transformation-matrix 对应的函数名称以及参数\n    SimpleCrop.prototype.getTransformFunctionName = function (transform) {\n        var start = transform.indexOf('(');\n        var end = transform.indexOf(')');\n        var func = {};\n\n        //参数\n        var params = transform.substring(start + 1, end).split(',');\n        var arr = [];\n        for (var i = 0; i < params.length; i++) {\n            arr.push(parseFloat(params[i]));\n        }\n        func.params = arr;\n\n        //名称\n        var name = transform.substring(0, start).toLowerCase();\n        var defParams = 0; //默认参数\n        if (name.indexOf('scale') != -1) {\n            func.name = 'scale';\n            defParams = 1;\n        } else if (name.indexOf('translate') != -1) {\n            func.name = 'translate';\n        } else if (name.indexOf('skew') != -1) {\n            func.name = 'skewDEG';\n        } else if (name.indexOf('rotate') != -1) {\n            func.name = 'rotateDEG'; // 角度\n        }\n\n        //加入默认参数\n        if (name.indexOf('x') != -1) {\n            func.params.push(defParams);\n        } else if (name.indexOf('y') != -1) {\n            func.params.unshift(defParams);\n        } else if (name.indexOf('rotate') == -1 && func.params.length <= 1) { // 除了 rotate 其它函数支持 x、y 两个参数，如果 css transform 属性参数只有一个则另一个参数也是如此。\n            func.params.push(func.params[0]);\n        }\n\n        return func;\n    };\n\n    //计算向量 a 在向量 b 上的投影向量\n    SimpleCrop.prototype.getProjectionVector = function (vecA, vecB) {\n        var bLen = this.vecLen(vecB);\n        var ab = vecA.x * vecB.x + vecA.y * vecB.y;\n\n        var proj = {\n            x: ab / Math.pow(bLen, 2) * vecB.x,\n            y: ab / Math.pow(bLen, 2) * vecB.y,\n        }\n\n        return proj\n    };\n\n    //计算矩形中心到某点的向量在矩形自身坐标系上方向和右方向上的投影向量\n    SimpleCrop.prototype.getPCVectorProjOnUpAndRight = function (point, rectPoints) {\n        //计算矩形自身坐标系的上方向向量和右方向向量\n        var up = {\n            x: rectPoints[1].x - rectPoints[2].x,\n            y: rectPoints[1].y - rectPoints[2].y\n        }\n        var right = {\n            x: rectPoints[1].x - rectPoints[0].x,\n            y: rectPoints[1].y - rectPoints[0].y\n        }\n\n        //计算矩形中心点\n        var center = this.getPointsCenter(rectPoints);\n        var line = {\n            x: point.x - center.x,\n            y: point.y - center.y\n        }\n\n        var uproj = this.getProjectionVector(line, up);\n        var rproj = this.getProjectionVector(line, right);\n\n        return {\n            up: up,\n            uproj: uproj,\n            right: right,\n            rproj: rproj\n        };\n    };\n\n    //根据矩形中心到某一点向量在矩形边框向量的投影长度判断该点是否在矩形内\n    SimpleCrop.prototype.isPointInRectCheckByLen = function (point, rectPoints) {\n        var pcv = this.getPCVectorProjOnUpAndRight(point, rectPoints);\n\n        var precision = 100; //保留两位小数\n\n        var uLen = Math.round(this.vecLen(pcv.uproj) * precision);\n        var height = Math.round(this.vecLen(pcv.up) / 2 * precision);\n        var rLen = Math.round(this.vecLen(pcv.rproj) * precision);\n        var width = Math.round(this.vecLen(pcv.right) / 2 * precision);\n\n        if (uLen <= height && rLen <= width) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    //根据角度和判断点是否在矩形内\n    SimpleCrop.prototype.isPointInRectCheckByAngle = function (point, rectPoints) {\n        //先计算四个向量\n        var vecs = [];\n        for (var i = 0; i < rectPoints.length; i++) {\n            var p = rectPoints[i];\n            vecs.push({\n                x: (p.x - point.x),\n                y: (p.y - point.y)\n            });\n        }\n\n        //计算模最小向量\n        var sIndex = 0;\n        var sLen = 0;\n        for (i = 0; i < vecs.length; i++) {\n            var len = this.vecLen(vecs[i]);\n            if (len == 0 || len < sLen) {\n                sIndex = i;\n                sLen = len;\n            }\n        }\n        len = vecs.length;\n        var sVec = vecs.splice(sIndex, 1)[0];\n        var tVec = sVec;\n        var eVec;\n\n        //依次计算四个向量的夹角\n        var angles = [];\n        for (i = 1; i < len; i++) {\n            var data = this.getMinAngle(tVec, vecs);\n            tVec = data.vec;\n            vecs.splice(data.index, 1);\n            angles.push(data.angle);\n\n            if (vecs.length == 1) {\n                eVec = vecs[0];\n            }\n        }\n        angles.push(this.getMinAngle(eVec, [sVec]).angle);\n\n        var sum = 0;\n        for (i = 0; i < angles.length; i++) {\n            sum += angles[i];\n        }\n\n        //向量之间的夹角等于360度则表示点在矩形内\n        sum = sum.toPrecision(12); //取12位精度能在大部分情况下解决浮点数误差导致的精度问题\n        if (sum < 360) {\n            return false;\n        } else {\n            return true;\n        }\n    };\n\n    //计算向量数组的中向量和目标向量的最小夹角\n    SimpleCrop.prototype.getMinAngle = function (tVec, aVec) {\n        var minAngle = this.vecAngle(tVec, aVec[0]);\n        var minIndex = 0;\n        for (var i = 1; i < aVec.length; i++) {\n            var angle = this.vecAngle(tVec, aVec[i]);\n            if (angle < minAngle) {\n                minAngle = angle;\n                minIndex = i;\n            }\n        }\n        return {\n            angle: minAngle,\n            vec: aVec[minIndex],\n            index: minIndex\n        };\n    };\n\n    //计算向量夹角\n    SimpleCrop.prototype.vecAngle = function (vec1, vec2) {\n        var acos = (vec1.x * vec2.x + vec1.y * vec2.y) / (this.vecLen(vec1) * this.vecLen(vec2));\n        if (Math.abs(acos) > 1) { //因为浮点数精度结果有可能超过1，Math.acos(1.0000001) = NaN\n            acos = acos > 0 ? 1 : -1;\n        }\n        var rad = Math.acos(acos);\n        var angle = rad * 180 / Math.PI;\n        return angle;\n    };\n\n    //计算向量的模\n    SimpleCrop.prototype.vecLen = function (vec) {\n        return Math.sqrt(vec.x * vec.x + vec.y * vec.y);\n    };\n\n    //file转image\n    SimpleCrop.prototype.fileToSrc = function (file, callback) {\n        var reader = new FileReader();\n        reader.onload = function (e) {\n            callback(e.target.result);\n        }\n        reader.readAsDataURL(file)\n    };\n\n    return SimpleCrop;\n}));"]}]}